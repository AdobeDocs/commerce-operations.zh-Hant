---
title: Adobe Commerce 2.4.2發行說明
description: 了解2.4.2 Adobe Commerce版本的新功能、增強功能、錯誤修正和已知問題。
source-git-commit: 065c56f20ba5b1eef8c331c5c2f5649902f1442b
workflow-type: tm+mt
source-wordcount: '16459'
ht-degree: 0%

---


# Adobe Commerce 2.4.2發行說明

Adobe Commerce 2.4.2推出效能與安全性增強功能，以及大幅改善平台。 安全性增強功能包括擴充 `SameSite` 屬性。 B2B改善著重於支援採購訂單的線上支付。 Elasticsearch7.9.x和Redis 6.x現已受支援。

此版本包含超過280項核心程式碼的新修正，以及35項安全性增強功能。 其中包括社群成員解決近290個GitHub問題。 這些社群貢獻內容從微幅清理核心程式碼，到GraphQL的重大增強功能。

2.4.1版中識別的所有已知問題已在此版本中修正。

{{bics}}

## 套用 `AC-3022.patch` 繼續以DHL為航運承運人

DHL已推出架構6.2版，並將於近期淘汰架構6.0版。 支援DHL整合的Adobe Commerce 2.4.4及舊版僅支援6.0版。部署這些版本的商家應適用 `AC-3022.patch` 以便繼續提供DHL作為航運公司。 請參閱 [應用補丁程式以繼續提供DHL作為運輸承運人](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 有關下載和安裝修補程式的資訊，請參閱知識庫文章。

## 可用安全補丁

商家現在無需套用完整每季版（例如2.4.1-p1）提供的數百項功能修正和增強功能，即可安裝具時效性的安全性修正。 修補程式2.4.0.12（撰寫器套件2.4.1-p1）是一個安全性修補程式，可針對先前每季版2.4.1中已識別的弱點提供修正。套用至2.4.1版本的所有Hotfix都包含在此安全性修補程式中。 (A) *修補程式* 針對已發行版本提供修正，可解決特定問題或錯誤。)

有關安全補丁程式的一般資訊，請參見 [新安全性修補程式版本簡介](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). 有關下載和應用安全補丁程式（包括補丁程式2.4.1-p1）的說明，請參見 [快速啟動本地安裝](../../../installation/composer.md). 安全性修補程式僅包括安全性錯誤修正，而不包括完整修補程式中包含的其他安全性增強功能。

## 其他發行資訊

雖然這些功能的程式碼會與每季發行搭配，但其中幾個專案(例如B2B、Page Builder和Progressive Web Application(PWA)Studio)也會獨立發行。 這些專案的錯誤修正會記錄在每個專案的檔案中，提供個別專案的發行資訊。

## 重點

查看此版本中的下列重點。

### 大幅增強安全性

此版本包含超過35項安全性修正和平台安全性改善。 所有安全性修正都已支援2.4.1-p1和2.3.6-p1。

#### 超過35項安全性增強功能，可協助關閉遠端程式碼執行(RCE)和跨網站指令碼(XSS)漏洞

迄今未發生與這些問題相關的確認攻擊。 但是，某些漏洞可能會被利用來訪問客戶資訊或接管管理員會話。 這些問題大多要求攻擊者首先獲得管理員的訪問權限。 因此，我們會提醒您採取所有必要步驟來保護您的管理員，包括但不限於這些努力：IP允許清單， [雙因素驗證](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)，使用VPN，使用唯一位置，而非 `/admin`以及良好的密碼衛生。 請參閱 [Adobe安全性公告](https://helpx.adobe.com/security/products/magento/apsb21-08.html) 以討論這些已修正的問題。

#### 其他安全性增強功能

此版本的安全性改善包括：

* 所有核心Cookie現在都支援 `SameSite` 屬性。

* 當使用者嘗試儲存這些欄位中的值時，應用程式現在會在產品和類別說明欄位中顯示可識別潛在惡意內容的訊息。

* 跨元件的檔案系統操作已經過標準化和強化，以防止惡意上載。

* 已修正核心內容安全性原則(CSP)違規。

{{cve-notice}}

### 基礎架構改善

此版本包含核心品質的增強功能，可改善架構品質和這些功能領域：客戶帳戶、目錄、CMS、OMS、匯入/匯出、促銷和鎖定、購物車和結帳、B2B以及測試和預覽。

### 平台增強功能

* [**Elasticsearch7.9.x現已支援**](../../../installation/system-requirements.md). 雖然我們建議執行Elasticsearch7.9.x，但2.4.x版仍與Elasticsearch7.4.x相容。 <!-- MC-36867-->

* 2.4.2已通過 [清漆6.4](../../../installation/system-requirements.md). 2.4.x版仍與清漆6.x相容。

* [**現已支援Redis 6.x**](../../../installation/system-requirements.md). 2.4.x版仍與Redis 5.x相容。 <!-- MC-34853-->

* 2.4.2現在與 **撰寫器2.x**. 建議商戶移轉至撰寫器2.x。雖然您可以使用撰寫器1.x安裝此版本，但撰寫器1.x即將終止服務。 如需撰寫器2.x功能的概觀，請參閱 [撰寫器2.0現已可用！](https://blog.packagist.com/composer-2-0-is-now-available/)

此版本已淘汰將安裝設定為使用分割資料庫的功能。 當前使用拆分資料庫的商家應開始計畫恢復或遷移到單個資料庫或使用替代方法。 請參閱 [取代Adobe Commerce中的分割資料庫功能](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) 有關此問題的概述的DevBlog文章。  請參閱 [從拆分資料庫還原到單個資料庫](../../../configuration/storage/revert-split-database.md) 以取得移轉指示。

### 效能增強功能

此版本包含程式碼增強功能，可提升大型目錄部署的API效能和管理員回應時間。 多項可擴充性增強功能可支援2.4.2，以原生方式支援複雜目錄，且比舊版大20倍。

### GraphQL

此版本新增GraphQL涵蓋下列功能：

* 新增對多個願望清單的支援。 您可以使用GraphQL [建立](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-wishlist.html), [刪除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-wishlist.html)，和 [重新命名](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-wishlist.html) 願望清單 [移動](https://devdocs.magento.com/guides/v2.4/graphql/mutations/move-products-between-wishlists.html) 或 [副本](https://devdocs.magento.com/guides/v2.4/graphql/mutations/copy-products-between-wishlists.html) 項目之間。 <!-- MC-32356-->

* 新增對退回商品授權(RMA)的支援。 購物者可 [要求回訪](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-return.html). 如果商家接受請求，購物者可以執行下列工作： [添加註釋](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-return-comment.html) 和 [新增追蹤資訊](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-return-tracking.html). <!-- MC-34596-->

* 新增對下列B2B功能的支援：
   * 公司。 您可以新增公司 [管理員](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company.html), [使用者](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company-user.html), [角色](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company-role.html)，和 [團隊](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company-team.html). <!-- MC-33861-->
   * 公司信用。 此 [公司查詢](https://devdocs.magento.com/guides/v2.4/graphql/queries/company.html) 包括公司信用記錄的詳情。 <!-- MC-33862-->
   * 申請單。 您可以 [建立](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-requisition-list.html), [刪除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-requisition-list.html)，和 [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-requisition-list.html) 申請清單。 支援還包括 [新增](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-requisition-list.html), [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-products-in-wishlist.html), [刪除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-requisition-list-items.html), [副本](https://devdocs.magento.com/guides/v2.4/graphql/mutations/copy-items-between-requisition-lists.html)，和 [移動](https://devdocs.magento.com/guides/v2.4/graphql/mutations/move-items-between-requisition-lists.html) 申請清單中的項目以及添加申請清單項目 [放入購物車](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-requisition-list-items-to-cart.html). <!-- MC-34312-->

* 新增支援GraphQL的工會。 [GitHub-29425](https://github.com/magento/magento2/issues/29425) <!-- ENGCOM-8291 -->

* 新增 [比較清單](https://devdocs.magento.com/guides/v2.4/graphql/queries/compare-list.html). 購物者可 [建立](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-compare-list.html) 和 [刪除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-compare-list.html) 比較清單和 [新增](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-compare-list.html) 和 [移除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-compare-list.html) 項目。 此外，以訪客身分建立比較清單的購物者可以以客戶身分登入， [保留](https://devdocs.magento.com/guides/v2.4/graphql/mutations/assign-compare-list-to-customer.html) 比較清單。

* 新增 [`generateCustomerTokenAsAdmin`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/generate-customer-token-as-admin.html) 變異並更新 `Customer` 物件以支援遠端購買協助。

* 新增跨商店的本地化支援，以支援變更語言、購物車和貨幣等工作。 <!-- MC-37801-->

* 已增強GraphQL結構，以針對具有許多變體的可設定產品，最佳化產品資料擷取。 <!-- MC-36138-->

* 已棄用整數類型物件ID，以支援 `uid` 類型ID的屬性。 <!-- MC-36346-->

* 新增 `staging` 屬性 [`ProductInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/product-interface.html) 和 [`CategoryInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/category-interface.html) 以判斷產品是否已提貨，並檢視其相關的促銷活動資訊。 <!-- MC-33897-->

請參閱 [GraphQL開發人員指南](https://devdocs.magento.com/guides/v2.4/graphql/) 以取得這些增強功能的詳細資訊。

### B2B

2.4.2推出B2B v1.3.1。此版本包含購買訂單的線上付款支援以及多個錯誤修正。

**現在可以使用聯機付款方法完成採購訂單**. 系統會提示B2B購買者為每個購買者選擇其偏好的付款方法 [購買訂單](https://docs.magento.com/user-guide/stores/b2b-purchase-order-flow.html) 在初始結帳期間。 在採購訂單獲得批准後，系統會提示採購員輸入付款詳細資訊，以將採購訂單轉換為最終訂單。

為了支援接受線上付款的完整工作流程，此功能也：

* 在初始結帳期間改寫現有付款方法模板，以保持PCI合規性。

* 與第三方、自訂和社群開發的支付方法保持相容。

* 當買家需要將付款詳細資料新增至已核准的採購訂單時，透過電子郵件通知他們。

* 啟用管理員的電子郵件自訂，讓商戶使用與其品牌一致的範本。

* 導入 `Approved – Pending Payment` 狀態以清楚顯示需要採取動作的時間。

* 防止在最終付款步驟中添加或刪除折扣代碼，以確保批准的採購訂單的訂單總額保持不變。

* 允許購買者在最終付款步驟期間更改付款方式，以保持靈活性並增加轉換。

此版本也包含多項錯誤修正。 請參閱 [B2B發行說明](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html).

### PWA Studio

此PWA Studio版本包括：

* 國際化和本地化。 Venia現在提供多種語言和貨幣的支援。

* 改善擴充性架構，透過擴充功能支援程式碼變更。

* 「我的帳戶」相關功能的初始元件，如願望清單、已保存的付款、通訊簿和訂單歷史記錄。

* 各種效能最佳化和錯誤修正。

如需增強功能和錯誤修正的詳細資訊，請參閱 [PWA Studio發行](https://github.com/magento/pwa-studio/releases). 請參閱 [相容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 以取得PWA Studio版本及其相容版本的清單。

### 頁面產生器

此版本包含增強功能，可移轉頁面產生器內容及自訂頁面產生器CSS:

* 開發人員現在可以針對每個檢視區以不同方式設定內容類型輸出的樣式，而不需使用 `!important` 指令。

* 移轉至Page Builder的內容不再以預設內嵌樣式填補。

* 頁面產生器不再要求將所有內容類型放置在一列中。 此 [頁面產生器階段](https://docs.magento.com/user-guide/cms/page-builder-workspace.html#stage) 現在為空白，並支援將下列內容類型直接新增至預備：行、列、標籤、HTML代碼、塊、動態塊。

* 內容類型不再需要預先定義的邊界和划線。

* 新的行動裝置 [檢視區切換器](https://docs.magento.com/user-guide/cms/page-builder-workspace.html#viewports) 和表單欄位值的檢視範圍可讓使用者和開發人員執行下列動作：

   * 編寫時檢視不同檢視埠上的內容。

   * 針對每個檢視區的不同內容類型，最佳化最小高度欄位參數。 (現成僅支援一個參數（最小高度）。 需要自訂開發，才能對其他內容參數啟用行動最佳化。)

   * 將欄位範圍新增至自訂欄位和欄位集（開發人員）。

### 互動式產品內指引

互動式產品內指引為商戶提供使用秘訣，以及管理員提供的新功能公告、逐步指南、上線資訊和工具秘訣的資訊。  **如果未啟用此功能，管理員必須選擇加入管理員以接收產品內指引**. 請參閱 [使用資料收集](https://docs.magento.com/user-guide/stores/admin.html) 和 [管理員使用](https://docs.magento.com/user-guide/configuration/advanced/admin.html#admin-usage).

### Adobe Stock整合

此版本包含Adobe Stock整合v2.1.1。

### 媒體集

**媒體集的新角色資源**. 此版本讓商戶能夠限制管理員僅對媒體集的訪問權限，並控制哪些人可以執行以下操作：

* 將媒體資產插入內容

* 上傳資產

* 編輯資產詳細資訊

* 從媒體集刪除資產

* 管理資料夾結構。

**內容中的Web最佳化影像**. 商戶現在可以使用 [網頁最佳化影像轉譯](https://docs.magento.com/user-guide/cms/media-gallery-image-optimization.html) 在內容中，而非高解析度影像。 原始影像在「媒體庫」中保持未修改狀態，當影像插入內容時，將動態生成影像轉譯。

### AWS S3支援增強功能

Amazon簡單儲存服務(AWS S3)支援已增強，包括對以下項目的支援：

* 對象儲存和未來的擴展性

* [儲存媒體檔案](../../../configuration/remote-storage/remote-storage.md) 在AWS S3上

所有模組都新增了對AWS S3的支援，包括B2B、PageBuilder和Adobe Stock整合。

### 功能測試框架

MFTF 3.2.1現已可用。 此版本在測試和測試套裝產生方面都引入了容錯功能。 其他增強功能和錯誤修正說明於 [功能測試框架更改日誌](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### 訂單管理系統(OMS)

MCOM連接器與2.4.2完全相容。連接器的錯誤修正和增強功能於 [Connector發行說明](https://omsdocs.magento.com/release-notes/connector/index.html). 此版本包含對OMS命令列介面的改進，現在OMS命令列介面提供合作夥伴和支援團隊可用來疑難排解的詳細資訊 `retry`, `queue_prune`, `order_sync`, `message process`，和 `catalog export` 程式。

### 供應商開發的擴展

請參閱下列文章，了解此版本的功能和變更更新：

* [Amazon Pay](https://docs.magento.com/user-guide/payment/amazon-pay.html). Amazon Pay已在此版本中淘汰，並將在Magento2.5.0中移除。2.4.3版及更新版本僅包含主要錯誤的相容性和修正的更新。

* [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)

* [dotdigital Engagement Cloud](https://docs.magento.com/user-guide/marketing/dotdigital/engagement-cloud.html)

* [克拉納](https://docs.magento.com/user-guide/payment/klarna.html)

* [頂點雲](https://docs.magento.com/user-guide/tax/vertex.html)

* [Yotpo產品評論](../../../upgrade/modules/upgrade.md)

## 已修正問題

我們已修正2.4.2核心程式碼中的數百個問題。

### 安裝、升級、部署

<!-- MC-38429-->

* 此版本已淘汰將安裝設定為使用分割資料庫的功能。 請參閱 [取代Adobe Commerce中的分割資料庫功能](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) DevBlog文章。

<!-- MC-36472-->

* 商家現在可以成功將運行MySQL 8.x的開放原始碼部署升級為商務部署。 之前，應用程式在 `AUTO_INCREMENT` 值已回復為所有表的初始值， `row_id` 已在升級期間新增。

<!-- ENGCOM-7280 -->

* 應用程式現在會顯示錯誤訊息，當執行時發生錯誤時，系統會識別用來建立修補程式的路徑 `bin/magento/setup:db:generate-patch`. [GitHub-27523](https://github.com/magento/magento2/issues/27523)

<!-- ENGCOM-8029 -->

* `block_html`, `full_page`，和 `layout` 快取現在會如預期停用 `bin/magento/setup:upgrade` 執行。 [GitHub-28186](https://github.com/magento/magento2/issues/28186)

<!-- ENGCOM-8184 -->

* 中所需的最低PHP版本 `bootstrap.php` 已更新。 [GitHub-30004](https://github.com/magento/magento2/issues/30004)

<!-- MC-38788-->

* 您現在可以執行 `bin/magento/setup:upgrade` 安裝範例資料後。 以前，當您嘗試執行 `bin/magento/setup:upgrade`，應用程式會顯示此錯誤： `unable to apply data patch magento\catalogrulesampledata\setup\patch\data\installcatalogrulesampledata for module magento_catalogrulesampledata`. 應用程式在系統日誌中也顯示了此錯誤： `main.ERROR: Sample Data error: Unable to unserialize value. Error: Syntax error`. [GitHub-30685](https://github.com/magento/magento2/issues/30685)

<!-- MC-36785-->

* 您現在可以如預期從命令列設定YouTube API金鑰。 以前，當您嘗試執行時，應用程式會傳回此錯誤 `bin/magento config:sensitive:set catalog/product_video/youtube_api_key`: `There are no sensitive configurations to fill`.

<!-- ENGCOM-8163 -->

* 申請現在遵循 `maxMessages` 在中定義的值 `queue_consumer.xml`. 以前，應用程式僅使用部署配置值。 [GitHub-29522](https://github.com/magento/magento2/issues/29522)

<!-- ENGCOM-8243 -->

* 新商店的URL產生現在可在使用 `bin/magento setup:config:import`. 之前，生產環境中不會產生URL重新寫入。 [GitHub-30025](https://github.com/magento/magento2/issues/30025)

<!-- ENGCOM-8230 -->

* 當您執行時，應用程式不再顯示此問題 `bin/magento setup:install` 連接到現有資料庫： `Overwrite the existing configuration for db-ssl-verify?[Y/n]`. [GitHub-29612](https://github.com/magento/magento2/issues/29612)

### AdminGWS

<!-- MC-37040-->

* 此 **新增評等** 按鈕和 **儲存**, **刪除**, **重設** 按鈕不再可用於 **商店** > **屬性** > **評等** 頁面。

<!-- MC-35804-->

* 管理員現在只會顯示登入管理員擁有權限的網站資料。 以前，管理員會顯示部署中所有網站的資料。

<!-- MC-35027-->

* 所有選取的網站現在都儲存在 `gws_websites` 無論網站ID的大小。 以前，網站ID會遭截斷，而選定網站的清單不會儲存在資料庫中。 未正確保存用戶角色，當商家嘗試更改和保存角色時，應用程式顯示此錯誤： `The "X" store ID is incorrect. Verify the store ID and try again`.

<!-- MC-37223-->

* 應用程式現在會在管理員格線中，針對受限管理員使用者顯示正確的項目計數。 以前，這些網格顯示的計數反映了所有國家的資料，而網格本身只顯示特定國家的資料。 （此修正會更正「客戶」區段、目錄價格規則、購物車價格規則、所有使用者、鎖定的使用者和使用者角色格線的問題。）

<!-- MC-34156-->

* 權限排除的管理員 `Magento_Catalog::edit_product_design` （編輯產品設計）現在可以透過在選取的商店檢視中以新名稱儲存現有產品來建立新產品。 之前，應用程式會顯示此錯誤：  `Not allowed to edit the product's design attributes`. [GitHub-28106 ](https://github.com/magento/magento2/issues/28106)

<!-- MC-36406-->

* 應用程式不再顯示 **新增屬性** 按鈕 **商店** >管理員缺少建立這些實體的適當權限時的屬性。 之前，當沒有適當權限的網站管理員嘗試建立 **屬性集** 或 **客戶** 屬性。

<!-- ENGCOM-8230 -->

* 當您嘗試變更時，應用程式不再擲回錯誤 `backend-frontname` 使用 `ssh` 容器。Adobe Commerce [GitHub-26762](https://github.com/magento/magento2/issues/26762)

### Adobe Stock整合

<!-- ENGCOM-8020-->

* 新增閱讀支援 `exif_image.png` 或 `exif-image.jpeg` 中繼資料。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8194 8094 8147 -->

* 按一下「媒體集」的「預設檢視」書籤時顯示的內容不再經過篩選。 以前，預設檢視包含套用自 `url-filter` 應用程式。 [GitHub-1813](https://github.com/magento/adobe-stock-integration/issues/1813), [GitHub-1789](https://github.com/magento/adobe-stock-integration/issues/1789), [GitHub-1780](https://github.com/magento/adobe-stock-integration/issues/1780)

<!-- ENGCOM-8070 -->

* 已從WYSIWYG OnInsert控制器中刪除邏輯(`Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\OnInsert::execute()`)並新增至 `Model\Wysiwyg\Images\PrepareImage::execute()` 模型。 [GitHub-1504](https://github.com/magento/adobe-stock-integration/issues/1504)

<!-- ENGCOM-8081 -->

* 區域模擬已從 `media-content:sync` 命令(`\Magento\MediaContentSynchronization\Console\Command\Synchronize::execute`)。 [GitHub-1784](https://github.com/magento/adobe-stock-integration/issues/1784)

### Analytics

<!-- MC-37137-->

* 進階報表現在可如預期般適用於相同網域中的多個環境。 以前， 「進階報表」產生的CSV檔案失敗，因為雙引號會以反斜線逸出，而非CSV標準RFC4180要求的其他雙引號。

<!-- MC-35996-->

* 此 `analytics_collect_data` 使用預設埠或非預設埠連接到MySQL時，作業現在已成功運行 `env.php`. 以前， `analytics_collect_data` 使用非預設埠時擲回錯誤。

<!-- MC-35407-->

* 產生的CSV檔案 `analytics_collect_data` 現在已正確逸出。 以前，這些檔案不會以正確的逸出產生，因此無法產生庫存報表。

### Braintree

* 購物者現在可以使用Apple Pay，成功訂購虛擬產品。 之前，應用程式擲回此錯誤：  `There are no shipping methods available for you right now. Please try again or use an alternative payment method`.

* 預設的「PayPal快速結帳」付款方法現在與「Braintree信用卡」付款方法一樣正常工作。 之前，應用程式未顯示 **PayPal** 按鈕。

### 捆綁產品

<!-- MC-34063-->

* 此應用程式不再為以引號括住的固定價格捆綁產品子項目設定價格。

<!-- MC-38050-->

* 當捆綁產品包括無存貨產品時，價格分揀現在可以正常運作。 以前，按降序排序的價格不按降序顯示產品。

<!-- MC-38576-->

* 現在，當有許多選項存在時，應用程式會自動為捆綁產品選項應用預設數量1。 之前，商家必須手動指派預設數量給每個選項。

<!-- ENGCOM-8159 -->

* 訂單發票建立頁面現在會如預期般顯示捆綁產品的子產品。 [GitHub-27350](https://github.com/magento/magento2/issues/27350)

<!-- MC-38460 -->

* 現在，當您以自訂價格重新訂購屬於捆綁產品一部分的簡單產品時，應用程式會分配正確的產品價格。 以前，在捆綁產品上設定自訂價格會導致重新訂購時附加的簡單產品價格不正確。 [GitHub-30343](https://github.com/magento/magento2/issues/30343)

<!-- MC-30348 -->

* 呼叫POST `/V1/order/{orderId}/ship` 要發運包含捆綁產品的訂單，現在將訂單標籤為預期的完成。 以前，應用程式會顯示此錯誤訊息： `You can't create a shipment without products`. [GitHub-9762](https://github.com/magento/magento2/issues/9762)

### 購物車和結帳

<!-- MC-34264-->

* 當自訂位址屬性出現在結帳工作流程的出貨步驟時，出貨方法估算程式現在可如預期運作。 以前，應用程式會顯示此錯誤訊息： `{"message":"Error occurred during \"custom_attributes\" processing. A custom attribute is specified with a missing attribute code. Verify the code and try again."}` [GitHub-27505](https://github.com/magento/magento2/issues/27505)

<!-- MC-35783-->

* 應用程式現在會顯示 `You have no items in your shopping cart` 當購物者移除其購物車中的唯一項目時，迷你購物車中的訊息會如預期般。 之前，購物車資料未針對 `checkout/cart/removeFailed` 購物者移除單一項目時，應用程式顯示以下訊息： `1 product requires your attention`.

<!-- MC-36088-->

* 應用產品不再顯示不適用發運方法的訂單的發運成本。 以前，在結帳工作流程中，應用程式會針對不適用的發運方法顯示0的價格。

<!-- MC-36598-->

* 現在，當 **我的賬單和發貨地址是相同的** 取消選取結帳工作流程的核取方塊。

<!-- MC-36685-->

* 管理員可以透過管理員的SKU將產品新增至購物車，而不需從管理員重新導向離開。 系統不再將管理員重新導向至店面頁面，而應用程式會如預期般在「管理員購物車項目」區段中顯示產品。

<!-- MC-36750-->

* 當您上傳CSV檔案，而該檔案依SKU將產品新增至購物車時包含多種錯誤類型，應用程式現在會顯示提供資訊的錯誤訊息。 之前，當您按一下「 」，應用程式會顯示空白頁面和一般錯誤訊息 **選擇檔案** on **管理購物車** > **依SKU新增至購物車**.

<!-- MC-37351-->

* 購物者在不同網域中從一個商店切換至另一個商店時，購物車內容不再遺失。

<!-- MC-38000-->

* 使用多種運送方法時，購物者現在可以使用多個地址結帳成功完成訂單。 之前，應用程式會顯示此錯誤： `There has been an error processing your request`. [GitHub-30197](https://github.com/magento/magento2/issues/30197)

<!-- MC-38048-->

* 當購物者從購物車變更商店檢視時，應用程式現在會在結帳工作流程的運送頁面上顯示正確的預設國家/地區。

<!-- MC-38309-->

* 現在，當來賓購物者登入時，在登出後密碼重設後清除客戶工作階段時，應用程式會排除目前的工作階段。 之前，當購物者重設其密碼時，應用程式會清空購物車。

<!-- MC-36884-->

* 當購物者變更購物車中的商店檢視時，應用程式現在會顯示商店檢視的正確預設國家/地區。 以前，當購物車中的商店檢視變更時，預設的國家/地區不正確。

<!-- MC-38723-->

* 配置目錄權限的順序不再阻止具有正確權限的管理員將產品添加到購物車。 之前，應用程式未驗證 `addToCart` 目前客戶群組的組態設定。 因此，當管理員嘗試將產品新增至購物車時，應用程式擲回錯誤。

<!-- MC-38746-->

* 重複呼叫 `/rest/V1/guest-carts/cart_id/totals-information` 購物車上的端點已移除，進而改善購物車效能。 之前，當購物者將產品新增至購物車，然後又檢視購物車時，應用程式稱為 `collectAddressTotals` 方法多次。

<!-- MC-38833-->

* 應用程式不再顯示 **地區** 欄位中，當 **如果國家/地區為可選狀態，則允許選擇狀態** 設定已停用。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- MC-38813-->

* 從管理員重新訂購訂單時，應用程式不會再在店面結帳工作流程中重複傳送地址。

<!-- MC-38814-->

* 修正與 `AdminMediaGalleryInsertLargeImageFileSizeTest`.

<!-- MC-37321-->

* 中的所有新記錄 `quote` 來賓的表格現在在 `customer_is_guest field`. 以前，對於將產品新增至購物車的每位新訪客，記錄會在`quote.customer_is_guest` 欄位。

<!-- ENGCOM-8091 -->

* 此 **提交** 「複核與付款」區段上的按鈕已移至內部 `<form id="purchaseorder-form"...></form>`，這可在不變更任何JavaScript的情況下提交隱式表單。 [GitHub-27925](https://github.com/magento/magento2/issues/27925)

<!-- ENGCOM-8428 -->

* 應用程式不再顯示 **地區** 欄位，當 **如果國家/地區為可選狀態，則允許選擇狀態** 設定已停用。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- ENGCOM-8442 -->

* 現在，當購物者點按時，應用程式會正確更新購物車的項目小計 **更新購物車** 簽出時使用多個地址。 [GitHub-30408](https://github.com/magento/magento2/issues/30408)

<!-- ENGCOM-8283 -->

* 當 `config.xml` 目前尚未安裝的支付方法存在節點。 之前，應用程式在結帳期間擲回例外狀況。 [GitHub-29555](https://github.com/magento/magento2/issues/29555)

<!-- ENGCOM-8215 -->

* 應用程式現在會在迷你購物車中正確轉譯包含特殊字元的產品名稱。 [GitHub-29075](https://github.com/magento/magento2/issues/29075)

<!-- ENGCOM-8308 -->

* 此應用產品現在為表費率設定正確的折扣包。 以前，應用程式在計算表格費率時不會套用在購物車上設定折扣的購物車規則。 [GitHub-30169](https://github.com/magento/magento2/issues/30169)

### 購物車價格規則

* 在計算訂單小計時，無需納稅，購物車價格規則現在可按預期方式應用。 新 `Subtotal (Incl. Tax)` 已新增選項作為購物車價格規則條件。

<!-- MC-37884-->

* 使用GraphQL套用具有抵用券的價格規則，現在可如預期般運作，當 **整個購物車的固定金額折扣** 動作。

### 目錄

<!-- MC-34100-->

* 應用程式現在會如預期般在店面中顯示所有重新啟用的產品。 以前，當產品被禁用然後重新啟用時，在清漆頁快取被清除或儲存重新索引之前，應用程式不會顯示產品，因為重新啟用產品後頁面快取未失效。

<!-- MC-37745-->

* 大型目錄的部分重新索引現在可如預期般運作。 以前，使用重新索引期間，產品會隨機從店麵類別頁面消失 `catalogsearch_fulltext` 部分索引器。

<!-- MC-35123-->

* 購物者現在可以按照預期重新訂購具有可自訂選項的產品的發票訂單。 之前，當購物者嘗試重新排序時，應用程式擲回此錯誤： `{"0":"The product's required option(s) weren't entered. Make sure the options are entered and try again`.

<!-- MC-35212-->

* 您現在可以成功設定 **版面** 在「類別設計」頁面上的設定 **無版面更新**. 以前，應用程式會還原為 **類別 — 全寬** 當您指派 **無版面更新** 值。

<!-- MC-35490-->

* 解決了店面產品排序順序的問題。 以前，當應用程式為產品價格編製索引時，它偶爾會設定可配置產品的 `min_price` 和 `max_price` 0 `catalog_product_index_price` 表格，這會影響店面的價格排序順序。

<!-- MC-35608-->

* 應用程式現在可成功更新標示為 `Product Type`. 之前，因為 `product_type` 屬性已保留在代碼中，當您嘗試更新時，應用程式將顯示此消息 `Product Type` 屬性： `An attribute with the same code (product_type) already exists.`

<!-- MC-36214-->

* 儲存產品時，應用程式不再變更上傳視訊在產品詳細資料頁面之「影像與視訊」區段中的位置。 以前，新影像位置被分配了索引值（清單中的位置），如果現有影像位置未與其索引值對齊，則新影像在清單中的位置不正確。

<!-- MC-36548-->

* 此 **新增至購物車** 現在，只要 **新增至購物車** 按鈕。 之前，如果您在等待產品頁面載入時按了多次此按鈕，應用程式會擲回此錯誤： `Invalid Form Key. Please refresh the page`.

<!-- MC-37006 36835-->

* 當商家向類別添加或從類別中刪除禁用的產品時，應用程式不再刷新類別快取。 以前，應用程式會不顧產品狀態，刷新相關類別的快取。 儲存類別時，也未指派類別，導致類別快取排清。

<!-- MC-37347-->

* 在 **所有商店視圖** 範圍現在可正常運作。 之前，狀態為 `Enabled` 或 `Disabled` 在僅篩選已啟用或已停用的產品時，會顯示在格線中。

<!-- MC-38038-->

* 部分重新索引不再導致遺漏產品和空白類別。

<!-- MC-38315-->

* 重新訂購現在可如預期般運作，當 **使用JavaScript日曆** 已啟用(**商店** > **設定** > **目錄** > **日期和時間自訂選項**)。 以前，當啟用此設定時，當您嘗試從管理員重新排序先前下的訂單時，應用程式會顯示此錯誤： `Please specify date required option(s)`.

<!-- MC-38719-->

* 應用程式現在會在建立層價期間，於多網站部署中顯示正確的貨幣。

<!-- MC-38914-->

* 產品影像自訂屬性現在可正確逸出。 此 `data-src` 屬性的值與相同 `src` 屬性，如預期。 之前，URL特殊符號會逸出。

<!-- MC-37665-->

* 透過REST API更新類別不再停用 **使用預設值** 在「啟用類別」、「包含在功能表中」和「URL索引鍵屬性」上設定。

<!-- MC-36832-->

* 從「管理員」啟用類別權限時，在重複造訪類別頁面時，不再導致無法以完整頁面快取來快取類別頁面。 之前，快取不會如預期般提供後續的頁面造訪，且效能會降低。

<!-- MC-35363-->

* 現在，儲存類別只會刷新與此類別相關的區塊快取。 以前，應用程式會刷新所有類別塊的快取。

<!-- MC-30626-->

* 具有百分比價格的自訂選項的價格現在可如預期轉換為多商店部署中使用中商店的基本貨幣。 過去，以百分比價格轉換的自訂選項價格會不正確。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- MC-38890-->

* 應用程式現在可成功重新建立影像，而每當商家使用POST傳送媒體集資料時，這些影像就會如預期般顯示在管理員中 `rest/all/V1/products`. 之前，應用程式會重新建立影像，但當商家透過POST傳送媒體集資料時，會刪除影像 `rest/all/V1/products` 如果影像被刪除 `pub/media` 但媒體上仍然有記錄，記錄這些影像。 因此，商家在管理員中只看到預留位置，因為影像是在更新過程中建立和刪除的。

<!-- MC-36903-->

* 現在，當您從網站取消指派項目時，記錄會如預期刪除。 之前，影像在POST時會重複 `rest/all/V1/products` 被處決。

<!-- MC-38413-->

* 此 `/V1/categories/{categoryId}/products` 呼叫現在會如預期傳回屬於父類別的所有產品清單。 以前，如果產品屬於父類別的多個子類別，應用程式會擲回以下類型的錯誤： `Internal Error. Details are available in the application log file. Report ID: webapi-5f8579e37db54`.  [GitHub-30461](https://github.com/magento/magento2/issues/30461)

<!-- MC-32996-->

* 此 `/V1/products/attributes/:attributeCode/options` REST端點現在支援更新現有的屬性選項。

<!-- MC-30626 ENGCOM-8475-->

* 具有百分比價格的自訂選項的價格現在可如預期轉換為多商店部署中使用中商店的基本貨幣。 過去，以百分比價格轉換的自訂選項價格會不正確。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- ENGCOM-8395 -->

* 商戶現在可以在產品建立期間成功儲存新屬性。 以前，當商家嘗試保存屬性時，應用程式不會保存屬性，並將商家重定向到商店視圖首頁。 [GitHub-30362](https://github.com/magento/magento2/issues/30362)

<!-- ENGCOM-7997 -->

* 上的產品網格 **銷售** > **訂購** 和 **目錄** > **產品** 頁面現在會列出所有相關商店，而不只是最近建立的商店。 [GitHub-29267](https://github.com/magento/magento2/issues/29267)

<!-- ENGCOM-6698 -->

* 產品存放庫現在使用 `store_id` 可用於保存現有產品的屬性值時。  之前，產品存放庫類別會覆寫產品存放區ID，並一律指派預設存放區ID。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### 目錄規則

<!-- MC-35065-->

* 目錄價格規則現在可如預期般搭配產品詳細資料頁面上的自訂選項運作。 之前，該頁面上的產品價格未反映適用的目錄價格規則。 [GitHub-22856](https://github.com/magento/magento2/issues/22856)

<!-- MC-34265-->

* 產品和目錄快取現在會依排程到期。 以前，快取每天過期，因為 `сron` 執行 `catalogrule_apply_all` 每天執行一次任務，重新為所有目錄規則和相依索引器編製索引，並清除所有產品和類別的快取。

### 清除

#### 打字錯誤和語法清理

<!-- ENGCOM-7967 -->

* 已修訂「訂購失敗」頁面的標題，以確保正確性。 之前，此頁面的標題為： **我們收到了你的命令！**.  [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-8101 -->

* 移除 `app/code/Magento/Contact/view/frontend/templates/form.phtml`. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-7716 -->

* 修正 `bin/magento/setup:config:set` 子命令。 [GitHub-28802](https://github.com/magento/magento2/issues/28802)

<!-- ENGCOM-8058 -->

* 修正PHPDoc中 `framework/Registry.php` 檔案。 [GitHub-29661](https://github.com/magento/magento2/issues/29661)

<!-- ENGCOM-8273 -->

* 移除多餘的空白字元 `app/code/Magento/Catalog/Helper/Product/View.php`. [GitHub-30601](https://github.com/magento/magento2/issues/30601)

<!-- ENGCOM-8181 -->

* 修正 `app/code/Magento/Ui/view/base/web/js/form/element/ui-select.js`. [GitHub-29987](https://github.com/magento/magento2/issues/29987)

<!-- ENGCOM-8478 -->

* 修正迷你購物車和結帳訂單摘要中的「項目」複數問題。 [GitHub-29920](https://github.com/magento/magento2/issues/29920)

<!-- ENGCOM-8309 -->

* 移除標籤分層導覽篩選器中內嵌元素中的空白字元。 [GitHub-30448](https://github.com/magento/magento2/issues/30448)

<!-- ENGCOM-8056 -->

* `rl` 已更正為 `url` in  `\Magento\Framework\Filter\Template\Tokenizer\Parameter`.  [GitHub-29185 ](https://github.com/magento/magento2/issues/29185)

#### 程式碼清除

<!-- MC-37922-->

* 無關HTML `<br>` 標籤已從的「檢查資料」訊息區域中移除  **系統**  >  **匯入** 頁面。

<!-- ENGCOM-8028 -->

* `ChangeQuoteControl` 已重構。 [GitHub-29673](https://github.com/magento/magento2/issues/29673)

<!-- ENGCOM-8027 -->

* `AccessChangeQuoteControl` 其單元測試已經重構。 [GitHub-29672](https://github.com/magento/magento2/issues/29672)

<!-- ENGCOM-8053 -->

* 更正中傳回類型聲明的程式碼樣式 `app/code/Magento/Captcha/CustomerData/Captcha.php`. [GitHub-29712](https://github.com/magento/magento2/issues/29712)

<!-- ENGCOM-8288 -->

* 修正「新屬性」頁面上按鈕清單的位置。

<!-- ENGCOM-8315 -->

* 為前端新增正確的區塊類別 `viewModel` 參考範例 `\Magento\Framework\View\Element\Template` 類別。 [GitHub-30450](https://github.com/magento/magento2/issues/30450)

<!-- ENGCOM-8090 -->

* 已移除「銷售規則」表單中的備援欄位集。 [GitHub-29599](https://github.com/magento/magento2/issues/29599)

<!-- ENGCOM-8448 -->

* 已從 `hierarchy/edit.phtml` 範本。

<!-- ENGCOM-8446 -->

* 更正中的PHPdoc注釋 `app/code/Magento/CatalogImportExport/Model/Export/Product.php`. [GitHub-30833](https://github.com/magento/magento2/issues/30833)

<!-- ENGCOM-8277 -->

* 的docblock注釋 `PublisherInterface` 郵件已更正。 [GitHub-30190](https://github.com/magento/magento2/issues/30190)

<!-- ENGCOM-8264 -->

* 修正 `getStatusByState` 方法。 [GitHub-30173](https://github.com/magento/magento2/issues/30173)

<!-- ENGCOM-8235 -->

* 修正方法說明，位於 `app/code/Magento/Quote/Model/Cart/Totals/ItemConverter.php`. [GitHub-30125](https://github.com/magento/magento2/issues/30125)

<!-- ENGCOM-8242 -->

* 移除多個檔案中同一行的重複變數指派。 [GitHub-30133](https://github.com/magento/magento2/issues/30133)

<!-- ENGCOM-8263 -->

* 已變更 `@param string $attribute` to `@param AbstractAttribute|string[]|string $attribute` in `EntityAbstract.php`. [GitHub-30191](https://github.com/magento/magento2/issues/30191)

<!-- ENGCOM-8142 -->

* 標籤無效(例如 `@package` 和 `@subpackage`)已從整個程式碼基底的docblocks中移除。 [GitHub-30061](https://github.com/magento/magento2/issues/30061)

<!-- ENGCOM-8117 -->

* 建構中未使用的參數 `AdvancedPricing` 類別已移除。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### 可配置產品

<!-- MC-35016-->

* 現在，依價格篩選無庫存可設定產品時，會在正確的價格範圍內顯示結果。

<!-- MC-38930-->

* 當虛擬產品的狀態從啟用變更為停用時（反之亦然），虛擬產品不再變更類型。 以前，當產品的狀態更改時，應用程式將其類型從虛擬更改為簡單。

<!-- MC-38197-->

* 此 `getValue()` 更新購物車時，方法不再觸發致命錯誤。

<!-- MC-34444-->

* 可在多個網站上使用的可設定產品不再顯示未指派給特定網站的簡單子產品。 [GitHub-28291](https://github.com/magento/magento2/issues/28291)

<!-- ENGCOM-8202 -->

* 店面產品頁面現在會依照預期顯示不含稅的階層價格。 [GitHub-12225](https://github.com/magento/magento2/issues/12225)

<!-- ENGCOM-8134 8174-->

* 可設定產品的MSRP價格現在會正確轉換為選擇的貨幣。 以前，應用程式以錯誤的貨幣顯示價格並引發此錯誤：  `Call to a member function setAppliedTaxes() on null`. [GitHub-26526](https://github.com/magento/magento2/issues/26526), [GitHub-29603](https://github.com/magento/magento2/issues/29603)

<!-- ENGCOM-8234 -->

* 商家現在可以儲存特定於商店的文字色票屬性選項標籤，其值為0（零）。 過去，0的值會取代為管理標籤選項值。 [GitHub-30073](https://github.com/magento/magento2/issues/30073)

<!-- ENGCOM-8117 -->

* 建構中未使用的參數 `AdvancedPricing` 類別已移除。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### cron

<!-- MC-37712-->

* 現在，系統消息清單可以在 `cron` 已執行，且應用程式已如排程更新產品。

<!-- ENGCOM-8164 -->

* 基於 `schedule_id` 和 `status` 已新增至 `cron_schedule` 表格。 [GitHub-29601](https://github.com/magento/magento2/issues/29601)

### 自訂客戶屬性

<!-- MC-23545-->

* 應用程式現在會顯示類型的客戶屬性 `file` 在「帳戶資訊」頁面上。 以前，當您嘗試儲存此類型的新屬性時，應用程式會顯示以下錯誤： `The "newAttribute" attribute value is empty. Set the attribute and try again` 和 `Validation is failed`.

<!-- MC-23544-->

* 應用程式現在可正確顯示多行自訂客戶屬性值。 之前並未顯示所有資料。

<!-- MC-36978-->

* 現在，當購物者在建立帳戶時輸入無效的出生日期時，應用程式會提醒他們。 之前，驗證器不考慮地區設定，且購物者會重新導向至「建立新客戶帳戶」頁面，且日期錯誤無效。

<!-- MC-38846-->

* 結帳工作流程的「付款」步驟現在會如預期般包含自訂位址屬性。

<!-- MC-38114-->

* 自訂位址多選屬性現在會在訪客結帳期間，以及「管理員」和「我的帳戶」訂單詳細資訊頁面上正確顯示。

<!-- MC-37581-->

* 自訂位址屬性現在可以正確顯示在「我的帳戶」區域和「管理訂單詳細資訊」頁面中。

<!-- MC-37101-->

* 您現在可以刪除自訂客戶屬性中的前導零，當 `Input Type` 設為 `Text` 和 `Input Validation` 設為 `Numeric Only`.

<!-- MC-36721-->

* 應用程式現在可成功匯出包含自訂性別屬性值的客戶資料。

<!-- MC-34650-->

* 應用程式現在會如預期般儲存B2B使用者的自訂客戶屬性值。 過去，為新增或編輯公司使用者而建立的自訂客戶屬性沒有與「新增使用者」表單系結，因此屬性值無法儲存。 此外，自訂日期屬性從資料庫衍生為字串，未轉換為正確的店面顯示日期格式。

### 客戶

<!-- MC-35771-->

* 店面客戶帳戶頁面出生日期欄位的日曆介面工具集現在使用指定的商店地區設定。

<!-- MC-38498-->

* 在向管理員重新訂購現有客戶的過程中，應用程式不再儲存客戶地址的重複條目。

<!-- MC-37393-->

* 從管理員中刪除多個客戶的所有地址現在會從客戶地址清單中刪除所有地址，並刪除預設的帳單和運送地址。 以前，應用程式從客戶地址清單中刪除了地址，但沒有刪除預設的開單地址和發運地址。

<!-- MC-37377-->

* 管理員執行大量刪除地址後，管理員客戶地址標籤現在會正確顯示地址計數。 以前，應用程式的計數中包含已刪除的地址。

<!-- MC-36718-->

* 適用於 **出生日期** 已更正客戶註冊頁面上的欄位。 以前，在一位數的一天前的前導零是遺失的。

<!-- MC-36024-->

* 日期格式驗證 **出生日期** 欄位現在可在購物者點按 **建立帳戶** 按鈕。 以前，購物者可以輸入無效格式的值，當他們按一下 **建立帳戶** 按鈕時，系統會將購物者重新導向至「建立新客戶帳戶」頁面，並顯示無效的日期錯誤。

<!-- MC-33867-->

* 管理員嘗試儲存包含屬性無效資料的新客戶帳戶時，應用程式不會再擲回嚴重錯誤。

<!-- MC-36258-->

* 當客戶嘗試在先前已安裝Magento Shipping且目前已部署預設Luma主題的部署中存取其購物車時，應用程式不再擲回400錯誤。 之前，應用程式不會先篩選掉先前安裝/啟用的模組所建立的區段名稱，這些模組在將請求傳送至伺服器前不受支援，而會產生錯誤。

<!-- MC-35812-->

* 當購物者在 **需要電子郵件確認** 設定啟用， `Magento\Customer\Controller\Account\CreatePost` 已被覆蓋。 以前，應用程式不允許用戶註冊過程的此類定制，在這些情況下，用戶的電子郵件確認狀態被視為已完成，新用戶被自動登錄，並且不顯示錯誤消息。

<!-- ENGCOM-8039 -->

* 現在，當購物者在商店中以非預設客戶群組下訂單時，應用程式會將購物者指派給正確的客戶群組 **啟用自動分配至客戶組** 啟用。 [GitHub-26976](https://github.com/magento/magento2/issues/26976)

<!-- MC-39783-->

* 當索引設定為 **按計畫更新**. 之前，應用程式未顯示網格並擲回此錯誤：  `[2020-12-09 11:31:54] report.CRITICAL: The website with id 2 that was requested wasn't found. Verify the website and try again. \{"exception":"[object] (Magento\\Framework\\Exception\\NoSuchEntityException(code: 0): The website with id 2 that was requested wasn't found. Verify the website and try again. at /var/www/html/magento24ee/vendor/magento/module-store/Model/WebsiteRepository.php:110)"}`

### dotdigital

* 從dotdigital Engagement Cloud中擷取程式清單時，錯誤處理已得到改善。

* 訪客同步期間儲存名稱欄中同步的值，現在是預期的儲存檢視名稱。 以前，此欄會包含網站名稱。

* 新增陣列檢查，再於儲存訂單後透過訂單狀態自動循環。

* 已解決由於dotdigital模組依賴於 `magento/module-authorization`.

### 可下載

<!-- ENGCOM-7679 -->

* 可下載的產品已部分退款後，應用程式不再在「我的下載產品」索引標籤中列出可下載的產品。 [GitHub-28388](https://github.com/magento/magento2/issues/28388)

### 動態區塊（前身為橫幅）

<!-- MC-23938-->

* 在您刪除與區塊相關聯的客戶區段後，應用程式不再在店面上顯示動態區塊。

<!-- MC-37322-->

* 現在，在決定是否顯示動態區塊時，應用程式會正確考慮目錄價格規則。

### EAV

<!-- MC-35934-->

* 使用的自訂屬性 `\Magento\Eav\Model\Entity\Attribute\Backend\ArrayBackend` 現在，如果API呼叫建立產品時裝載中未提供任何值，請使用預設值。

### 電子郵件

<!-- ENGCOM-7961 -->

* `\Magento\Config\Model\Config\Source\Email\Template::toOptionArray` 當 `setPath()` 未在之前呼叫 `toOptionArray()`. [GitHub-29315](https://github.com/magento/magento2/issues/29315)

<!-- MC-36777-->

* 現在，當您按一下「 」時，應用程式會將純文字正確轉換為HTML **傳回Html版本** 載入電子郵件範本時。

<!-- MC-34803-->

* 發送給包含部分發票的客戶的電子郵件現在包含準確的項目小計。 以前，此電子郵件中的小計是訂購數量的總計，而非開票數量的總計。

<!-- MC-38337-->

* 應用程式現在會以有效的電子郵件地址傳送電子郵件提醒給所有相關客戶。 之前，應用程式在遇到一個無效地址後已停止向客戶發送提醒電子郵件。

<!-- ENGCOM-7517 -->

* 將產品從目錄中移除後，以非同步模式傳送銷售電子郵件現在可如預期運作。 之前，非同步電子郵件傳送會遭到封鎖，而應用程式會顯示此錯誤：  `main.ERROR: Cron Job sales_send_order_invoice_emails has an error: Call to a member function getData() on null. Statistics: {"sum":0,"count":1,"realmem":0,"emalloc":0,"realmem_start":73400320,"emalloc_start":37177640} [] []main.CRITICAL: Error when running a cron job {"exception":"[object] (RuntimeException(code: 0): Error when running a cron job at /var/www/html/vendor/magento/module-cron/Observer/ProcessCronQueueObserver.php:327, Error(code: 0): Call to a member function getData() on null at /var/www/html/vendor/magento/module-catalog/Helper/Image.php:502)"} []`. [GitHub-26878](https://github.com/magento/magento2/issues/26878)

<!-- ENGCOM-8381 -->

* 當 `sales_email/order_comment/enabled` 已停用， `sales_email/order_comment/copy_method` 設為 `bcc`. [GitHub-29915](https://github.com/magento/magento2/issues/29915)

### 框架

<!-- MC-24195-->

* 現在在搜尋客戶時，可正確套用自訂的篩選群組。 之前， `afterSearch` 函式未如預期為OR篩選器。 [GitHub-24576](https://github.com/magento/magento2/issues/24576)

<!-- MC-36942-->

* 商店首頁上的影像現在已成功轉譯。 之前，頁面來源HTML已損毀，因為影像的base64程式碼中的三個連續斜線被誤解為註解。

<!-- MC-37369-->

* 使用阿拉伯語地區設定篩選商店中「管理訂單」清單上的訂單時(`ar_SA - Saudi Arabia`)。

<!-- MC-38344-->

* 現在，在商家將購物車價格規則儲存到部署後，DatePicker會顯示正確的日期。 [GitHub-30382](https://github.com/magento/magento2/issues/30382)

<!-- MC-31085-->

* 應用程式現在可正確表示阿拉伯文千分位分組和阿拉伯文小數分隔符號符號。 以前，阿拉伯文符號被裁剪。 [GitHub-26676](https://github.com/magento/magento2/issues/26676)

<!-- MC-30631-->

* 應用程式現在會從資料庫中刪除過期的資料庫會話 `session` 表格。

### 一般修正

<!-- MC-38105-->

* 您現在可以設定原生工作階段處理常式，此處理常式與中定義的處理常式不同 `php.ini`. 以前， `SessionManager` 未將memcache設定為 `save_handler`，但改為使用 `session_handler`. 應用程式擲回此錯誤： `main.CRITICAL: Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 {"exception":"[object] (Exception(code: 0): Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in ../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 at ../vendor/magento/framework/App/ErrorHandler.php:61)"}`. [GitHub-24717](https://github.com/magento/magento2/issues/24717)

<!-- ENGCOM-8052 -->

* 已對 `LoginAsCustomer` 模組：

   * 已更換 `around` 外掛程式搭配 `after`

   * 移除備援程式碼

   * 已更換 `(bool)->getValue()` with `isSetFlag`. [GitHub-29689](https://github.com/magento/magento2/issues/29689)

<!-- ENGCOM-8093 -->

* 使用萬用字元(*)重新載入所有客戶資料區段，不再導致要求 `customer/section/load` 引發400錯誤。 [GitHub-28154](https://github.com/magento/magento2/issues/28154)

<!-- ENGCOM-7994 -->

* 應用程式現在會將在生產模式中呈現版面時發生的例外傳給 `var/report`. [GitHub-29606](https://github.com/magento/magento2/issues/29606)

<!-- MC-38587-->

* 變更商店檢視時，應用程式不再將客戶重新導向至首頁。 此 `\Magento\VersionsCmsUrlRewrite\Model\StoreSwitcher::switch()` 方法現在只會在 `$urlPath` 找不到第二個商店視圖。

<!-- ENGCOM-7527 -->

* 當不存在的客戶要求重設密碼時，應用程式現在會擲回例外狀況。 [GitHub-26288](https://github.com/magento/magento2/issues/26288)

<!-- MC-33687 ENGCOM-8497-->

* 管理員上傳此屬性值的檔案時，如果客戶帳戶包含客戶屬性的無效值，應用程式現在會顯示一則資訊性錯誤訊息。 之前，應用程式擲出錯誤。 [GitHub-30295](https://github.com/magento/magento2/issues/30295)

<!-- ENGCOM-8400 -->

* 此應用程式現在會套用 **HTML打印視圖徽標** 設定，如預期儲存發票PDF。 [GitHub-24730](https://github.com/magento/magento2/issues/24730)

<!-- ENGCOM-8425 -->

* `static::` 已取代為 `self::` 程式碼基底中的所有部分，以存取私人常數。 [GitHub-30781](https://github.com/magento/magento2/issues/30781)

<!-- ENGCOM-8395 -->

* 當商家按一下 **建立新屬性** 按鈕。 之前，應用程式顯示空白頁面並擲回錯誤。 [GitHub-30361](https://github.com/magento/magento2/issues/30361)

<!-- ENGCOM-8426 -->

* 應用程式不再顯示 `The coupon code has been accepted` 抵用券移除後的訊息。 [GitHub-30255](https://github.com/magento/magento2/issues/30255)

<!-- ENGCOM-8396 -->

* 管理員現在可以將介面工具集指派給特定類別。 [GitHub-30009](https://github.com/magento/magento2/issues/30009)

<!-- ENGCOM-8216 -->

* 屬性選取器 `input[type=datetime]` 已更換為較不特定的輸入類型選取器。 [GitHub-30064](https://github.com/magento/magento2/issues/30064)

<!-- ENGCOM-8282 -->

* 應用程式現在會如預期顯示與自訂類別屬性相關聯的商店特定值。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-8287 -->

* 應用程式現在會顯示提示，詢問您按一下 **驗證增值稅編號** 按鈕（位於「訂單建立」頁面上）。 [GitHub-29652](https://github.com/magento/magento2/issues/29652)

<!-- ENGCOM-8031 -->

* 此 `\Magento\Catalog\Model\ImageUploader` 類別已重構為使用新 `moveFileFromTmp`  方法。 [GitHub-29598](https://github.com/magento/magento2/issues/29598)

<!-- ENGCOM-8178 -->

* 當商家嘗試使用建立產品屬性時，應用程式現在會顯示資訊更豐富的錯誤訊息 `product_type` 和 `type_id` 程式碼以更具描述性。 [GitHub-28479](https://github.com/magento/magento2/issues/28479)

<!-- ENGCOM-8135 -->

* 修正 **客戶代號期限（小時）**  和 **管理員代號期限（小時）** 管理員欄位 **商店**  >  **配置** >  **服務**  > **OAuth** 頁面。 [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-8132 -->

* 應用程式現在可正確剖析包含 `}}` 在介面工具集內容欄位中。 [GitHub-12087](https://github.com/magento/magento2/issues/12087)

<!-- ENGCOM-8098 -->

* 您現在可以從「產品類別」頁面移除篩選器。 以前，當您嘗試刪除篩選器時，應用程式不會讓您移除篩選器，並顯示此錯誤：  `Something went wrong`. [GitHub-8538](https://github.com/magento/magento2/issues/8538)

<!-- ENGCOM-8050 -->

* `Magento\Framework\MessageQueue\ConfigInterface` 現在可在選用模組時實例化 `Magento_MessageQueue` 已停用。 之前，應用程式擲回此錯誤： `PHP Fatal error:  Uncaught Error: Cannot instantiate interface Magento\Framework\MessageQueue\ConfigInterface in /var/www/magento2/magento2/lib/internal/Magento/Framework/ObjectManager/Factory/AbstractFactory.php:121`. [GitHub-26080](https://github.com/magento/magento2/issues/26080)

<!-- ENGCOM-7312 -->

* 判斷應用程式何時可從永久儲存擷取電子郵件值的邏輯已得到改善。 之前，當未註冊的使用者在首次填妥電子郵件欄位後返回結帳頁面時，應用程式會在結帳頁面上顯示已填入的密碼欄位。 [GitHub-26903](https://github.com/magento/magento2/issues/26903)

<!-- ENGCOM-7777 -->

* 遺漏 `aclResource` 屬性已新增至「管理員」標題 `AdminNotification` 工具欄塊。 以前，即使管理員使用者沒有角色資源權限可查看管理員通知工具列項目。 [GitHub-29067](https://github.com/magento/magento2/issues/29067)

<!-- ENGCOM-8022 -->

* 此 `framework/database/select` `where` 函式現在處理 `type` 正確。 [GitHub-29590](https://github.com/magento/magento2/issues/29590)

<!-- ENGCOM-8260 -->

* 低效使用 `array_merge` 在整個程式碼基底中，in循環已得到改善，在數個地方（包括靜態內容部署程式）的效能已有所改善。 [GitHub-30183](https://github.com/magento/magento2/issues/30183)

<!-- ENGCOM-8445 -->

* 預設管理工作階段存留期已從加密模組移至安全模組。 [GitHub-30859](https://github.com/magento/magento2/issues/30859)

<!-- ENGCOM-8425 -->

* 應用程式現在會檢查類別中的私人常數，並顯示警告（如果有） `static::` 打給他們。 之前，應用程式擲回此錯誤： `Undefined class constant`.

<!-- ENGCOM-8219 -->

* 新增規則至 `editorconfig` 支援將JSON和YAML檔案縮排為兩個空格。 [GitHub-30066](https://github.com/magento/magento2/issues/30066), [GitHub-30063](https://github.com/magento/magento2/issues/30063)

<!-- ENGCOM-8079 -->

* 此 `FlushCacheByTags` 類別已更新，以使用外掛程式，而非外掛程式。 [GitHub-29558](https://github.com/magento/magento2/issues/29558)

<!-- ENGCOM-8358 -->

* `MessageValidator` 不再在未包含的雜湊陣列上失敗 `0` 元素。 [GitHub-30563](https://github.com/magento/magento2/issues/30563)

<!-- ENGCOM-8370 -->

* 中的程式碼 `checkout_index_index.xml` 檔案已借由移除 `sortOrder` 從 `messages`, `authentication`, `progressBar`, `estimation`，和 `sidebar checkout` 元件。 [GitHub-30550](https://github.com/magento/magento2/issues/30550)

<!-- ENGCOM-8379 -->

* 中的內容 `calc` 現在已逸出，因此正確 `calc` 值。 之前，應用程式傳回錯誤 `calc` 值。 [GitHub-30542](https://github.com/magento/magento2/issues/30542)

<!-- ENGCOM-8030 -->

* URL重寫產生器現在會設定類別物件 `url_key`, `url_path`，和  `store_id` 為全域範圍儲存類別URL重新寫入時，預設儲存值。 之前，它會儲存 `url_key`, `url_path`，和 `store_id` 和上次處理的儲存ID的值。 [GitHub-29585](https://github.com/magento/magento2/issues/29585)

<!-- ENGCOM-8250 -->

* `\Magento\Widget\Controller\Adminhtml\Widget\Instance\Validate` 現在會將片語結果值辨識為錯誤訊息，並在widget驗證期間輸出給使用者。 [GitHub-27397](https://github.com/magento/magento2/issues/27397)

<!-- ENGCOM-8311 -->

* 中類別屬性的硬式編碼清單  `Magento\Catalog\Model\Category\DataProvider::getFieldsMap()` 已替換為從快取產生的屬性清單。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-7759 -->

* 冗餘哈希 `req.http.host/client.ip` 已移除，且雜湊會由內建的VCL處理。 [GitHub-29988](https://github.com/magento/magento2/issues/29988)

<!-- ENGCOM-8302 -->

* 將失敗回呼新增至 `Magento_Ui` 檔案上傳程式。 [GitHub-29557](https://github.com/magento/magento2/issues/29557)

<!-- ENGCOM-8405 -->

* 安 `acl.xml` 不一致時 `Magento_LoginAsCustomerAssistance` 已啟用，但 `Magento_LoginAsCustomerAdminUi` 或 `Magento_LoginAsCustomerLog` 已更正。 以前，當具有這些憑證的管理員嘗試登入管理員時，應用程式會顯示空白頁面，並在下列情況下擲回此錯誤：  `Exception #0 (LogicException): Could not create an acl object: Invalid Document Element 'resource': The attribute 'title' is required but missing. Line: 13`. [GitHub-30680](https://github.com/magento/magento2/issues/30680)

<!-- ENGCOM-8157 -->

* 應用程式不再擲回 `Undefined class constant` 錯誤 `Interceptor` 會在外掛程式建立期間產生。 [GitHub-28981](https://github.com/magento/magento2/issues/28981), [GitHub-29879](https://github.com/magento/magento2/issues/29879)

<!-- ENGCOM-8108 -->

* 應用程式現在可正確處理非同步大量作業的訊息和記錄。 過去，雖然產品已更新，但 `magento_operation` 和 `queue_message_status` 表未正確更新，且系統消息不正確。 [GitHub-29718](https://github.com/magento/magento2/issues/29718)

<!-- ENGCOM-8388 -->

* 現在，當購物者按一下「設定新密碼」頁面時，系統會將他們重新導向至預期的「設定新密碼」頁面 **設定新密碼** 在「重設密碼」電子郵件中 **需要電子郵件確認** 已針對商店啟用。 之前，系統會將購物者重新導向回 **忘記密碼** 按鈕。 [GitHub-27954](https://github.com/magento/magento2/issues/27954)

<!-- ENGCOM-8337 -->

* 已修正使用預設值儲存列系統設定時的陣列轉換為字串錯誤。 [GitHub-30314](https://github.com/magento/magento2/issues/30314)

<!-- ENGCOM-8440 -->

* 您現在可以為消息隊列設定參數。 [GitHub-30216](https://github.com/magento/magento2/issues/30216)

<!-- ENGCOM-8384 -->

* 基本檔案收集器現在會遵循 `AppState->emulateAreaCode()`. [GitHub-39656](https://github.com/magento/magento2/issues/29656)

<!-- ENGCOM-8441 -->

* 新 `BlockByIdentifier` 類支援基於CMS塊標識符檢索佈局塊。 因此，從快取中移除CMS區塊時，應用程式也會清除配置區塊快取。 [GitHub-28309](https://github.com/magento/magento2/issues/28309)

<!-- ENGCOM-8385 -->

* 修正佇列中數值引數轉換的問題。 以前，當您使用數值宣告佇列時 `type` 引數 `queue_topology.xml`，引數值會轉換為字串。 [GitHub-29615](https://github.com/magento/magento2/issues/29615)

## 禮品卡

<!-- MC-38989-->

* 包含禮品卡代碼的電子郵件現在只有在訂單成功儲存後，才會傳送 **在訂購訂單項時建立禮品卡帳戶** 組態設定已啟用。 以前，如果在訂購物料時生成禮品卡帳戶，但在發送虛擬禮品卡後發生異常，則會重新使用禮品卡代碼併發送給不同的客戶。

<!-- MC-36496-->

* 應用程式不再複製禮品卡訂單。 之前，當購物者訂購一張禮品卡時，應用程式會傳送兩個禮品代碼。 這是因為 `cron` 呼叫的作業 `\Magento\GiftCard\Observer\GenerateGiftCardAccountsInvoice::execute()`，且此方法未檢查在發票建立期間是否已產生禮品卡代碼。

<!-- MC-35058-->

* 商家現在可以如預期從類別中取消指派產品。 之前，應用程式擲回的錯誤類似於此錯誤： `Could not save product "4" with position 0 to category 3`.

<!-- ENGCOM-8326 -->

* 新增對symlinked的支援 `root` 在「錯誤」頁面和維護模式中。 以前，若 `root` 或 `magento/pub` 被拼接到其他目錄，錯誤處理器(`Magento\Framework\Error\Processor`)未產生正確的檢視檔案URL。 [GitHub-30296](https://github.com/magento/magento2/issues/30296)

<!-- ENGCOM-8087 -->

* 新增遺失 `order_data` 陣列至 `EmailSender` 類別。 這可讓這些類別與Magento的建議一致，即在電子郵件範本中使用標量變數而非物件。 [GitHub-29604](https://github.com/magento/magento2/issues/29604)

### Google Tag Manager

<!-- MC-34818-->

* Google Tag Manager `productClick` 函式現在可如預期般運作。 以前， `productClick` 未在清單頁面上的產品上觸發，且Google標籤管理器無法擷取該事件。

<!-- MC-38781-->

* Google Tag Manager可設定產品選項現在會在您編輯購物車中可設定產品選項後，如預期在資料層中更新。 之前， `removeFromCart` 當產品選項變更，且數量保持不變時，事件會錯誤重寫。

### GraphQL

<!-- MC-37615-->

* 此 `urlResolver` 查詢現在可正確處理查詢參數。

<!-- ENGCOM-8422 -->

* 此 `urlResolver` 將自訂CMS節點和頁面指定為輸入時，查詢不再傳回NULL。 [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209 ENGCOM-8386-->

* 此 `category` 查詢不再返回已禁用的父類別的子類別。 [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* 此 `category` 停用URL重新寫入時，查詢現在會傳回類別影像的正確路徑。

<!-- MC-36648 8321-->

* 此 `resetPassword` 現在，當發生錯誤時，變異會傳回資訊更豐富的訊息。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078 ENGCOM-8504-->

* 快取的結果 `products` 當產品位置變更時，查詢會如預期失效。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- MC-35355 ENGCOM-8404-->

* 此 `products` 查詢現在會在 `category_id` 篩選器已指定為 `in` 關鍵字。 [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8373 -->

* 此 `categories` 和 `categoryList` 查詢現在會根據類別權限設定和父類別ID來考慮類別可用性。 [GitHub-29880](https://github.com/magento/magento2/issues/29880), [GitHub-30624](https://github.com/magento/magento2/issues/30624)

<!-- MC-37603-->

* 此 `updateProductsInWishList` 變異現在可正確驗證意願清單項目。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- ENGCOM-8430 PWA-1107-->

* 已取代 `ProductInterface` 和 `CategoryInterface` 防止在店面上使用。 [GitHub-30625](https://github.com/magento/magento2/issues/30625)

* 當將類別權限設定為隱藏價格時，價格現在會隱藏在產品查詢結果中。 [GitHub-29926](https://github.com/magento/magento2/issues/29926)

<!-- MC-36898 PWA-1299-->

* 您現在可以使用 `addProductsToWishList` 突變，將具有用戶定義數量的捆綁產品添加到願望清單。

<!-- MC-36648 -->

* 將產品添加到購物車中的突變現在會授予目錄權限。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-36946 -->

* GraphQL新增至購物車作業的回應時間已改善。

<!-- ENGCOM-8099 -->

* 此 `products` 查詢現在會如預期傳回層價值。 [GitHub-29168](https://github.com/magento/magento2/issues/29168)

<!-- ENGCOM-7528 -->

* 移除冗餘 `getMappedNums` 從循環 `lib/internal/Magento/Framework/GraphQl/Query/EnumLookup.php`. [GitHub-30031](https://github.com/magento/magento2/issues/30031)

<!-- ENGCOM-8172 -->

* 此 `products` 查詢的產品已停用相關產品時，查詢不再傳回錯誤。 [GitHub-28892](https://github.com/magento/magento2/issues/28892)

<!-- MC-37395 -->

* 此 `cart` 查詢現在會傳回已轉換為正確貨幣（預設顯示貨幣）的價格。 以前，查詢以基本貨幣返回項目價格值，而貨幣代碼作為預設顯示貨幣返回。

<!-- MC-37388-->

* GraphQL現在會授予目錄權限。 應用程式會限制針對 `products` 根據購物者的客戶群組進行查詢。

<!-- MC-39690-->

* 新增 `customizable_option` 屬性至實作的多個資料類型 `CartItemInterface`.

<!-- MC-39744-->

* 新增屬性 `storeConfig` 查詢以返回儲存、儲存組和網站資訊。

<!-- MC-37414-->

* 恢復 `SelectedCustomizableOption.type` 屬性。 此外， `customizable_options` 屬性 `CartItemInterface` 現在為非空值。

<!-- MC-23860-->

* 的搜尋功能 `products` 查詢不再傳回已啟用類別權限的項目。

<!-- MC-37726-->

* 此 `products` 查詢會為具有多種貨幣的儲存檢視傳回正確貨幣。

<!-- MC-37727-->

* 標籤 `products` 查詢篩選器現在會傳回翻譯的值（若適用於非預設的存放區檢視）。

<!-- MC-37728-->

* 在購物車的禮品卡上固定儲存貨幣金額。

<!-- MC-38443-->

* 新增 `ConfigurableProductOptionsSelection` 資料類型，包含與產品的可選可配置選項對應的元資料。 在 `products` 查詢，以在購物者選取可設定的產品選項時，將顯示的媒體庫項目數減到最少。

### 分組產品

<!-- MC-35361-->

* 產品查詢現在會傳回分組產品的所有預期資料。 以前， `product_links` 是空陣列。

<!-- MC-37718-->

* 當所有子級簡單產品都無存貨時，已分組的產品現在會在產品編輯頁面上列為無存貨。

<!-- MC-37249-->

* 現在，當其子簡單產品的狀態變更為無存貨時，已分組產品的狀態會在產品編輯頁面上正確更新。 以前，在子產品的庫存狀態發生更改後，分組產品的父產品的庫存庫存物料沒有更新。

### 影像

<!-- MC-36942-->

* 商店首頁上的影像現在已成功轉譯。 之前，頁面來源HTML已損毀，因為影像的base64程式碼中的三個連續斜線被誤解為註解。

<!-- ENGCOM-8116 -->

* 依賴 `fileinfo` 擴充功能已從CMS模組中移除。 之前，當您嘗試使用影像上傳程式上傳影像時，應用程式會擲回錯誤，當您按一下 **插入影像** 按鈕。 [GitHub-24332](https://github.com/magento/magento2/issues/24332), [GitHub-16531](https://github.com/magento/magento2/issues/16531), [GitHub-29852](https://github.com/magento/magento2/issues/29852)

<!-- ENGCOM-8020 -->

* 新增閱讀支援 `exif_image.png` 或 `exif-image.jpeg` 中繼資料。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- MC-37042-->

* 在如預期上傳後，目錄事件輪播介面工具集現在會顯示影像。 之前， `catalog_event_status_checker` cron作業已刪除已上傳的影像。

<!-- ENGCOM-8296 -->

* CMYK影像顏色現在已正確呈現。 現在，當Imagick適配器檢測到開啟的影像具有CMYK顏色空間時，顏色空間將轉換為SRGB。 以前，這些影像是以反轉的顏色呈現。 [GitHub-22375](https://github.com/magento/magento2/issues/22375)

<!-- ENGCOM-8251 -->

* 不再為設定布林值 `image_with_border.phtml`. 冗餘 `max-width` 和 `height` 設定已從 `.product-image-photo`. （這些值已透過重設樣式在影像上全域設定。） [GitHub-30186](https://github.com/magento/magento2/issues/30186)

### 匯入/匯出

<!-- MC-35081-->

* 客戶地址 `region_id` 不再指派 `NULL` 值。`entity type = "customer address"` 和 `import behavior = "add/update"`)，其中已刪除某些欄位值。

<!-- MC-35295-->

* 您現在可以在匯入期間隱藏店面上的產品影像。

<!-- MC-35395-->

* 當CSV檔案也包含錯誤的項目，排程的產品匯入程式現在會以正確的資料欄位更新產品。 以前，若CSV檔案在 **錯誤時：繼續處理** 已啟用。

<!-- MC-35836-->

* 當匯入的產品 `qty` 設為0，但 `is_in_stock set` 若設為1，則產品不會列在類別頁面上，而產品詳細資訊頁面會將其識別為無存貨。 以前，具有這些值的產品在匯入後會顯示在店面上。

<!-- MC-38433-->

* CSV匯入不再忽略 `dropdown` 和 `textarea` 其他屬性的值。 以前，這些屬性值在匯入期間未更新。

<!-- MC-37933-->

* 產品匯出CSV檔案現在如預期般出現在匯出CSV檔案的「管理員」清單中。 之前，當您執行以下命令時，應用程式會擲回錯誤： `bin/magento queue:consumers:start exportProcessor --single-thread --max-messages=10000`.

<!-- MC-37672-->

* 匯入包含孟加拉（孟加拉）字母字元的CSV資料時，應用程式不再擲回錯誤。

<!-- MC-36410-->

* 管理員點按時，應用程式現在會顯示資訊性錯誤訊息 **檢查資料** 在Chrome中工作時，匯入自匯出以來已變更的檔案期間。 之前，應用程式顯示主控台錯誤，但並未告訴使用者如何繼續。

<!-- ENGCOM-8252 -->

* 當您多次匯入相同的產品CSV資料時，應用程式不再複製產品影像。 [GitHub-21885](https://github.com/magento/magento2/issues/21885)

<!-- ENGCOM-8262 -->

* 影像檔案名稱的上限為90個字元，位於 `vendor/magento/framework/File/Uploader.php` 已移除。  以前，目錄和檔案名長度不能超過255個字元。 應用程式導入了具有檔案名超過此限制的映像的產品，但未導入映像檔案。 [GitHub-29377](https://github.com/magento/magento2/issues/29377)

<!-- ENGCOM-8153 -->

* 抵用券代碼現在可以成功匯出為CSV或XML。 之前，當您按一下「 」，應用程式會顯示404錯誤 **匯出CSV** 或 **導出XML** 當你試圖導出優惠券時。 [GitHub-29277](https://github.com/magento/magento2/issues/29277)

<!-- ENGCOM-8252 -->

* 現在，匯入包含影像的CSV檔案後，會移除重複的產品影像。 [GitHub-14398](https://github.com/magento/magento2/issues/14398), [GitHub-21885](https://github.com/magento/magento2/issues/21885)

## 索引

<!-- MC-38003-->

* 改進了部分索引器的效能。 現在，應用程式會清除針對每個1000-ID批次迭代所變更的快取ID。 快取內容不再累積ID。 以前，快取上下文為每個1000-ID批次小版本累積快取ID，並清除每個小版本上的同一組ID。

<!-- ENGCOM-7929 -->

* 修正了部分重新索引系統和完整重新索引系統之間的不一致。 現在，兩個索引系統都使用相同的程式碼，這樣就能正常運作。 以前，兩個索引系統對共用索引器使用不同的邏輯，這可能導致在每次運行部分重新索引系統後索引器失效。 [GitHub-29478](https://github.com/magento/magento2/issues/29478), [GitHub-29297](https://github.com/magento/magento2/issues/29297)

<!-- MC-38168-->

* 我們已解決手動索引器造成空白類別頁面或類別頁面上產品計數減少的問題。 發生以下情況時，類別頁面或產品計數不完整的問題：

   * the `catalogsearch_fulltext` 和 `catalog_product_price` 部分索引器在大型目錄上執行，直到這些索引器完成執行。

   * 部分索引器已在 `catalog_category_product` 或 `catalog_product_category` 指數，同時對其中一個指數執行完全的重新索引。 這兩個索引過程可能會發生衝突，導致類別頁面中的產品遺失。

   * `bin/magento indexer:reindex inventory` 在大型目錄中執行。 產品從類別頁面中遺失，直到 `catalogsearch_fulltext` 部分索引器已完成執行。

<!-- MC-39700-->

* 索引器已添加到 `Magento_Bulk` MySQL表，它改善了批量操作的效能。

<!-- MC-38806-->

* 資料庫表中的注釋現在可以準確反映重新索引後的表狀態(`bin/magento indexer:reindex`)。 以前，重新索引後的表注釋包含的值與重新安裝後所包含的注釋相同。

<!-- ENGCOM-7542 -->

* 此 `SELECT entity_id IN` 在實施MariaDB v.10.3.18的部署中，語句得到了改進，這提高了目錄類別索引的效能。 [GitHub-25199](https://github.com/magento/magento2/issues/25199)

<!-- ENGCOM-8237 -->

* Adobe Commerce已透過取消每個索引器例項多次的標籤排清來改善快取效能。 [GitHub-29890](https://github.com/magento/magento2/issues/29890)

### 基礎設施

<!-- MC-34353-->

* 您現在可以使用 `app/etc/env.php` 將消息代理從MYSQL更改為AMQP。

<!-- MC-38242-->

* 相關JavaScript程式庫中已修正產品數量之小數值的余數計算問題。 應用程式先前錯誤地計算了超過兩位數的小數部分，隨後顯示了錯誤的消息。

<!-- MC-38993 ENGCOM-8473-->

* 此 `\Magento\Authorization\Model\Rules::update` 方法已淘汰。 [GitHub-29128](https://github.com/magento/magento2/issues/29128)

<!-- ENGCOM-8000 -->

* 從UTC轉換日期物件時，應用程式不再擲回嚴重錯誤。 以前在特定條件下， `convertConfigTimeToUtc` 方法擲回例外狀況。 [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7987 -->

* `DataObject` 已替換為 `\Magento\MediaGalleryCatalogUi\Ui\Component\Listing\Columns\Thumbnail::prepareDataSource`.[GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- ENGCOM-7914 -->

* 此 `RequireJS` 解析程式不再無法偵測已封鎖的資源。 過去，解析程式無法正確偵測頁面上的所有資源是否已正確載入或處理，且頁面仍持續載入。 [GitHub-28116](https://github.com/magento/magento2/issues/28116)

<!-- ENGCOM-8229 -->

* 屬性存放庫程式碼驗證現在依照 `Magento\Eav\Model\Entity\Attribute::ATTRIBUTE_CODE_MAX_LENGTH` 而不是硬式編碼值。 [GitHub-29017](https://github.com/magento/magento2/issues/29017)

<!-- MC-35699-->

* HTML縮制不再從PHTML檔案的HTML字串中去除三斜線(///)。 以前，在縮制期間，三斜線會解譯為註解，其餘的行在部署時會完全移除在產生的PHTML檔案中。

<!-- MC-38201-->

* 商家現在可以在表列級別而不是表級別配置索引器訂閱。 已新增新引數至 `\Magento\Framework\Mview\View\Subscription` 允許對特定視圖或表組合忽略列。 [GitHub-30243](https://github.com/magento/magento2/issues/30243)

<!-- MC-30171-->

* 按一下 **新增至購物車** 產品頁面之前的按鈕JavaScript已完全初始化，不再導致重複 `form_key` 值。 之前，產品可透過快取新增至購物車 `form_key` 觸發例外的值。 當 **新增至購物車** 在JavaScript完全初始化前點按，然後 `form_key` 表單資料中傳送的值不符合使用者工作階段，且產品未新增至購物車。 [GitHub-13746](https://github.com/magento/magento2/issues/13746)

<!-- ENGCOM-8107 -->

* 目前的cURL用戶端現在會遵循不區分大小寫的標題名稱。 之前， `Set-Cookie` 比較會區分大小寫，因此可能導致某些HTTP伺服器發生問題。 [GitHub-29524](https://github.com/magento/magento2/issues/29524)

<!-- ENGCOM-8360 -->

* 更新XSD URN格式(在 `api-functional` 和測試用例XML檔案。 [GitHub-30552](https://github.com/magento/magento2/issues/30552)

<!-- ENGCOM-8295 -->

* 已將事件前置詞和事件物件新增至目錄產品選項值集合，以改善集合載入的自訂 `\Magento\Catalog\Model\ResourceModel\Product\Option\Value\Collection`. [GitHub-29621](https://github.com/magento/magento2/issues/29621)

<!-- ENGCOM-8261 -->

* 所有 `array_merge` 已重構為使用編碼標準中建議的格式。 [GitHub-30005](https://github.com/magento/magento2/issues/30005)

<!-- ENGCOM-7718 -->

* A `head.additional` 類型塊 `\Magento\Framework\View\Element\Text\ListText` 已新增至 `adminhtml` `default` 佈局(按 `magento2/module-base`)。 [GitHub-29165](https://github.com/magento/magento2/issues/29165)

<!-- ENGCOM-8312 -->

* 在版面範本模組Widget中新增遺失的逸出URL方法。 [GitHub-30036](https://github.com/magento/magento2/issues/30036)

<!-- ENGCOM-8127 -->

* 此 `\Magento\Framework\Filesystem\Io\File::read()` 方法現在與 `\Magento\Framework\Filesystem\Io\IoInterface::read()`. [GitHub-27866](https://github.com/magento/magento2/issues/27866)

### 克拉納

* 移除對PayPal模組的相依性。 [GitHub-29421](https://github.com/magento/magento2/issues/29421)

### 記錄

<!-- ENGCOM-8443 -->

* 此 `Magento_Logging` 模組現在會正確註冊新值以及先前的值。 以前，無論這是第一次更改還是下一次更改，還是返回預設值，「更改前值」列中的值都顯示為N/A。 [GitHub-26943](https://github.com/magento/magento2/issues/26943)

### 媒體集

<!-- ENGCOM-8014 -->

* 管理員 **商店**  >  **設定**  >  **進階**  >  **系統** 頁面已更新，以顯示正確的產品名稱（媒體集）。 已包含對使用者介面的微幅重新設計。 [GitHub-1738](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-8019 -->

* 「媒體圖庫」影像說明的「用於」區段中的連結現在會顯示已依所選影像篩選的格線（如預期）。 以前顯示的格線標題不正確，清單項目也不準確。 [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019 -->

* 您現在可以成功編輯媒體庫中的多個影像。 之前，在將標籤新增至一個影像後，您無法將標籤新增至第二個影像。 [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015 -->

* 從「媒體庫」中的影像移除標籤後，「標籤」下拉式功能表現在會如預期般空白。 [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

<!-- ENGCOM-8146 -->

* 現在支援對媒體集同步佇列訊息進行批次處理。 [GitHub-1724](https://github.com/magento/adobe-stock-integration/issues/1724)

<!-- ENGCOM-8064 -->

* 當您嘗試開啟媒體集時，應用程式現在會如預期顯示404頁面 **增強媒體集** 已停用。  [GitHub-1760](https://github.com/magento/adobe-stock-integration/issues/1760)

<!-- ENGCOM-8072 -->

* `MediaGalleryMetadata` 現在，如果發生例外狀況，會略過區段讀取器，而是剖析，如預期顯示影像中繼資料。 之前，影像中繼資料是空白的，因為 `exif_read_data` 區段讀取器。 [GitHub-1782](https://github.com/magento/adobe-stock-integration/issues/1782)

<!-- ENGCOM-8069 -->

* 資料夾名稱長度不再阻止將影像上載到媒體集。 媒體集現在將路徑列設定為類型 `text`. [GitHub-1778](https://github.com/magento/adobe-stock-integration/issues/1778)

<!-- ENGCOM-8217 -->

* 從「媒體圖庫」插入轉譯時，影像上傳程式現在會顯示正確的影像大小。 [GitHub-1806](https://github.com/magento/adobe-stock-integration/issues/1806)

<!-- ENGCOM-8467 -->

* 路徑驗證已新增至 `Mediagallery` 上傳程式外掛程式。 以前驗證失敗，而應用程式未在 **啟用舊介質庫** 已停用。 [GitHub-30649](https://github.com/magento/magento2/issues/30649)

<!-- ENGCOM-8057 -->

* `Magento_Cms::media_gallery` 已為新介質庫添加並強制ACL子資源，以支援為以下離散操作配置的權限：

   * 上傳資產
   * 將資產插入內容
   * 刪除資產
   * 建立資料夾
   * 刪除資料夾。 [GitHub-1487](https://github.com/magento/adobe-stock-integration/issues/1487)

<!-- ENGCOM-8047 -->

* 長媒體集文字字串和資料夾名稱不再被裁切。 之前，應用程式會顯示已裁切的文字和影像，並顯示此訊息：  `We couldn't find any records`. [GitHub-1763 ](https://github.com/magento/adobe-stock-integration/issues/1763), [GitHub-1758 ](https://github.com/magento/adobe-stock-integration/issues/1758)

<!-- ENGCOM-8042 -->

* 應用程式不再顯示 **添加選定內容** 按鈕。 [GitHub-1769](https://github.com/magento/adobe-stock-integration/issues/1769)

<!-- ENGCOM-8047 -->

* 篩選器現在可如預期套用於 **內容**  >  **媒體集** 類別網格。 [GitHub-1763 ](https://github.com/magento/adobe-stock-integration/issues/1763)

<!-- ENGCOM-8183 -->

* 庫多斷點選項配置現在可以正常工作。 以前，斷點選項配置無法正常工作，因為 `mediaCheck` 在頁面載入時觸發退出媒體查詢功能。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### MFTF

<!-- ENGCOM-8359 -->

* 以中的動作群組取代重複性動作 `CheckStaticBlocksTest`. [GitHub-30561](https://github.com/magento/magento2/issues/30561)

<!-- ENGCOM-8267 -->

* `AdminUpdateCategoryAndMakeInactiveTest` 和 `VerifyChildCategoriesShouldNotIncludeInMenuTest` 已重構，以符合MFTF最佳實務。 [GitHub-30058](https://github.com/magento/magento2/issues/30058)

<!-- ENGCOM-8458 -->

* 已刪除重複項 `AdminOpenCMSBlocksGridActionGroup`. [GitHub-30896](https://github.com/magento/magento2/issues/30896)

<!-- ENGCOM-8156 -->

* 已更換 `AdminOpentCmsBlockActionGroup` 與AdminOpenCmsBlockActionGroup一起使用。 [GitHub-29839](https://github.com/magento/magento2/issues/29839)

<!-- ENGCOM-8226 -->

* 已棄用 `GoToAttributeGridPageActionGroup`. [GitHub-30103](https://github.com/magento/magento2/issues/30103)

<!-- ENGCOM-8061 -->

* 新增動作群組至 `Analytics` 模組。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-7334 -->

* 已更新 `CheckCheckoutSuccessPageAsRegisterCustomerTest` 和 `CheckCheckoutSuccessPageAsGuestTest` 以在測試運行後取消建立的訂單。 [GitHub-28324](https://github.com/magento/magento2/issues/28324)

<!-- ENGCOM-8214 -->

* 已移除 `AdminNavigateToPageGridActionGroup` 因為冗餘。 [GitHub-29838](https://github.com/magento/magento2/issues/29838)

<!-- ENGCOM-8280 -->

* 問題 `StorefrontProductListWidgetWithSharedCatalogTest` 已解決導致略過測試的問題。 [GitHub-322](https://github.com/magento/partners-magento2b2b/issues/322)

<!-- ENGCOM-8122 -->

* 已實作 `ActionGroup` 導覽至結帳頁面。 [GitHub-29843](https://github.com/magento/magento2/issues/29843)

<!-- ENGCOM-8124 -->

* 已實作 `AdminOpenCreateNewCMSPageActionGroup` 導覽至「建立新CMS」頁面。 [GitHub-29824](https://github.com/magento/magento2/issues/29824)

<!-- ENGCOM-8268 -->

* 修正「媒體庫」的「CMS」頁面的MFTF測試中略過的問題。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

<!-- B2B-831 -->

* 在MFTF測試中為 `Company`, `CompanyCredit`, `CompanyPayment`, `CompanyShipping`，和 `ConfigurableSharedCatalog` 模組。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

#### 新測試

<!-- ENGCOM-7804 -->

* 已新增在「管理員」中為朋友啟用電子郵件的測試。 [GitHub-29145](https://github.com/magento/magento2/issues/29145)

<!-- ENGCOM-8316 -->

* 已新增由管理員從格線中刪除CMS區塊的測試。 [GitHub-30372](https://github.com/magento/magento2/issues/30372)

<!-- ENGCOM-7933 -->

* 新增將購物車規則套用至單一套件項目的測試。 [GitHub-28921](https://github.com/magento/magento2/issues/28921)

<!-- ENGCOM-8075 -->

* 新增測試以檢查 **用於** 刪除實體後，將顯示「媒體庫」影像的資訊。 [GitHub-1774](https://github.com/magento/adobe-stock-integration/issues/1774)

#### 新動作群組

* `AssertStorefrontCustomerLogoutSuccessPageActionGroup`. [GitHub-29841](https://github.com/magento/magento2/issues/29841) <!-- ENGCOM-8121 -->

* `AdminOpenConfigurationStoresPageActionGroup`. [GitHub-29848](https://github.com/magento/magento2/issues/29848) <!-- ENGCOM-8259 -->

* `ReloadPageActionGroup`. [GitHub-30683](https://github.com/magento/magento2/issues/30683) <!-- ENGCOM-8394 -->

* `StorefrontClickRefundTabCustomerOrderViewActionGroup`. [GitHub-30032](https://github.com/magento/magento2/issues/30032) <!-- ENGCOM-8203 -->

* `AdminOpenAdminThreeDSecurePageActionGroup`. [GitHub-29845](https://github.com/magento/magento2/issues/29845) <!-- ENGCOM-8115 -->

* `AdminCustomerClickFirstRowEditLinkActionGroup`.  [GitHub-29501](https://github.com/magento/magento2/issues/29501) <!-- ENGCOM-8043 -->

* `StorefrontClickAddToCartButtonActionGroup`. [GitHub-29823](https://github.com/magento/magento2/issues/29823) <!-- ENGCOM-8113 -->

* `AdminDeleteTaxRateActionGroup`. [GitHub-29940](https://github.com/magento/magento2/issues/29940) <!-- ENGCOM-8192 -->

* `AdminOpenWebConfigurationPageActionGroup`. [GitHub-29846](https://github.com/magento/magento2/issues/29846) <!-- ENGCOM-8126 -->

* `AdminOpenGeneralConfigurationPageActionGroup`. [GitHub-29847](https://github.com/magento/magento2/issues/29847) <!-- ENGCOM-8114 -->

* `AdminOrderClickSubmitOrderActionGroup`. [GitHub-29649](https://github.com/magento/magento2/issues/29649) <!-- ENGCOM-8023 -->

* `AdminOpenCatalogProductPageActionGroup`. [GitHub-29941](https://github.com/magento/magento2/issues/29941) <!-- ENGCOM-8209 -->

* `AdminClickInvoiceButtonIntoOrderActionGroup`. [GitHub-25399](https://github.com/magento/magento2/issues/25399) <!-- ENGCOM-8210 -->

* `AdminGridBulkActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminGridColumnShowActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminOpenIndexManagementPageActionGroup`. [GitHub-29825](https://github.com/magento/magento2/issues/29825) <!-- ENGCOM-8123 -->

* `AdminOpenCatalogSearchTermIndexPageActionGroup`. [GitHub-29844](https://github.com/magento/magento2/issues/29844) <!-- ENGCOM-8128 -->

* `AdminClickAddProductToggleAndSelectProductTypeActionGroup`. [GitHub-30917](https://github.com/magento/magento2/issues/30917) <!-- ENGCOM-8439 -->

* `StorefrontCheckoutClickSaveAddressButtonActionGroup`. [GitHub-30916](https://github.com/magento/magento2/issues/30916) <!-- ENGCOM-8454 -->

* `AdminOpenCurrencyRatesPageActionGroup`. [GitHub-30783](https://github.com/magento/magento2/issues/30783) <!-- ENGCOM-8432 -->

* `AdminClickGetShippingMethodsAndRatesActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `AdminSelectFixedShippingMethodActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `StorefrontClickProceedToCheckoutActionGroup`. [GitHub-30926](https://github.com/magento/magento2/issues/30926) <!-- ENGCOM-8438 -->

* `StorefrontOpenMyAccountPageActionGroup`. [GitHub-29842](https://github.com/magento/magento2/issues/29842) <!-- ENGCOM-8143 -->

### 電子報

<!-- MC-38789-->

* 管理員使用者現在可以在客戶訂閱佇列的電子報時，如預期般編輯客戶帳戶。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8034 -->

* 如果購物者未確認其電子報訂閱，應用程式現在會重新傳送電子報訂閱確認。 [GitHub-28422](https://github.com/magento/magento2/issues/28422)

<!-- ENGCOM-8429 -->

* 您現在可以在客戶訂閱佇列的電子報時，如預期般編輯客戶帳戶。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

### 付款方法

<!-- MC-35161-->

* 現在，所有網站的付款方法會如預期在多商店部署中載入。

<!-- MC-36954-->

* 應用程式不再顯示 `Purchase Order number is a required field` 購物者在部署中輸入任何資訊前（其中「採購訂單」已設定為唯一可用的付款選項），抵用券代碼欄位上方的訊息。

<!-- MC-35152-->

* 當購物者的名稱包含帶有重音的字母時，應用程式現在可成功完成Payflow Pro付款。 以前，付款未完成，應用程式記錄了此錯誤： `report.CRITICAL: String to be escaped was not valid UTF-8 or could not be converted`.

<!-- ENGCOM-8173 -->

* 訪客購物者現在可以在 **自動分配給客戶組** 啟用。 付款會在PayPal閘道上處理，訂單以Magento建立，購物者會看見訂單感謝頁面。 之前，訂單是在PayPal閘道上成功處理，但訂單未在Adobe Commerce中建立。 反之，購物者已重新導向至訂單檢閱頁面，應用程式在此顯示此錯誤： `Failed address validation: %1" error`. [GitHub-25399](https://github.com/magento/magento2/issues/25399)

#### PayPal

<!-- MC-35692-->

* 從使用信用卡的付款方法切換為非信用卡付款方法後，商家現在可以成功地從管理員下單。 以前，當商家按一下 **提交訂單** 按鈕，載入過程已開始但從未完成，並且未下訂單。

<!-- MC-37649-->

* 在使用PayPal Express下訂單時，應用程式不再建立重複訂單。 以前，當購物者嘗試使用PayPal Express支付訂單，但PayPal傳回錯誤時，應用程式仍會建立訂單。 這會導致商家網站上出現重複訂單。 [GitHub-13952](https://github.com/magento/magento2/issues/13952)

<!-- MC-38829-->

* PayPal結算報表現在可在 **報表** > **銷售** > **PayPal結算** 如預期。 以前，應用程式沒有將這些報告列在PayPal結算報告網格中，並顯示了以下消息： `We couldn't find any records`.

<!-- MC-39442-->

* 按一下 **PayPal** 結帳期間的按鈕不再觸發冗餘 `web-api` 呼叫。 之前觸發了兩個請求，使產品費用加倍。

### 效能

<!-- MC-37705-->

* 中的效能問題 `module-catalog-import-export/Model/Import/Product/Option.php` 已被處理。 減少了出口或進口100 000多筆記錄所需的時間。 請參閱 [由於有大量產品選項，匯入/匯出所需時間會超出預期](https://support.magento.com/hc/en-us/articles/360050695772) 知識庫文章。

<!-- MC-37799-->

* `Magento_Csp/Model/BlockCache` 已重構，以減少記憶體耗用，並產生不必要的大型快取字串。 過去，動態列入白名單指令碼和樣式的頁面通常會因效能問題而出現。 [GitHub-29964](https://github.com/magento/magento2/issues/29964)

<!-- MC-37816 -->

* 我們已改善目錄計畫出口的效能，包括超過10萬種使用消費者的產品。

<!-- MC-38306 -->

* 當您將禁用的產品添加或保存到類別時，應用程式不再刷新類別快取。 以前，儘管產品狀態會影響伺服器效能，應用程式仍會刷新相關類別的快取。

<!-- MC-38518 -->

* 更新購物車中產品數量的頁面載入時間已改善。 之前，應用程式會針對購物車中的每項產品執行多個個別查詢，而增加頁面載入時間。

<!-- MC-39700 -->

* 索引器已添加到 `Magento_Bulk` MySQL表，它改善了批量操作的效能。

<!-- MC-38593 -->

* 應用程式現在會快取可設定產品的子ID。 這透過減少資料庫請求數量來改善頁面載入效能。 [GitHub-30585 ](https://github.com/magento/magento2/issues/30585)

<!-- MC-37594 -->

* 管理控制面板的載入已得到改善。 之前，應用程式會在頁面載入完成前將索引標籤名稱顯示為清單。

<!-- MC-37417 -->

* 為配置快取增加過期限制，以改善Redis快取管理。 以前，在大型部署中，Redis快取快取已快速達到分配的最大記憶體，而應用程式在寫操作時擲回錯誤。

<!-- ENGCOM-8016 -->

* 移除中的備援資料庫查詢，已改善結帳效能 `app/code/Magento/Catalog/Model/CategoryLink.php`. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- ENGCOM-8290 -->

* `Magento\Framework\DB\Adapter\Pdo\Mysql->isTableExists` 已重構，以改善效能。 重複呼叫 `SHOW TABLE STATUS` 以檢查表是否存在已減少。 [GitHub-29662](https://github.com/magento/magento2/issues/29662)

<!-- ENGCOM-8258 -->

* `getPageLayoutsConfig` 現在會儲存在快取中，以改善設定產生器效能。 [GitHub-29546](https://github.com/magento/magento2/issues/29546)

<!-- MC-35614-->

* Adobe Commerce在編輯和儲存包含超過3,000,000個客戶之客戶區段時的效能已有所改善。

### 永久

<!-- MC-36647 -->

* 啟用永久性購物車時，購物者的工作階段Cookie過期後，便無法再下訂單。 反之，應用程式會顯示登入頁面，讓購物者可以登入。 之前，應用程式會下訂單。 當 `PHPSESSID` 已過期， `customerSession` 是從永久資訊中重新建立。

<!-- MC-39127-->

* 現在，當購物者登入已啟用永久性購物車的商店時，應用程式會如預期顯示歡迎訊息。 之前，應用程式會顯示 **不是你？** 訊息。

<!-- MC-38269-->

* 應用程式不再顯示 **不是你？** 文字 **記住我** 選項。

<!-- MC-37109-->

* 客戶工作階段過期後，應用程式不再顯示客戶購物車的內容。 之前，當訪客客戶嘗試在啟用永久性購物車時簽出時，應用程式會顯示此錯誤： `No such entity with cartid = 0`.

### 定價

<!-- MC-34394-->

* 連續的非同步價格更新不再互相干擾，且會將正確狀態指派給每個操作。 以前，如果非同步價格更新失敗，則後續的所有非同步價格更新都會失敗，直到相應的佇列使用者重新啟動為止。 [GitHub-27865](https://github.com/magento/magento2/issues/27865)

### 報表

<!-- MC-36652 38925-->

* **報表** > **行銷** > **購物車中的產品** 現在只顯示產生報表之使用者的允許範圍中的記錄。 以前，所有資料都可用於所有範圍。

<!-- MC-38074-->

* 在「購物車中的產品」報表中顯示產品貨幣時，應用程式現在使用在產生報表的商家的角色範圍中指定的貨幣。

<!-- MC-37934-->

* 「最近查看」和「最近比較」產品功能現在會依照多商店部署中的預期，顯示管理員中不同商店和網站的統計資料。 以前，這些功能並未考慮所有商店或網站。

<!-- MC-37217-->

* 訂單中的價格報表現在使用正確的貨幣符號。

<!-- ENGCOM-8314 -->

* 現在，當使用者按一下「管理控制面板」時，應用程式會驗證Token是否存在 **前往進階報表** 按鈕。  如果代號存在，應用程式會顯示「進階報表」頁面。 如果未設定Token，應用程式會在使用手冊中顯示資訊頁面。 [GitHub-25411](https://github.com/magento/magento2/issues/25411)

### 退貨授權(RMA)

<!-- MC-36057-->

* 現在，在分解RMA時，選定的選項將應用於分解行項目。 以前未儲存「傳回原因」、「項目條件」和「解析度」的值。

<!-- MC-35360-->

* 現在，當JavaScript捆綁啟用時，您可以刪除RMA的追蹤和運送資訊。

<!-- MC-36757-->

* 僅在特定網站範圍內對產品有限制存取的管理員現在可以將項目新增至傳回，即使該項目不再位於其網站範圍亦然。

### 評論

<!-- MC-37145-->

* 顯示於的評等數 **商店** > **屬性** > **評等** 現在符合多網站部署中的評等計數。 [GitHub-30258](https://github.com/magento/magento2/issues/30258)

<!-- MC-37117-->

* 現在，當您按一下 **新評論** 按鈕 **行銷** > **所有評論**. 按一下此頁面上的產品，會開啟該產品預期的新審核表單。

<!-- ENGCOM-8383 -->

* 當您嘗試從管理員編輯訂單時，應用程式不會再擲回此錯誤 **行銷**  >  **所有評論**: `Uncaught TypeError: Event.observe is not a function`. [GitHub-30388](https://github.com/magento/magento2/issues/30388)

### 獎勵

<!-- MC-38257-->

* 當部分訂單完成時，獎勵點現在會按照預期計算應納稅訂單。

<!-- MC-37244-->

* 商家現在可以成功針對購買了帶有獎勵點的訂單發放部分退款，然後仍然退款訂單餘額。 以前，商家無法退還訂單余數的獎勵點。

<!-- MC-37113-->

* 當購物者移除獎勵點後重新套用獎勵點時，應用程式不再顯示此錯誤： `You removed the reward points from this order`.

<!-- MC-37032-->

* 現在，當客戶在支援多種貨幣的商店中使用非基本貨幣下訂單時，系統會正確計算獎勵點數。

### 銷售

<!-- MC-36219-->

* 此 `order_created_at` 欄 `sales_shipment_grid` 現在會在每次更新後如預期般更新。

<!-- MC-36405-->

* 您現在可以成功重新訂購產品，其自訂選項日期是從 **使用JavaScript日曆** 啟用。 以前，當您嘗試重新訂購時，應用程式未將項目新增至購物車，並顯示此錯誤： `Could not add the product with SKU "simp1" to the shopping cart: Please specify date required option(s).`

<!-- MC-36533-->

* 當購物者結帳由虛擬產品組成的訂單時，應用程式不再立即關閉訂單，在啟用零小計結帳方法的部署中，總成本為$0。

<!-- MC-36755-->

* 應用程式在處理訂單之前不再封存訂單。 以前，管理訂單格線上的多選動作會影響未選取的訂單。

<!-- MC-37371-->

* 現在，當沙特里亞爾(SAR)設定為基本貨幣時，貸項通知單網格將顯示正確的貨幣符號。

<!-- MC-37880-->

* 現在，應用程式會在結帳期間，如預期般在訂單頁面上顯示出貨地址資訊。

<!-- MC-38666-->

* 的值 `total_qty` 現在符合的值 `total_qty_ordered` 在銷售發票中。

<!-- MC-38717-->

* 非同步傳送銷售電子郵件現在只會傳送上次更新日期之後建立之訂單的電子郵件。 之前，應用程式不會在啟用非同步傳送時依日期篩選電子郵件。

<!-- MC-39135-->

* 從管理員處下訂單時，應用程式現在會如預期般傳送發票電子郵件。

<!-- MC-38917-->

* 當商家從管理員為客戶建立新訂單時，應用程式現在會在工作階段期間清除現有訂單資料。

<!-- MC-38915-->

* 您現在可以針對以管理員訂單建立的新客戶，變更客戶群組，當 **啟用自動分配至客戶組** 啟用。 您也可以根據增值稅驗證來指派客戶群組。 以前，在驗證增值稅編號時，請求對象不會檢查已分配的請求 `group_id`. 依預設，會使用預設值 `group_id`.

<!-- MC-37539-->

* 應用程式不再透過 `Suspected Fraud` 狀態為 `Processing` 在商家使用REST API建立部分發運後。

### 銷售規則

<!-- MC-34793-->

* 當購物者變更運送方法時，已根據運送方法套用的抵用券代碼將不再套用。 之前，當購物者切換運送方式時，應用程式並未清除抵用券代碼。

<!-- MC-34649-->

* 購物者套用抵用券代碼的頻率不能高於 **每個客戶的使用次數** 設定允許。 以前，如果購物者有多個瀏覽器視窗且同時下了多個訂單，則每個訂單都會收到折扣，即使 **每個客戶的使用次數** 設定的值為 **1**.

### 搜尋 {#search-heading}

<!-- MC-35095-->

* Elasticsearch在搜尋同義字元上搜尋時，不會再擲回未知的修飾字元錯誤。 之前，逸出器在規則運算式中缺少逸出斜線符號，導致嚴重錯誤。

<!-- MC-37577-->

* 當將子產品配置為可見性設定為時，高級搜索不再將可配置產品的子產品作為單個搜索結果返回 **不會個別顯示**.

<!-- MC-37954-->

* 搜尋結果中產品名稱的Elasticsearch排序不再區分大小寫。

<!-- ENGCOM-8329 -->

* 現在，如預期，當 **將快取的排名最前搜索結果數設定為0** 設定已啟用於 **商店**  >  **設定**  >  **目錄**  >  **目錄**  > **目錄搜尋**.

<!-- MC-36807-->

* 目錄搜索索引器現在會執行，而不會因為Elasticsearch欄位限制而擲回錯誤。 之前，應用程式擲回此錯誤： `Limit of total fields [xxx] in index [m24dev_product_1_v10] has been exceeded`.

<!-- MC-35491-->

* 目錄搜尋的效能已改善。 停用 **啟用搜尋建議** (**商店** > **設定** > **目錄** > **目錄搜尋** )如預期般運作。 以前，應用程式查詢了MySQL `search_query` 表格，而非Elasticsearch自動完成搜尋建議。 [GitHub-25534](https://github.com/magento/magento2/issues/25534)

<!-- MC-35256-->

* Elasticsearch現在會篩選與MySQL相同的產品價格。 欄位類型 `price_*`  從 `float` to `double` 在Elasticsearch指數中，以提高精度並修正浮點誤差。

<!-- ENGCOM-8393 -->

* 已將關鍵事件接聽程式新增至管理員，以在輸入斜線時啟動全域搜尋表單。 [GitHub-29551](https://github.com/magento/magento2/issues/29551)

<!-- MC-24217-->

* Elasticsearch不再擲回錯誤，而是在 `string` 值可用來依屬性篩選產品，並搭配 `integer` 或 `decimal` 後端類型。 之前，應用程式會在 `exception.log`: `number format exception`.

<!-- ENGCOM-8303 -->

* Elasticsearch在搜尋詞包含  `/`.  [GitHub-25886](https://github.com/magento/magento2/issues/25886), [GitHub-25110](https://github.com/magento/magento2/issues/25110)

* 現在，在產品查詢中選取的客戶群組，如果 **不允許目錄搜索依據** 「一般類別權限」中的設定設定已啟用。 [GitHub-29927](https://github.com/magento/magento2/issues/29927)

<!-- ENGCOM-8466 -->

* 搜索結果不再包含同一個單詞的多個引號。 [GitHub-30104](https://github.com/magento/magento2/issues/30104)

### 裝運

<!-- MC-38247 -->

* 當網路中斷中斷與DHL運送方法的連線時，結帳程式不再失敗。 反之，應用程式會顯示其他可用的運送方法。 以前，當與DHL運送的連線中斷時，結帳程式會中止，而應用程式會顯示此錯誤： `Sorry, no quotes are available for this order at this time`. [GitHub-29902](https://github.com/magento/magento2/issues/29902)

<!-- MC-35194-->

* 說明「管理員」上UPS傳遞方法的欄位 **商店** >  **設定** > **銷售** > **傳送方法** 現在已如預期啟用。

<!-- MC-35633-->

* 通過POST建立的發運 `/rest/V1/shipment` 端點現在可正確更新訂單。 以前，應用產品建立了發運，但發運狀態仍處於處理狀態。

<!-- MC-37120-->

* 當另一個產品在透過「收貨地址」結帳前從購物車中移除時，應用程式不再從購物車中移除簡單產品。 [GitHub-30259](https://github.com/magento/magento2/issues/30259)

<!-- MC-38031-->

* 「訂單複核」頁現在顯示發運前的稅額，如預期的，將訂單發運至多個地址。

<!-- ENGCOM-8257 -->

* UPS發運跟蹤現在指示狀態為 `Delivered On` 只有在已傳送套件時。 [GitHub-30032](https://github.com/magento/magento2/issues/30032)

<!-- MC-38825-->

* 當購物者從多個地址結帳返回購物車時，應用程式現在會針對包含虛擬產品的訂單顯示正確的購物車小計。

<!-- MC-38682-->

* 啟用JavaScript捆綁時，商家現在可以從裝運頁面為使用FedEx裝運的現有訂單建立裝運標籤。 之前，當商家按一下 **建立發運標籤** 按鈕。

<!-- MC-36953-->

* 傳送給客戶的發運確認電子郵件中的發運追蹤連結，現在可如預期般運作。 之前，此連結會傳回404錯誤。

<!-- ENGCOM-8025 -->

* 當購物者使用多個地址結帳，然後移除虛擬產品以外的所有產品時，應用程式現在會顯示資訊性錯誤訊息。 [GitHub-25595](https://github.com/magento/magento2/issues/25595)

<!-- ENGCOM-8253 -->

* 您現在可以按照部分訂單的預期方式建立發運標籤。 以前，當您嘗試從訂單中僅建立一個物料的發運標籤時，應用程式將所有產品添加到包中，驗證失敗。 [GitHub-29552](https://github.com/magento/magento2/issues/29552)

<!-- ENGCOM-8154 -->

* 呼叫時，不再略過傳送方法的驗證 `/V1/guest-carts/:cartId/totals-information`. [GitHub-25147](https://github.com/magento/magento2/issues/25147)

### Sitemap

<!-- MC-37306-->

* 產生的網站地圖 `cron` 現在包含正確的影像URL。 之前，在多商店部署中，產生的快取影像路徑不正確。

### 測試

<!-- MC-39046 -->

* 現在，當您檢查首頁排程更新時，「編輯首頁」頁面會如預期顯示所有排程更新。 之前，應用程式只顯示數個排程更新中的一個。

<!-- MC-34988 -->

* 使用 `/rest/V1/products/special-price-information` 特價端點現在可以保存價格並按預期返回計畫。

<!-- MC-35362 -->

* 當匯入CSV檔案包含位元組順序標籤(BOM)時，排程匯入現在會如預期般執行。

<!-- MC-38026 -->

* 當商家計畫類別更新時，應用程式不再刪除佈局正文類。

<!-- MC-38234 -->

* 重新排程的產品變更現在不會在 `cron` 執行。

<!-- MC-38759-->

* 當您嘗試排程類別的更新時，應用程式不會再擲回錯誤。 之前，當您按一下「 」，應用程式便擲回此錯誤 **儲存** 在「計畫新更新」頁上： `Something went wrong while saving the Magento\Catalog\Api\Data\CategoryInterface`.

<!-- MC-38455-->

* 此 `rest/V1/products/special-price` 現在，API可用來排程多個商店的產品特殊價格。 以前，當商家為同一商店計畫多個商店的價格更新時，應用程式會擲出錯誤 `from` 和 `to` 在新排程的開始時間可用時間。

### 商店

<!-- ENGCOM-7543 -->

* 管理員和主要商店切換器現在會反映管理員中對商店排序順序所做的變更。 [GitHub-13401](https://github.com/magento/magento2/issues/13401)

<!-- ENGCOM-8274 -->

* 現在，在商店檢視的頂層URL索引鍵變更後，應用程式會為類別和產品建立正確的URL。 以前，當儲存視圖的類別樹包含修改時  `url_keys`，如果類別索引鍵未變更，但類別父項索引鍵已變更，則原始程式碼會在建立URL時使用類別的預設存放區檢視。 [GitHub-28633](https://github.com/magento/magento2/issues/28633)

### 目標規則

<!-- MC-34998-->

* 已最佳化產品詳細資料頁面的載入。 我們已新增資料庫表的索引，可針對許多情況最佳化目標規則條件查詢。

<!-- MC-36288-->

* 相關產品的目標規則現在可在 `is one of` 用於「產品要顯示」功能的條件包含多個條件。 以前，當此條件包含多個值時，不會剖析它。

### 稅

<!-- MC-37666-->

* 來賓訂單上的VAT驗證不再導致應用程式以錯誤的客戶稅分類保存報價。 [GitHub-30018](https://github.com/magento/magento2/issues/30018)

<!-- MC-37761-->

* 現在，在配置FPT時，可在結帳期間儲存發運至多個地址的訂單。 之前，在完成多個地址的訂單後，應用程式會顯示空白頁面，而非訂單成功頁面。

<!-- ENGCOM-8158 -->

* 店面產品詳細資料頁面現在會如預期般顯示有無稅的新舊價格。 [GitHub-27500](https://github.com/magento/magento2/issues/27500), [GitHub-11998](https://github.com/magento/magento2/issues/11998)

### 測試

<!-- MC-37364-->

* `bin/magento dev:tests:run` 現在會如預期般啟動下列測試：全部、單元、整合、全部、靜態、全部、完整性、舊版和預設。

<!-- MC-38488-->

* `AdminMediaGalleryInsertLargeImageFileSizeTest` 已重構。

<!-- ENGCOM-8158 -->

* 單元測試現在與PHPUnit 8相容。 [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-8009 -->

* `\Magento\TestFramework\TestCase\WebapiAbstract` 現在包含的函式可支援比較測試中預期和實際結果的大型巢狀陣列。 結果中的無關鍵現在可以忽略。 [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-8024 -->

* `AdminMediaGalleryCatalogUiEditCategoryGridPageTest` 不再隨機失敗。 [GitHub-1764](https://github.com/magento/adobe-stock-integration/issues/1764)

<!-- ENGCOM-8041 -->

* `dev/tests/integration/testsuite/Magento/Customer/Controller/AccountTest` 已改善。 (`assert` 現在以 `XPath` 選取器而非 `assertStringContainsString`.) [GitHub-29700](https://github.com/magento/magento2/issues/29700)

<!-- ENGCOM-8017 -->

* 新增 `AdminAnalytics` 模組。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-8266 -->

* 整合和API功能測試現在與PHPUnit 9.3相容。 [GitHub-30146](https://github.com/magento/magento2/issues/30146)

<!-- MC-35798 8109-->

* 修正GraphQL的問題 `testRequestCacheTagsForCategoryListOnMultipleIds` 測試。 [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-8327 -->

* 公司信用的貨幣可用性測試已自動化。

<!-- ENGCOM-7762 -->

* 包含URL的標題值現在會在 `ApiFunctional TestFramewor`k. [GitHub-26425](https://github.com/magento/magento2/issues/26425)

<!-- ENGCOM-8382 -->

* `—no-tablespaces` 已新增至 `mysqldump`，允許在沒有 `PROCESS` 權限(自MySQL 5.7.31 / 8.0.21以來需要運行 `mysqldump` )。 [GitHub-30566](https://github.com/magento/magento2/issues/30566)

### 主題

<!-- ENGCOM-8419 -->

* 新 `--no-parent` 旗標已新增至 `bin/magento setup:static-content:deploy` 阻止編譯主題的父項的命令。 這個新標幟可避免不必要的編譯，大幅改善靜態內容部署程式的效能。 請注意，此新標幟在使用 `compact` 策略。 [GitHub-30184](https://github.com/magento/magento2/issues/30184)

<!-- MC-37630 -->

* 設計配置不再生成DDL操作。 以前，在更新設計配置時，應用程式生成了可觸發MySQL錯誤的DDL語句。

<!-- ENGCOM-8112 -->

* 冗餘代碼 `Magento_ConfigurableProduct` 「管理」主題中的模組已移除。  [GitHub-29857](https://github.com/magento/magento2/issues/29857)

<!-- ENGCOM-8144 -->

* 已移除空白主題中冗餘較少的樣式導覽和未使用的屬性。 [GitHub-29914](https://github.com/magento/magento2/issues/29914)

<!-- ENGCOM-8285 -->

* 在行動檢視的空白主題中新增可折疊的導覽功能。 [GitHub-30237](https://github.com/magento/magento2/issues/30237)

<!-- ENGCOM-7803 -->

* 已最佳化主題的網頁字型載入。  [GitHub-29526](https://github.com/magento/magento2/issues/29526)

<!-- ENGCOM-8068 -->

* 開發人員現在可以在主題中聲明自訂字型時指定字型類型。 [GitHub-29719](https://github.com/magento/magento2/issues/29719)

### 翻譯和地區設定

<!-- MC-36836 -->

* 「管理員訂單」格線「日期選取器」現在如預期般運作(當「管理員區域設定」為阿拉伯文(`ar_SA - Saudi Arabia`)。

<!-- MC-38476 -->

* 註冊或新增新地址時，當購物者以有效的貼文代碼輸入阿根廷地址時，應用程式不再顯示錯誤訊息。 之前，應用程式會顯示此錯誤： `Provided Zip/Postal Code seems to be invalid. Example: 1234. If you believe it is the right one you can ignore this notice.`

<!-- MC-38663-->

* 當購物者為韓文地址輸入5位數的郵遞區號時，應用程式不再擲回錯誤。

<!-- ENGCOM-8244 -->

* 新增對烏拉圭地區的支援，定義於 [ISO 3166-2:UY](https://en.wikipedia.org/wiki/ISO_3166-2:UY). [GitHub-29729](https://github.com/magento/magento2/issues/29729)

<!-- ENGCOM-8220 -->

* `zip_codes.xml` 已更新，以對巴西郵遞區號強制執行八位數。 [GitHub-29984](https://github.com/magento/magento2/issues/29984)

<!-- ENGCOM-8304 -->

* 已改善其餘未本地化片語的本地化。 [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8380 -->

* 現在可以轉換網格搜索輸入佔位符。 [GitHub-30510](https://github.com/magento/magento2/issues/30510)

<!-- ENGCOM-8018 -->

* 應用程式現在只會在啟用內嵌翻譯JavaScript模組時下載。  [GitHub-29553](https://github.com/magento/magento2/issues/29553)

### UI

<!-- MC-38509-->

* 此 **建立帳戶** 當購物者輸入無效資料時，「建立新帳戶」頁面上的按鈕仍然有效。 之前此按鈕是停用的，因此在發生錯誤後，購物者無法重新嘗試建立帳戶。 這是2.4.1的已知問題。 [GitHub-30513](https://github.com/magento/magento2/issues/30513)

<!-- MC-38698-->

* 改善在「管理訂單編輯」頁面上載入運送格線的功能。

<!-- MC-37870-->

* 應用程式現在會顯示  **與帳單地址相同** 當產品已透過SKU新增至購物車時，核取方塊。

<!-- ENGCOM-8007 -->

* 定義有限寬度的CSS類別現在會如預期般套用至 **開始時間** 管理欄位 **商店**  >  **設定**  >  **目錄**  >  **XML Sitemap**  >  **層代設定**.  [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992 -->

* 修正「條款與條件」核取方塊標籤的顯示問題。  [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7948 -->

* 當無法取得階層價格時，應用程式不再在產品頁面上顯示階層價格區塊的CSS程式碼。 [GitHub-29194](https://github.com/magento/magento2/issues/29194)

<!-- ENGCOM-8084 -->

* 已重新排序影像檢視詳細資訊頁面上的按鈕位置，以符合使用者介面准則。  [GitHub-1783](https://github.com/magento/adobe-stock-integration/issues/1783)

<!-- ENGCOM-8342 -->

* 抵用券代碼文字欄位現在在Internet Explorer/EDGE瀏覽器中以適當寬度顯示。

<!-- ENGCOM-7630 -->

* 此 `@button__border-radius` 變數現在定義於 `lib/web/css/source/lib/variables/_buttons.less` 程式庫。  `border-radius` 的預設值為 `3px`. 以前， `border-radius` 是硬編碼的。  [GitHub-28674](https://github.com/magento/magento2/issues/28674)

<!-- ENGCOM-8067 -->

* 現在會停用迷你搜尋欄位中的提交搜尋按鈕（放大鏡），直到達到最小搜尋字串長度為止。 [GitHub-29704](https://github.com/magento/magento2/issues/29704)

<!-- MC-38807-->

* 此 **預覽範本** 按鈕現在可如預期在「編輯佇列」頁面中運作。

<!-- MC-35624-->

* 調整游標從中間到開頭的位置 **訊息** 欄位 **我的帳戶** > **禮品註冊** > **共用禮品註冊**.

<!-- MC-33497-->

* 已解決「新增排程匯出」頁面上的欄配置顯示問題。

<!-- MC-31892-->

* 現在，當您將屬性從一個群組移動到另一個群組時，應用程式會保留屬性的值。

<!-- MC-37635-->

* 應用程式現在會在 **日期** 在「建立帳戶」頁面上如預期輸入欄位。

<!-- ENGCOM-8085 -->

* 新增字型粗細變數至 `lib/web/css/source/lib/variables/_typography.less`. [GitHub-29778](https://github.com/magento/magento2/issues/29778)

<!-- ENGCOM-8211 -->

* 篩選器可見性現在可如管理格線中預期般搭配欄可見性運作。  [GitHub-30345](https://github.com/magento/magento2/issues/30345)

<!-- ENGCOM-7977 -->

* 使用者捲動時，應用程式在「管理員登入為客戶」頁面上顯示的橫幅現在會維持在頁面頂端。 [GitHub-29354](https://github.com/magento/magento2/issues/29354)

<!-- ENGCOM-8152 -->

* 當 `this.disabled(true)` 已設定。 [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7901 -->

* 此 `@font-family-name__base` 載入開啟的Sans字型時，變數不再使用。 [GitHub-29515](https://github.com/magento/magento2/issues/29515)

<!-- ENGCOM-8120 -->

* WAI-ARIA屬性 `aria-atomic="true"` 已新增至錯誤容器標籤。 [GitHub-29560](https://github.com/magento/magento2/issues/29560)

<!-- ENGCOM-8175 -->

* UI元件格線現在會顯示所選項目的準確計數。 以前，當按關鍵字搜索選擇了所有網格項，而購物者隨後在選擇頁首複選框之前取消選擇了某些項時，網格指示了錯誤的選擇數。 [GitHub-29968](https://github.com/magento/magento2/issues/29968)

<!-- ENGCOM-8118 -->

* 應用產品不再在發票和發運概覽頁上顯示未呈現的HTML。 [GitHub-29958](https://github.com/magento/magento2/issues/29958)

<!-- ENGCOM-8066 -->

* 按一下 **選項** 管理員 **商店**  >  **匯率**  現在會將使用者導向「系統設定」頁面的「擴充貨幣選項」區段。 [GitHub-29336](https://github.com/magento/magento2/issues/29336)

<!-- ENGCOM-8361 -->

* 改善根據下列其他條件顯示介面工具集的支援： `adminhtml` 使用選擇器介面工具集類型時使用介面工具集。 [GitHub-13316](https://github.com/magento/magento2/issues/13316), [GitHub-7252](https://github.com/magento/magento2/issues/7252), [GitHub-6868](https://github.com/magento/magento2/issues/6868)

<!-- ENGCOM-8336 -->

* 改善Luma主題中確認快顯對話方塊中的文字填補。 [GitHub-30452](https://github.com/magento/magento2/issues/30452)

### 保管庫

<!-- MC-39109-->

* 此 `Vault` 模組現在從支付資訊管理服務的請求中識別支付方法代碼。 以前，當購物者使用儲存的Braintree信用卡下單時，即使使用有效的付款方法，應用程式仍擲回此錯誤： `The requested Payment Method is not available`.

### 頂點

* 修改地址時，現在會如預期般移除地址建議。

* 已解決某些客戶無法儲存其帳戶面板之位址的競爭條件。

* 在某些情況下，頂點地址驗證不再將「地址編輯」頁添加到全頁快取中。

* 現在，當為含稅額配置免運時，將考慮頂點計算稅。

### Web API架構

<!-- MC-23904 ENGCOM-8421-->

* 您現在可以使用POST `V1/invoice/:invoiceId/refund` 退回產品數量為零且運費為零的發票(例如 `{"items": [{"qty": 0, "orderItemId": 6, "extensionAttributes": {}}], "appendComment": false, "notify": true, "isOnline": true, "arguments": {"adjustment_negative": 0.0, "adjustment_positive": 0.99, "shipping_amount": 0}}.` )之前，應用程式擲回此錯誤： `You can't create a creditmemo without products`. [GitHub-23069](https://github.com/magento/magento2/issues/23069)

<!-- MC-33732 -->

* 您現在可以使用POST `V1/categories` 來建立或更新類別。 之前，若 `default_sort_by` 值設為陣列。 當 `default_sort_by` 值設為字串，應用程式擲回此錯誤： `Error occurred during \"custom_attributes\" processing. Attribute \"default_sort_by\" has invalid value. The \"string\" value's type is invalid. The \"string[]\" type was expected. Verify and try again.`

<!-- MC-35740 -->

* 使用POST `V1/invoices/:id/capture` 如預期，擷取付款資訊將可正常運作。 以前，應用程式授權了訂單，但只在支付網關的站點上捕獲了訂單。

<!-- MC-37794 -->

* 使用POST時 `V1/order/:orderId/ship` 要建立部分發運，終結點將返回正確的已發運產品數。

<!-- MC-38425-->

* 使用POST建立的發票 `V1/order/:orderID/invoice` 現在，可準確反映按商店信用額度的部分付款。 以前，當以商店信用額度支付部分訂單時，建立發票時不考慮商店信用額度。

<!-- MC-36830-->

* GET `rest/all/V1/categories` 和GET `rest/all/V1/categories?rootCategoryId=2` 呼叫現在已回呼 `name` 和 `product_count` 樹中所有類別的欄位。 之前，類別欄位值為空。 表格名稱解析器外掛程式針對依類別擷取產品計數傳回錯誤的表格名稱。

<!-- ENGCOM-8286 -->

* PUT `V1/categories/:id` 現在，端點會儲存為類別URL金鑰建立301重新導向所需的資料(當 `save_rewrites_history` 提供自訂屬性。 [GitHub-29174](https://github.com/magento/magento2/issues/29174), [GitHub-30240](https://github.com/magento/magento2/issues/30240)

### 願望清單

<!-- MC-33626-->

* 現在，當產品指派給自訂庫存來源時，購物者可將產品新增至願望清單。 [GitHub-3018](https://github.com/magento/inventory/issues/3018)

<!-- MC-35416-->

* 當客戶從店面將產品新增至其願望清單後，管理員現在可以從管理員客戶頁面存取「管理購物車」頁面。 以前，管理員按一下 **管理購物車** 按鈕： `An error has occurred. See error log for details`.

<!-- MC-35573-->

* 此 **新增至購物車** 「共用願望清單」頁面上的按鈕現在對未登入的匿名、來賓和使用者可正常運作。

<!-- MC-34411-->

* 購物者現在可以成功將產品從一個願望清單移至另一個願望清單。

<!-- ENGCOM-8062 -->

* 應用程式現在會如預期般，在Wishlist頁面中顯示所選可配置產品屬性選項。 [GitHub-24091](https://github.com/magento/magento2/issues/24091),  [GitHub-22503](https://github.com/magento/magento2/issues/22503)

<!-- ENGCOM-7779 -->

* 已實作 `ActionInterface` for `\Magento\Wishlist\Controller\Shared\Allcart`. [GitHub-29537](https://github.com/magento/magento2/issues/29537)

## 已知問題

**問題**:此 `[magento_root]/index.php` 檔案已移除，應用程式現在可從 `/pub` 依預設，適用於Apache設定。 從子資料夾提供的儲存將無法如預期運作，且可能會顯示404錯誤。 **因應措施**:使用symlink將安裝模擬到子資料夾中。 下列範例使用兩個存放區(`https://shop01.com/shop/` 和 `https://shop02.com/shop/`)，以說明如何使用symlink模擬子資料夾中的安裝。

1. 為建立子目錄 `https://shop01.com/shop/`:

   ```bash
   mkdir magento_root/pub/shop01
   ```

   ```bash
   cd magento_root/pub/shop01
   ```

1. 在新建目錄中為儲存的父目錄建立符號連結：

   ```bash
   ln -s ../media media
   ```

   ```bash
   ln -s ../static static
   ```

   ```bash
   ln -s ../../../pub pub
   ```

   ```bash
   ln -s ../.htaccess .htaccess
   ```

   ```bash
   ln -s ../health_check.php health_check.php
   ```

1. 建立 `index.php` 新目錄中的檔案(`magento_root/pub/shop01/index.php`)並新增此內容：

```php
   <?php
   require realpath(__DIR__) . '/../../../app/bootstrap.php';

   switch ($_SERVER['HTTP_HOST']) {
       case 'shop01.com':
       case 'www.shop01.com':
           $params = $_SERVER;
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = 'shop01';
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = 'website';
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
           break;

       default:
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $_SERVER);
           /** @var \Magento\Framework\App\Http $app */
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
       break;
   }
```

1. 設定您的Apache伺服器以指向新子目錄。 部署配置可能差異很大。 以下是伺服器配置的範例：

```xml
   <VirtualHost *:80>
       DocumentRoot "magento_root/pub/shop1"
       ServerName shop01.com
   </VirtualHost>
```

**問題**:商家必須從管理員啟用「快速強制TLS」功能，以啟用所有存放頁面的全域HTTP至HTTPS重新導向。 請參閱 [針對雲端上的所有頁面，將HTTP重新導向至HTTPS（強制TLS）](https://support.magento.com/hc/en-us/articles/360006296953) 知識庫文章。 <!-- MC-39988-->

**問題**:您無法使用 `addConfigurableProductToCart` GraphQL變異，可在執行Inventory的多商店部署中，以非預設的商店檢視將可設定產品新增至購物車。 （路馬店不受影響。） 應用程式顯示此錯誤： `Could not add item to cart. Please check required options and try again`. **因應措施**:使用 `addProductsToCart` 而是變異。 [GitHub-31660](https://github.com/magento/magento2/issues/31660)<!-- PWA-1298-->

**問題**:當購物者首次在「付款」頁面的「驗證碼」欄位中輸入正確代碼，但顯示此錯誤時，應用程式不會如預期提交付款資訊： `There has been an error processing your request`. 只有當購物者嘗試下訂單而未輸入驗證碼或錯誤輸入時，才會發生此情況。  **因應措施**:重新整理頁面。 <!-- MC-40506-->

**問題**:當購物者點按時，應用程式會以預期的Braintree建立訂單 **使用Venmo支付**，但不會在管理員中建立順序。 **因應措施**:無。 請參閱 [2.4.2已知問題：BraintreeVenmo付款無法運作](https://support.magento.com/hc/en-us/articles/360054662652/)  知識庫文章。  <!-- BUNDLE-2894-->

### B2B已知問題

**問題**:B2B購買者可使用線上付款方法來略過通常的採購訂單流程。 如果購買者可以將其整個結帳總計減少為0（例如，通過促銷代碼或禮品卡），然後刪除代碼或禮品卡，則會發生這種情況。 即使在這種情況下，申請人仍根據所分配目錄中商品的價格訂購正確數量的商品。 **因應措施**:啟用線上支付方法進行採購訂單審批時，禁用禮品卡和優惠券代碼。 <!-- B2B-1603-->

**問題**:當您嘗試使用PayPal Express Checkout從採購訂單下單時，系統會將購買者重新導向至購物車 **內容模式** 已停用。 <!-- B2B-1604-->

**問題**:購買者建立採購訂單，然後導覽至結帳頁面時，應用程式有時會顯示404錯誤。 當購買者在導覽至結帳頁面之前，先使用線上付款方法建立不同的採購訂單，而未完成先前的購買時，即會發生此錯誤。 採購員仍然可以下訂單。 **因應措施**:無。 <!-- B2B-1605-->

**問題**:特定付款方法的折扣在採購訂單的結帳期間持續存在，即使買方在最終結帳期間更改其付款方法也是如此。 因此，客戶可能獲得他們無權獲得的折扣。 發生此情況是因為，儘管付款方法有所更改，仍然應用原始付款方法的購物車規則。 **因應措施**:無。 請參閱 [2.4.2 B2B已知問題：付款方法更改後，線上採購訂單的折扣將保持不變](https://support.magento.com/hc/en-us/articles/360054667312) 知識庫文章。 <!-- B2B-1012 -->

**問題**:此 `deleteRequisitionListOutput` 查詢返回有關已刪除申請清單的詳細資訊，而不是剩餘的申請清單。 <!-- MC-39894-->

## 社群投稿

我們感謝廣大的Magento Open Source社群，並感謝他們對本版的貢獻。

社群工程團隊 [Magento貢獻者](https://magento.com/magento-contributors) 依月、季和年維護最佳貢獻個人和合作夥伴的清單。 在該「貢獻者」頁面中，您可以在GitHub上追蹤合併PR的連結。

### 合作夥伴貢獻

下表重點介紹合作夥伴的貢獻。 下表列出提取請求、外部提取請求以及與其相關聯的GitHub問題編號（若有）的貢獻者。

{{$include /help/_includes/release-notes/engcomm-2-4-2-partner.md}}

### 個人貢獻者貢獻內容

下表列出社群成員的貢獻。 下表列出外部提取請求、與其相關聯的GitHub問題編號（若有），以及提供提取請求的社群成員。

{{$include /help/_includes/release-notes/engcomm-2-4-2-issues.md}}

### 系統需求

我們的技術堆棧構建在PHP和MySQL上。 如需詳細資訊，請參閱 [系統需求](../../../installation/system-requirements.md).

### 安裝和升級指示

您可以使用 [撰寫器](../../../installation/composer.md).

## 遷移工具包

資料移轉工具可協助將現有Magento1.x儲存資料至Magento2.x。此命令列介面包括驗證、進度追蹤、記錄和測試功能。 如需安裝指示，請參閱 [安裝資料移轉工具](../../../tools/data-migration-tool/install.md). 考慮探索或協助 [資料移轉存放庫](https://github.com/magento/data-migration-tool).

此 [代碼遷移工具包](https://github.com/magento-commerce/code-migration) 協助將現有Magento1.x儲存擴充功能和自訂項目傳輸至Magento2.x。命令行介面包括用於轉換Magento1.x模組和佈局的指令碼。
