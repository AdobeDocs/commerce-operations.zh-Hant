---
title: Adobe Commerce 2.4.2發行說明
description: 瞭解2.4.2 Adobe Commerce版本中的新功能、增強功能、錯誤修正和已知問題。
exl-id: eb6c836c-0725-4f82-97ab-317b45ba55db
source-git-commit: 95ea96a566b0579a22b2ba738bd4a4bceef8cd9c
workflow-type: tm+mt
source-wordcount: '15295'
ht-degree: 0%

---

# Adobe Commerce 2.4.2發行說明

Adobe Commerce 2.4.2引進了效能和安全性的增強功能，以及重要的平台改善。 安全性增強功能包括擴充所有Cookie的`SameSite`屬性支援。 B2B改善著重於支援採購單的線上付款。 現已支援Elasticsearch 7.9.x和Redis 6.x。

此版本包含280多項核心程式碼的新修正及35項安全性增強功能。 其中包括由我們的社群成員解決近290個GitHub問題。 這些社群貢獻的內容包括核心程式碼的少量清理，以及GraphQL中的重大增強功能。

此版本已修正2.4.1中確認的所有已知問題。

{{bics}}

## 套用`AC-3022.patch`以繼續提供DHL作為運送承運商

DHL已匯入schema 6.2版，並將在不久的未來淘汰schema 6.0版。 支援DHL整合的Adobe Commerce 2.4.4及舊版僅支援6.0版。部署這些版本的商戶應儘早套用`AC-3022.patch`，以繼續提供DHL作為運送承運商。 請參閱[套用修補程式，以繼續提供DHL作為運送業者](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier)知識庫文章，以取得有關下載和安裝修補程式的資訊。

## 有可用的安全性修補程式

商戶現在可以安裝時效性強的安全性修正，而不需套用完整每季發行版本提供的數百個功能修正和增強功能（例如2.4.1-p1）。 修補程式2.4.0.12 （Composer套件2.4.1-p1）是安全性修補程式，針對先前季度發行版本2.4.1中發現的弱點提供修正。此安全性修補程式包含套用至2.4.1版的所有修補程式。 （*Hot Fix*&#x200B;提供已發行版本的修正，該版本可解決特定問題或錯誤。）

如需安全性修補程式的一般資訊，請參閱[引入新的安全性修補程式版本](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287)。 如需有關下載和套用安全性修補程式（包括修補程式2.4.1-p1）的說明，請參閱[快速入門內部部署](../../../installation/composer.md)。 安全性修補程式僅包含安全性錯誤修正，不包含完整修補程式中包含的其他安全性增強功能。

## 其他發行資訊

雖然這些功能的程式碼已隨季度發行套件提供，但其中幾個專案(例如B2B、Page Builder和Progressive Web Applications (PWA) Studio)也獨立發行。 這些專案的錯誤修正記錄在每個專案檔案中提供的個別專案特定發行資訊中。

## 反白顯示

請檢視此版本中的下列重點專案。

### 大幅增強安全性

此版本包含超過35項安全性修正和平台安全性改善。 所有安全性修正已反向移植至2.4.1-p1和2.3.6-p1。

#### 超過35項安全性增強功能，有助於關閉遠端程式碼執行(RCE)和跨網站指令碼(XSS)漏洞

目前尚未發生與這些問題相關的已確認攻擊。 但是，某些漏洞可能會被用來存取客戶資訊或接管管理員工作階段。 這些問題大多需要攻擊者先取得Admin的存取權。 因此，我們提醒您採取一切必要步驟來保護您的管理員，包括但不限於：IP允許清單、[雙因素驗證](https://developer.adobe.com/commerce/testing/functional-testing-framework/two-factor-authentication/)、使用VPN、使用唯一位置而非`/admin`以及良好的密碼衛生。 如需這些已修正問題的討論，請參閱[Adobe安全性公告](https://helpx.adobe.com/tw/security/products/magento/apsb21-08.html)。

#### 其他安全性增強功能

此版本的安全性改善包括：

* 所有核心Cookie現在都支援`SameSite`屬性。

* 當使用者嘗試儲存產品和類別說明欄位中的值時，應用程式現在會顯示可識別潛在惡意內容的訊息。

* 各元件的檔案系統作業已標準化並強化，以防止惡意上傳。

* 已修正核心內容安全性原則(CSP)違規。

{{cve-notice}}

### 基礎架構改良

此版本包含核心品質的增強功能，可改善架構的品質，並包含下列功能區域：客戶帳戶、目錄、CMS、OMS、匯入/匯出、促銷活動與鎖定目標、購物車與結帳、B2B以及測試與預覽。

### 平台增強功能

* [**現在支援Elasticsearch 7.9.x**](../../../installation/system-requirements.md)。 雖然我們建議您執行Elasticsearch 7.9.x，但2.4.x版仍與Elasticsearch 7.4.x相容。<!-- MC-36867-->

* 2.4.2已使用[Varnish 6.4](../../../installation/system-requirements.md)進行測試。 2.4.x版仍與Varnish 6.x相容。

* 現在支援&#x200B;[**Redis 6.x**](../../../installation/system-requirements.md)。 2.4.x版與Redis 5.x仍可相容。<!-- MC-34853-->

* 2.4.2現在與&#x200B;**Composer 2.x**&#x200B;相容。 我們建議商戶移轉至Composer 2.x。雖然您可以使用Composer 1.x安裝此版本，但Composer 1.x即將終止服務。 如需Composer 2.x功能的概述，請參閱[現已推出Composer 2.0！](https://blog.packagist.com/composer-2-0-is-now-available/)

此版本已棄用設定安裝以使用分割資料庫的功能。 目前使用分割資料庫的商家，應開始計畫回覆或移轉至單一資料庫，或使用替代方法。 請參閱Adobe Commerce[ DevBlog文章中的](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187)取代分割資料庫功能，以取得此問題的概觀。  如需移轉指示，請參閱[從分割的資料庫還原至單一資料庫](../../../configuration/storage/revert-split-database.md)。

### 效能增強功能

此版本包含程式碼增強功能，可針對具有大型目錄的部署提升API效能以及管理員回應時間。 多重擴充性增強功能可讓2.4.2以原生方式支援複雜目錄，擴充幅度最高達先前版本的20倍。

### GraphQL

此版本新增GraphQL涵蓋下列功能：

* 新增對多個願望清單的支援。 您可以使用GraphQL來[建立](https://developer.adobe.com/commerce/webapi/graphql/schema/wishlist/mutations/create/)、[刪除](https://developer.adobe.com/commerce/webapi/graphql/schema/wishlist/mutations/delete/)和[重新命名](https://developer.adobe.com/commerce/webapi/graphql/schema/wishlist/mutations/update/)願望清單，以及在它們之間移動[或](https://developer.adobe.com/commerce/webapi/graphql/schema/wishlist/mutations/move-products/)複製[個專案。](https://developer.adobe.com/commerce/webapi/graphql/schema/wishlist/mutations/copy-products/)<!-- MC-32356-->

* 新增退貨授權(RMA)支援。 購物者可以[要求退貨](https://developer.adobe.com/commerce/webapi/graphql/schema/orders/mutations/request-return/)。 如果商家接受要求，則購物者可以執行[新增註解](https://developer.adobe.com/commerce/webapi/graphql/schema/orders/mutations/add-return-comment/)和[新增追蹤資訊](https://developer.adobe.com/commerce/webapi/graphql/schema/orders/mutations/add-return-tracking/)等工作。<!-- MC-34596-->

* 已新增對下列B2B功能的支援：
   * 公司。 您可以新增公司[管理員](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/company/mutations/create/)、[使用者](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/company/mutations/create-user/)、[角色](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/company/mutations/create-role/)和[團隊](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/company/mutations/create-team/)。<!-- MC-33861-->
   * 公司評價。 [公司查詢](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/company/queries/company/)包含公司信用記錄的詳細資料。<!-- MC-33862-->
   * 請購單清單。 您可以[建立](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/create/)、[刪除](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/delete/)和[更新](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/update/)請購單清單。 支援還包括將[新增](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/add-products/)、[更新](https://developer.adobe.com/commerce/webapi/graphql/schema/wishlist/mutations/update-products/)、[刪除](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/delete-items/)、[複製](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/copy-items/)和[移動](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/move-items/)專案在請購單清單中，以及將請購單清單專案[新增到購物車](https://developer.adobe.com/commerce/webapi/graphql/schema/b2b/requisition-list/mutations/add-items-to-cart/)的功能。<!-- MC-34312-->

* 新增對GraphQL中聯合的支援。 [GitHub-29425](https://github.com/magento/magento2/issues/29425) <!-- ENGCOM-8291 -->

* 新增對[比較清單](https://developer.adobe.com/commerce/webapi/graphql/schema/products/queries/compare-list/)的支援。 購物者可以[建立](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/create-compare-list/)與[刪除](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/delete-compare-list/)比較清單，以及[新增](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/add-products-to-compare-list/)與[移除](https://developer.adobe.com/commerce/webapi/graphql/schema/products/mutations/remove-from-compare-list/)專案至比較清單。 此外，以訪客身分建立比較清單的購物者可以客戶身分登入，並[保留](https://developer.adobe.com/commerce/webapi/graphql/schema/customer/mutations/assign-compare-list/)他們的比較清單。

* 新增[`generateCustomerTokenAsAdmin`](https://developer.adobe.com/commerce/webapi/graphql/schema/customer/mutations/generate-token-as-admin/)突變並更新`Customer`物件以支援遠端購買協助。

* 新增跨商店的本地化支援，以支援變更語言、購物車及貨幣等工作。<!-- MC-37801-->

* GraphQL結構已增強，以最佳化具有許多變體的可設定產品的產品資料擷取。<!-- MC-36138-->

* 整數型別物件識別碼已過時，改用型別識別碼的`uid`屬性。<!-- MC-36346-->

* 已將`staging`屬性新增至[`ProductInterface`](https://developer.adobe.com/commerce/webapi/graphql/schema/products/interfaces/attributes/)和[`CategoryInterface`](https://developer.adobe.com/commerce/webapi/graphql/schema/products/interfaces/category/)，以判斷產品是否已暫存，並檢視其相關的行銷活動資訊。<!-- MC-33897-->

如需這些增強功能的詳細資訊，請參閱[GraphQL開發人員指南](https://developer.adobe.com/commerce/webapi/graphql/)。

### B2B

2.4.2匯入B2B v1.3.1。此版本包含對採購單線上付款的支援，以及多項錯誤修正。

**現在可以使用線上付款方式完成訂單**。 系統會提示B2B買家在初始結帳期間，為每個[採購單](https://experienceleague.adobe.com/zh-hant/docs/commerce-admin/b2b/purchase-orders/purchase-order-flow)選取其偏好付款方式。 核准採購單之後，系統會提示採購員輸入付款明細，以將採購單轉換為最終訂單。

若要支援接受線上付款的完整工作流程，此功能也會：

* 在初始結帳期間覆寫現有的付款方式範本，以維持PCI法規遵循。

* 維護與協力廠商、自訂和社群開發的支付方法的相容性。

* 當買家需要新增付款詳細資料至已核准的採購單時，透過電子郵件通知他們。

* 啟用來自管理員的電子郵件自訂，可讓商家使用與其品牌一致的範本。

* 引入採購單的`Approved – Pending Payment`狀態，以清楚顯示何時需要動作。

* 防止在最終付款步驟中新增或移除折扣代碼，以確保已核准採購單的訂單總金額保持不變。

* 允許買家在最後付款步驟中變更付款方式，以維持彈性並提高轉換。

此版本也包含多項錯誤修正。 請參閱[B2B發行說明](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html?lang=zh-Hant)。

### PWA Studio

此版本的PWA Studio包括：

* 國際化和本地化。 Venia現在支援多種語言和貨幣。

* 改善擴充功能框架，可透過擴充功能支援程式碼變更。

* 「我的帳戶」相關功能的初始元件，例如「願望清單」、「已儲存付款」、「通訊錄」及「訂單歷史記錄」。

* 各種效能最佳化和錯誤修正。

如需有關增強功能和錯誤修正的資訊，請參閱[PWA Studio發行版本](https://github.com/magento/pwa-studio/releases)。 如需PWA Studio版本及其相容版本的清單，請參閱[相容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/)。

### 頁面產生器

此版本包含頁面產生器內容移轉及頁面產生器CSS自訂的增強功能：

* 開發人員現在可以依照檢視區，以不同的方式設定內容型別輸出，而不需使用`!important`指示詞。

* 移轉至頁面產生器的內容不再以預設內嵌樣式填入。

* Page Builder不再要求將所有內容型別置入列。 [頁面產生器階段](https://experienceleague.adobe.com/zh-hant/docs/commerce-admin/page-builder/walkthrough/3-catalog-content#stage)現在一開始是空白的，並支援將下列內容型別直接新增到階段：列、欄、索引標籤、HTML程式碼、區塊、動態區塊。

* 內容型別不再需要預先定義的邊界與內邊距。

* 表單欄位值的新行動[檢視區切換器](https://experienceleague.adobe.com/zh-hant/docs/commerce-admin/page-builder/walkthrough/3-catalog-content#viewports)和檢視區範圍可讓使用者和開發人員執行下列動作：

   * 製作時檢視不同檢視連線埠上的內容。

   * 針對每個檢視區的不同內容型別最佳化最低高度欄位引數。 (開箱即用僅支援一個引數（最小高度）。 啟用其他內容引數的行動最佳化所需的自訂開發。)

   * 新增欄位範圍至自訂欄位和欄位集（開發人員）。

### 互動式產品內指南

互動式產品內指導透過新功能公告、逐步說明指南、上線資訊和工具提示，為商家提供管理員內的使用提示和資訊。  如果未啟用此功能，**管理員必須從管理員選擇加入，才能收到產品內指南**。 檢視[使用情況資料集合](https://experienceleague.adobe.com/zh-hant/docs/commerce-admin/start/admin/admin)和[管理員使用情況](https://experienceleague.adobe.com/zh-hant/docs/commerce-admin/config/advanced/admin#admin-usage)。

### Adobe Stock整合

此版本包含Adobe Stock整合v2.1.1。

### 媒體集

**媒體集的新角色資源**。 此版本讓商家能夠限制管理員僅存取媒體集，並控制誰可以執行這些動作：

* 將媒體資產插入內容

* 上傳資產

* 編輯資產詳細資訊

* 從媒體集刪除資產

* 管理檔案夾結構。

內容&#x200B;**中的**&#x200B;網頁最佳化影像。 商戶現在可以在內容中使用[網頁最佳化的影像轉譯](https://experienceleague.adobe.com/zh-hant/docs/commerce-admin/content-design/wysiwyg/gallery/media-gallery-image-optimization)，而非高解析度的影像。 原始影像在「媒體集」中保持未修改狀態，且影像插入內容時會動態產生影像轉譯。

### AWS S3支援增強功能

Amazon Simple Storage Service (AWS S3)支援已增強，包含對以下專案的支援：

* 物件儲存與未來擴充性

* [在AWS S3上儲存媒體檔案](../../../configuration/remote-storage/remote-storage.md)

所有模組均已新增對AWS S3的支援，包括B2B、PageBuilder和Adobe Stock整合。

### 功能測試架構(MFTF)

MFTF 3.2.1現已推出。 此發行版本在測試和測試套裝產生過程中都引入錯誤容許度。 在[功能測試架構變更記錄檔](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md)中說明其他增強功能和錯誤修正。

### Order Management系統(OMS)

MCOM聯結器與2.4.2完全相容。聯結器的錯誤修正和增強功能在[聯結器發行說明](https://commerce-docs.github.io/oms-documentation-archive/release-notes/connector/index.html)中說明。 此版本包含改進OMS命令列介面，現在提供詳細資訊，以供合作夥伴和支援團隊用於疑難排解`retry`、`queue_prune`、`order_sync`、`message process`和`catalog export`程式。

### 廠商開發的擴充功能

請參閱下列文章，瞭解此版本功能和變更的更新：

* [Amazon支付](https://marketplace.magento.com/amzn-amazon-pay-magento-2-module.html)。 Amazon Pay已在此版本中淘汰，並將在Magento 2.5.0中移除。2.4.3版及更新版本將僅包含相容性的更新及主要錯誤的修正。

* [Braintree](https://experienceleague.adobe.com/docs/commerce-admin/stores-sales/payments/braintree.html?lang=zh-Hant)

* [dotdigital Engagement Cloud](https://marketplace.magento.com/dotdigital-dotdigital-magento2-os-package.html)

* [Klarna](https://marketplace.magento.com/klarna-m2-klarna.html)

* [頂點雲](https://marketplace.magento.com/vertexinc-vertex-tax-module.html)

* [Yotpo產品評論](https://marketplace.magento.com/yotpo-module-yotpo.html)

## 已修正的問題

我們已修正2.4.2核心程式碼中的數百個問題。

### 安裝、升級、部署

<!-- MC-38429-->

* 此版本已棄用設定安裝以使用分割資料庫的功能。 請參閱Adobe Commerce[ DevBlog文章中的](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187)取代分割資料庫功能。

<!-- MC-36472-->

* 商戶現在可以成功地將執行MySQL 8.x的Open Source部署升級為Commerce部署。 之前，在升級期間新增`AUTO_INCREMENT`的所有資料表的`row_id`值回覆為初始值時，應用程式擲回例外狀況。

<!-- ENGCOM-7280 -->

* 如果執行`bin/magento/setup:db:generate-patch`時發生錯誤，應用程式現在會顯示錯誤訊息，以識別用來建立修補程式的路徑。 [GitHub-27523](https://github.com/magento/magento2/issues/27523)

<!-- ENGCOM-8029 -->

* 執行`block_html`後，`full_page`、`layout`和`bin/magento/setup:upgrade`快取現在如預期般停用。 [GitHub-28186](https://github.com/magento/magento2/issues/28186)

<!-- ENGCOM-8184 -->

* 已更新`bootstrap.php`中所需的最低PHP版本。 [GitHub-30004](https://github.com/magento/magento2/issues/30004)

<!-- MC-38788-->

* 您現在可以在安裝範例資料後執行`bin/magento/setup:upgrade`。 先前，當您嘗試執行`bin/magento/setup:upgrade`時，應用程式會顯示此錯誤： `unable to apply data patch magento\catalogrulesampledata\setup\patch\data\installcatalogrulesampledata for module magento_catalogrulesampledata`。 應用程式也在系統記錄檔中顯示這個錯誤： `main.ERROR: Sample Data error: Unable to unserialize value. Error: Syntax error`。 [GitHub-30685](https://github.com/magento/magento2/issues/30685)

<!-- MC-36785-->

* 您現在可以從命令列如預期地設定YouTube API金鑰。 先前，應用程式在您嘗試執行`bin/magento config:sensitive:set catalog/product_video/youtube_api_key`時傳回此錯誤： `There are no sensitive configurations to fill`。

<!-- ENGCOM-8163 -->

* 應用程式現在會遵循`maxMessages`中定義的`queue_consumer.xml`值。 以前，應用程式僅使用部署設定值。 [GitHub-29522](https://github.com/magento/magento2/issues/29522)

<!-- ENGCOM-8243 -->

* 使用`bin/magento setup:config:import`建立存放區時，新存放區的URL產生現在可如預期運作。 之前，生產環境中不會產生URL重寫。 [GitHub-30025](https://github.com/magento/magento2/issues/30025)

<!-- ENGCOM-8230 -->

* 當您執行`bin/magento setup:install`以連線到現有的資料庫時，應用程式不再顯示此問題： `Overwrite the existing configuration for db-ssl-verify?[Y/n]`。 [GitHub-29612](https://github.com/magento/magento2/issues/29612)

### AdminGWS

<!-- MC-37040-->

* 具有受限制許可權的管理員的&#x200B;**商店** > **屬性** > **評等**&#x200B;頁面中，**新增評等**&#x200B;按鈕和&#x200B;**儲存**、**刪除**、**重設**&#x200B;按鈕不再提供。

<!-- MC-35804-->

* 管理員現在只會顯示登入管理員有權存取之網站的資料。 之前，管理員會顯示部署中所有網站的資料。

<!-- MC-35027-->

* 所有選取的網站現在都儲存在`gws_websites`中，無論網站ID的大小為何。 之前，網站ID會遭到截斷，且選取的網站清單不會儲存在資料庫中。 使用者角色未正確儲存，當商家嘗試變更並儲存角色時，應用程式會顯示此錯誤： `The "X" store ID is incorrect. Verify the store ID and try again`。

<!-- MC-37223-->

* 對於受限制的管理使用者，應用程式現在會在管理網格中顯示正確的專案計數。 以前，這些網格顯示的計數會反映所有國家/地區的資料，而網格本身只會顯示特定國家/地區的資料。 （此修正可更正客戶區段、目錄價格規則、購物車價格規則、所有使用者、鎖定的使用者及使用者角色網格的問題。）

<!-- MC-34156-->

* 其許可權排除`Magento_Catalog::edit_product_design` （編輯產品設計）的管理員現在可以透過在所選商店檢視中以新名稱儲存現有產品來建立新產品。 以前，應用程式顯示這個錯誤： `Not allowed to edit the product's design attributes`。 [GitHub-28106](https://github.com/magento/magento2/issues/28106)

<!-- MC-36406-->

* 當管理員缺少建立這些實體的適當許可權時，應用程式不再在&#x200B;**存放區** >屬性下的頁面上顯示&#x200B;**新增屬性**&#x200B;按鈕。 之前，當沒有適當許可權的網站管理員嘗試建立&#x200B;**屬性集**&#x200B;或&#x200B;**客戶**&#x200B;屬性時，應用程式擲回404錯誤。

<!-- ENGCOM-8230 -->

* 安裝Adobe Commerce後，當您嘗試使用`backend-frontname`容器變更`ssh`時，應用程式不再擲回錯誤。 [GitHub-26762](https://github.com/magento/magento2/issues/26762)

### Adobe Stock整合

<!-- ENGCOM-8020-->

* 新增讀取`exif_image.png`或`exif-image.jpeg`中繼資料的支援。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8194 8094 8147 -->

* 按一下「媒體集」的「預設檢視」書籤時顯示的內容不再經過篩選。 以前，預設檢視包含從`url-filter`套用程式套用的篩選器。 [GitHub-1813](https://github.com/magento/adobe-stock-integration/issues/1813)，[GitHub-1789](https://github.com/magento/adobe-stock-integration/issues/1789)，[GitHub-1780](https://github.com/magento/adobe-stock-integration/issues/1780)

<!-- ENGCOM-8070 -->

* 邏輯已從WYSIWYG OnInsert控制器(`Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\OnInsert::execute()`)中移除，並新增至`Model\Wysiwyg\Images\PrepareImage::execute()`模型。 [GitHub-1504](https://github.com/magento/adobe-stock-integration/issues/1504)

<!-- ENGCOM-8081 -->

* 區域模擬已從`media-content:sync`命令(`\Magento\MediaContentSynchronization\Console\Command\Synchronize::execute`)中移除。 [GitHub-1784](https://github.com/magento/adobe-stock-integration/issues/1784)

### Analytics

<!-- MC-37137-->

* 進階報告現在對相同網域中的多個環境按預期運作。 先前，進階報告產生的CSV檔案會失敗，因為雙引號會以CSV標準RFC4180要求的反斜線逸出，而不是以其他雙引號逸出。

<!-- MC-35996-->

* 現在，使用預設或非預設連線埠連線到`analytics_collect_data`中的MySQL時，`env.php`作業會順利執行。 以前，`analytics_collect_data`在您使用非預設連線埠時擲回錯誤。

<!-- MC-35407-->

* `analytics_collect_data`產生的CSV檔案現在已正確逸出。 以前，這些檔案產生時沒有正確的逸出，這會阻止產生詳細目錄報表。

### Braintree

* 購物者現在可以使用Apple Pay成功訂購虛擬產品。 之前，應用程式擲回此錯誤： `There are no shipping methods available for you right now. Please try again or use an alternative payment method`。

* 預設的PayPal Express結帳付款方式現在可與Braintree信用卡付款方式如期運作。 先前，啟用Braintree信用卡付款方式時，應用程式沒有顯示&#x200B;**PayPal**&#x200B;按鈕。

### 套裝產品

<!-- MC-34063-->

* 應用程式不再為報價中的固定價格套裝產品子料號設定價格。

<!-- MC-38050-->

* 當套件組合產品包含無庫存產品時，價格排序現在會如預期運作。 先前，依降序排序的價格不會依降序顯示產品。

<!-- MC-38576-->

* 當存在許多選項時，應用程式現在會自動為套件組合產品選項套用預設數量1。 以前，商家必須手動指定預設數量給每個選項。

<!-- ENGCOM-8159 -->

* 訂單發票建立頁面現在會如預期顯示套件組合產品的子產品。 [GitHub-27350](https://github.com/magento/magento2/issues/27350)

<!-- MC-38460 -->

* 當您以自訂價格重新訂購屬於套裝產品的簡單產品時，應用程式現在會指定正確的產品價格。 先前，在套裝產品上設定自訂價格，導致在重新訂購時附加的簡單產品價格不正確。 [GitHub-30343](https://github.com/magento/magento2/issues/30343)

<!-- MC-30348 -->

* 呼叫POST `/V1/order/{orderId}/ship`以送出包含組合產品的訂單，現在會將訂單標示為如預期完成。 以前，應用程式會顯示此錯誤訊息： `You can't create a shipment without products`。 [GitHub-9762](https://github.com/magento/magento2/issues/9762)

### 購物車與結帳

<!-- MC-34264-->

* 當自訂地址屬性出現在結帳工作流程的送貨步驟上時，送貨方法估算器現在會如預期運作。 之前，應用程式會顯示此錯誤訊息： `{"message":"Error occurred during \"custom_attributes\" processing. A custom attribute is specified with a missing attribute code. Verify the code and try again."}` [GitHub-27505](https://github.com/magento/magento2/issues/27505)

<!-- MC-35783-->

* 當購物者移除其購物車中的唯一專案時，應用程式現在會如預期在迷你購物車中顯示`You have no items in your shopping cart`訊息。 先前，當購物者移除單一專案且應用程式顯示此訊息時，`checkout/cart/removeFailed`的購物車資料未更新： `1 product requires your attention`。

<!-- MC-36088-->

* 應用模組不再針對不適用的出貨方式顯示訂單的出貨成本。 以前，對於結帳工作流程中不適用的送貨方法，應用程式顯示0價格。

<!-- MC-36598-->

* 當取消選取結帳工作流程上的&#x200B;**我的帳單和運送地址相同**&#x200B;核取方塊時，現在會選取客戶的預設帳單地址。

<!-- MC-36685-->

* 管理員可以透過SKU從管理員新增產品至購物車，而無需從管理員重新導向。 管理員不再重新導向到店面頁面，應用程式如預期般在管理員購物車專案區段顯示產品。

<!-- MC-36750-->

* 透過SKU將產品新增到購物車時，當您上傳包含多種錯誤型別的CSV檔案時，應用程式現在會顯示資訊性錯誤訊息。 先前，當您在&#x200B;**管理購物車** > **透過SKU新增至購物車**&#x200B;按一下&#x200B;**選擇檔案**&#x200B;時，應用程式會顯示空白頁面和一般錯誤訊息。

<!-- MC-37351-->

* 當購物者在不同網域中從一家商店切換至另一家商店時，購物車內容不再遺失。

<!-- MC-38000-->

* 購物者現在可使用多種送貨方式，透過多個地址結帳成功完成訂單。 以前，應用程式顯示這個錯誤： `There has been an error processing your request`。 [GitHub-30197](https://github.com/magento/magento2/issues/30197)

<!-- MC-38048-->

* 當購物者從購物車變更商店檢視時，應用程式現在會在結帳工作流程的送貨頁面上顯示正確的預設國家/地區。

<!-- MC-38309-->

* 當訪客購物者登入後，在登出後重設密碼後清除客戶工作階段時，應用程式現在會排除目前的工作階段。 以前，當購物者重設密碼時，應用程式會清空購物車。

<!-- MC-36884-->

* 當購物者變更購物車中的商店檢視時，應用程式現在會顯示商店檢視的正確預設國家/地區。 先前，當購物車中的商店檢視變更時，預設國家/地區不正確。

<!-- MC-38723-->

* 目錄許可權的設定順序不會再防止具有正確許可權的管理員將產品新增到購物車。 之前，應用程式並未驗證目前客戶群組的`addToCart`組態設定。 因此，當管理員嘗試將產品新增到購物車時，應用程式擲回錯誤。

<!-- MC-38746-->

* 已移除對購物車上`/rest/V1/guest-carts/cart_id/totals-information`端點的重複呼叫，這會改善購物車效能。 先前，當購物者新增產品至購物車，然後檢視購物車時，應用程式會多次呼叫`collectAddressTotals`方法。

<!-- MC-38833-->

* 當停用國家&#x200B;**的**&#x200B;允許選擇州別（若它是選擇性的）設定時，應用程式不再顯示簽出工作流程中某個國家的&#x200B;**區域**&#x200B;欄位。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- MC-38813-->

* 從管理員重新訂購訂單時，應用程式不再重複店面結帳工作流程中的送貨地址。

<!-- MC-38814-->

* 已修正`AdminMediaGalleryInsertLargeImageFileSizeTest`的設計問題。

<!-- MC-37321-->

* `quote`表格中來賓的所有新記錄現在會在`customer_is_guest field`中指派值1。 之前，對於每個將產品加入購物車的新來賓，記錄在`quote.customer_is_guest`欄位中已指派0。

<!-- ENGCOM-8091 -->

* 結帳工作流程「檢閱與付款」區段上的&#x200B;**提交**&#x200B;按鈕已移至`<form id="purchaseorder-form"...></form>`內部，這使得隱性表單提交成為可能，而不會變更任何JavaScript。 [GitHub-27925](https://github.com/magento/magento2/issues/27925)

<!-- ENGCOM-8428 -->

* 停用&#x200B;**如果國家/地區選擇狀態**&#x200B;設定為選用，則應用程式不會再在簽出工作流程上顯示&#x200B;**區域**&#x200B;欄位。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- ENGCOM-8442 -->

* 當購物者使用多個地址結帳時按一下&#x200B;**更新購物車**&#x200B;時，應用程式現在會正確更新購物車的專案小計。 [GitHub-30408](https://github.com/magento/magento2/issues/30408)

<!-- ENGCOM-8283 -->

* 當目前未安裝的付款方法有`config.xml`個節點時，應用程式不再擲回例外狀況。 之前，應用程式在結帳時擲回例外狀況。 [GitHub-29555](https://github.com/magento/magento2/issues/29555)

<!-- ENGCOM-8215 -->

* 應用程式現在會在迷你購物車中正確轉譯包含特殊字元的產品名稱。 [GitHub-29075](https://github.com/magento/magento2/issues/29075)

<!-- ENGCOM-8308 -->

* 應用模組現在會針對表格費率設定正確的折扣套件。 之前，應用程式在計算表格費率時，並未套用設定購物車折扣的購物車規則。 [GitHub-30169](https://github.com/magento/magento2/issues/30169)

### 購物車價格規則

* 現在會在計算訂單小計時如預期套用購物車價格規則，而不納入稅捐。 新的`Subtotal (Incl. Tax)`選項已新增為購物車價格規則條件。

<!-- MC-37884-->

* 使用GraphQL套用含抵用券的價格規則，現在於使用&#x200B;**整個購物車**&#x200B;的固定金額折扣動作時，可如預期運作。

### 目錄

<!-- MC-34100-->

* 應用程式現在會依預期在店面顯示所有重新啟用的產品。 先前，當產品停用然後重新啟用時，應用程式不會顯示產品，直到清除Varnish頁面快取或重新索引存放區，因為重新啟用產品後，頁面快取不會失效。

<!-- MC-37745-->

* 部分重新索引大型目錄現在可如預期運作。 先前，在使用`catalogsearch_fulltext`部分索引器重新索引期間，產品會隨機從店麵類別頁面消失。

<!-- MC-35123-->

* 購物者現在可以重新訂購具有預期可自訂選項之產品的已開立商業發票訂單。 以前，當購物者嘗試重新排序時，應用程式擲回此錯誤： `{"0":"The product's required option(s) weren't entered. Make sure the options are entered and try again`。

<!-- MC-35212-->

* 您現在可以在[類別設計]頁面上成功將&#x200B;**配置**&#x200B;設定設為&#x200B;**無配置更新**。 先前，當您指派&#x200B;**無配置更新**&#x200B;值時，應用程式已恢復為&#x200B;**類別 — FullWidth**。

<!-- MC-35490-->

* 已解決店面的產品排序順序問題。 先前，當應用程式將產品價格編列索引時，它偶爾會在`min_price`資料表中將可設定產品的`max_price`和`catalog_product_index_price`設定為0，這會影響店面的價格排序順序。

<!-- MC-35608-->

* 應用程式現在已成功更新標籤為`Product Type`的屬性。 之前，因為`product_type`屬性已保留在程式碼中，所以當您嘗試更新`Product Type`屬性時，應用程式會顯示此訊息： `An attribute with the same code (product_type) already exists.`

<!-- MC-36214-->

* 當您儲存產品時，應用程式不會再變更已上傳視訊在產品詳細資料頁面之影像和視訊區段中的位置。 以前，新影像位置會指定索引值（清單中的位置），如果現有影像位置與其索引值不一致，則新影像會錯誤放置在清單中。

<!-- MC-36548-->

* 當&#x200B;**加入購物車**&#x200B;按鈕可供點按時，**加入購物車**&#x200B;功能現在會如預期運作。 先前，如果您在等待產品頁面載入時按此按鈕多次，應用程式會擲回此錯誤： `Invalid Form Key. Please refresh the page`。

<!-- MC-37006 36835-->

* 當商家在類別中新增或移除已停用的產品時，應用程式不再刷新類別快取。 之前，應用程式會針對相關類別排清快取，無論產品狀態為何。 儲存類別時也會取消指派類別，導致清除類別快取。

<!-- MC-37347-->

* **所有商店檢視**&#x200B;範圍內的目錄產品篩選現在可以正常運作。 先前，篩選功能只顯示啟用或停用的產品時，格線中會顯示狀態為`Enabled`或`Disabled`的產品。

<!-- MC-38038-->

* 部分重新索引不再導致遺漏產品和空白類別。

<!-- MC-38315-->

* 重新排序現在可在&#x200B;**使用JavaScript行事曆**&#x200B;啟用（**商店** > **組態** > **目錄** > **日期與時間自訂選項**）時如預期般運作。 先前，啟用此設定時，當您嘗試從管理員重新排序先前下單的訂單時，應用程式會顯示此錯誤： `Please specify date required option(s)`。

<!-- MC-38719-->

* 應用程式現在會在建立層級價格期間，在多網站部署中顯示正確的貨幣。

<!-- MC-38914-->

* 產品影像自訂屬性現已正確逸出。 `data-src`屬性如預期具有與`src`屬性相同的值。 之前，URL特殊符號會逸出。

<!-- MC-37665-->

* 透過REST API更新類別時，不再停用[啟用類別]、[包含在功能表中]和[URL金鑰]屬性上的&#x200B;**使用預設值**&#x200B;設定。

<!-- MC-36832-->

* 從Admin啟用類別許可權，在重複造訪類別頁面時，不會再導致無法在完整頁面快取中快取類別頁面。 以前，後續的頁面造訪次數不會如預期從快取提供服務，而且效能會降低。

<!-- MC-35363-->

* 儲存類別現在只會排清與此類別相關的區塊快取。 之前，應用程式會排清所有類別區塊的快取。

<!-- MC-30626-->

* 具有百分比價格的自訂選項價格，現在會在多商店部署中，依預期轉換為作用中商店的基本貨幣。 以往，具有百分比價格的自訂選項的價格轉換不正確。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- MC-38890-->

* 應用程式現在已成功重新建立影像，當商家使用POST `rest/all/V1/products`傳送媒體集資料時，這些影像會如預期在「管理員」中顯示。 以前，如果影像在`rest/all/V1/products`中被刪除，但媒體中仍然有記錄包含這些影像的記錄，當商家透過POST `pub/media`傳送媒體集資料時，應用程式會重新建立這些影像，但會刪除這些影像。 因此，商家在「管理員」中只看到預留位置，因為影像是在更新過程中建立和刪除的。

<!-- MC-36903-->

* 現在當您從網站取消指派專案時，會如預期刪除記錄。 先前，執行POST `rest/all/V1/products`時會複製影像。

<!-- MC-38413-->

* `/V1/categories/{categoryId}/products`呼叫現在會如預期傳回屬於父類別的所有產品清單。 先前，如果產品屬於父類別的多個子類別，應用程式會擲回此型別的錯誤： `Internal Error. Details are available in the application log file. Report ID: webapi-5f8579e37db54`。  [GitHub-30461](https://github.com/magento/magento2/issues/30461)

<!-- MC-32996-->

* `/V1/products/attributes/:attributeCode/options` REST端點現在支援更新現有的屬性選項。

<!-- MC-30626 ENGCOM-8475-->

* 具有百分比價格的自訂選項價格，現在會在多商店部署中，依預期轉換為作用中商店的基本貨幣。 以往，具有百分比價格的自訂選項的價格轉換不正確。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- ENGCOM-8395 -->

* 商家現在可以在產品建立期間成功儲存新屬性。 以前，當商家嘗試儲存屬性時，應用程式不會儲存屬性，並將商家重新導向至商店檢視首頁。 [GitHub-30362](https://github.com/magento/magento2/issues/30362)

<!-- ENGCOM-7997 -->

* **銷售** > **訂單**&#x200B;和&#x200B;**目錄** > **產品**&#x200B;頁面上的產品格線現在會列出所有相關的商店，而不只是最近建立的商店。 [GitHub-29267](https://github.com/magento/magento2/issues/29267)

<!-- ENGCOM-6698 -->

* 產品存放庫現在會使用`store_id`來儲存現有產品的屬性值。  以前，產品存放庫類別會覆寫產品存放庫ID，並一律指派預設存放庫ID。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### 目錄規則

<!-- MC-35065-->

* 目錄價格規則現在與產品詳細資料頁面上的自訂選項搭配使用，可如預期運作。 之前，該頁面上的產品價格未反映適用的目錄價格規則。 [GitHub-22856](https://github.com/magento/magento2/issues/22856)

<!-- MC-34265-->

* 產品和目錄快取現在會依排程過期。 以前，快取每天過期，因為`сron`每天執行一次`catalogrule_apply_all`工作（重新編制所有目錄規則和相依索引器的索引），並清除所有產品和類別的快取。

### Cleanup

#### 拼寫錯誤和文法清理

<!-- ENGCOM-7967 -->

* 已修訂「訂單失敗」頁面的標題以提高準確性。 此頁面的標題先前為： **我們已收到您的訂單！**。  [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-8101 -->

* 已移除`app/code/Magento/Contact/view/frontend/templates/form.phtml`中不必要的空格。 [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-7716 -->

* 修正`bin/magento/setup:config:set`子命令說明訊息中的錯字。 [GitHub-28802](https://github.com/magento/magento2/issues/28802)

<!-- ENGCOM-8058 -->

* 已更正`framework/Registry.php`檔案之PHPDoc中的文法。 [GitHub-29661](https://github.com/magento/magento2/issues/29661)

<!-- ENGCOM-8273 -->

* 已從`app/code/Magento/Catalog/Helper/Product/View.php`移除多餘的空格。 [GitHub-30601](https://github.com/magento/magento2/issues/30601)

<!-- ENGCOM-8181 -->

* 已修正`app/code/Magento/Ui/view/base/web/js/form/element/ui-select.js`中函式名稱的錯字。 [GitHub-29987](https://github.com/magento/magento2/issues/29987)

<!-- ENGCOM-8478 -->

* 修正迷你購物車和結帳訂單摘要中「專案」的多元化問題。 [GitHub-29920](https://github.com/magento/magento2/issues/29920)

<!-- ENGCOM-8309 -->

* 已移除標籤圖層導覽篩選器內嵌元素中的空白字元。 [GitHub-30448](https://github.com/magento/magento2/issues/30448)

<!-- ENGCOM-8056 -->

* 已在`rl`中將`url`更正為`\Magento\Framework\Filter\Template\Tokenizer\Parameter`。  [GitHub-29185](https://github.com/magento/magento2/issues/29185)

#### 程式碼清理

<!-- MC-37922-->

* 已從`<br>`系統&#x200B;**>**&#x200B;匯入&#x200B;**頁面的[檢查資料]訊息區域移除多餘的HTML**&#x200B;標籤。

<!-- ENGCOM-8028 -->

* `ChangeQuoteControl`已重構。 [GitHub-29673](https://github.com/magento/magento2/issues/29673)

<!-- ENGCOM-8027 -->

* `AccessChangeQuoteControl`及其單元測試已重構。 [GitHub-29672](https://github.com/magento/magento2/issues/29672)

<!-- ENGCOM-8053 -->

* 修正`app/code/Magento/Captcha/CustomerData/Captcha.php`中傳回型別宣告的程式碼樣式。 [GitHub-29712](https://github.com/magento/magento2/issues/29712)

<!-- ENGCOM-8288 -->

* 修正「新增屬性」頁面上按鈕清單的位置。

<!-- ENGCOM-8315 -->

* 已為`viewModel`類別的前端`\Magento\Framework\View\Element\Template`參考範例新增正確的區塊類別。 [GitHub-30450](https://github.com/magento/magento2/issues/30450)

<!-- ENGCOM-8090 -->

* 已移除「銷售規則」表單中多餘的欄位集。 [GitHub-29599](https://github.com/magento/magento2/issues/29599)

<!-- ENGCOM-8448 -->

* 已從`hierarchy/edit.phtml`範本移除不必要的程式碼。

<!-- ENGCOM-8446 -->

* 已更正`app/code/Magento/CatalogImportExport/Model/Export/Product.php`中的PHPdoc註解。 [GitHub-30833](https://github.com/magento/magento2/issues/30833)

<!-- ENGCOM-8277 -->

* 已更正`PublisherInterface`訊息的docblock註解。 [GitHub-30190](https://github.com/magento/magento2/issues/30190)

<!-- ENGCOM-8264 -->

* 已修正`getStatusByState`方法中的引數。 [GitHub-30173](https://github.com/magento/magento2/issues/30173)

<!-- ENGCOM-8235 -->

* 已更正`app/code/Magento/Quote/Model/Cart/Totals/ItemConverter.php`中的方法描述。 [GitHub-30125](https://github.com/magento/magento2/issues/30125)

<!-- ENGCOM-8242 -->

* 在多個檔案的同一行移除多餘的變數指派。 [GitHub-30133](https://github.com/magento/magento2/issues/30133)

<!-- ENGCOM-8263 -->

* 在`@param string $attribute`中將`@param AbstractAttribute|string[]|string $attribute`變更為`EntityAbstract.php`。 [GitHub-30191](https://github.com/magento/magento2/issues/30191)

<!-- ENGCOM-8142 -->

* 無效的標籤（例如`@package`和`@subpackage`）已從整個程式碼基底的Docblock中移除。 [GitHub-30061](https://github.com/magento/magento2/issues/30061)

<!-- ENGCOM-8117 -->

* 已移除`AdvancedPricing`類別建構中未使用的引數。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### 可設定的產品

<!-- MC-35016-->

* 依價格篩選沒有庫存的可設定產品現在會顯示正確價格範圍內的結果。

<!-- MC-38930-->

* 當虛擬產品的狀態從啟用變更為停用時（反之亦然），虛擬產品不再變更型別。 先前，應用程式會在產品狀態變更時，將產品型別從虛擬變更為簡單。

<!-- MC-38197-->

* 更新購物車時，`getValue()`方法不再觸發嚴重錯誤。

<!-- MC-34444-->

* 可在多個網站上取得的可設定產品不再顯示未指派給特定網站的簡單子產品。 [GitHub-28291](https://github.com/magento/magento2/issues/28291)

<!-- ENGCOM-8202 -->

* Storefront產品頁面現在會如預期顯示層級價格（不含稅）。 [GitHub-12225](https://github.com/magento/magento2/issues/12225)

<!-- ENGCOM-8134 8174-->

* 可設定產品的MSRP價格現在可正確轉換為選擇的貨幣。 以前，應用程式以錯誤的貨幣顯示價格，並擲回此錯誤： `Call to a member function setAppliedTaxes() on null`。 [GitHub-26526](https://github.com/magento/magento2/issues/26526)，[GitHub-29603](https://github.com/magento/magento2/issues/29603)

<!-- ENGCOM-8234 -->

* 商戶現在可以儲存特定商店文字色票屬性選項標籤，其值為0 （零）。 之前，0值會由管理員標籤選項值取代。 [GitHub-30073](https://github.com/magento/magento2/issues/30073)

<!-- ENGCOM-8117 -->

* 已移除`AdvancedPricing`類別建構中未使用的引數。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### cron

<!-- MC-37712-->

* 系統訊息清單現在會在`cron`執行後正確反映產品更新，且應用程式已依排程更新產品。

<!-- ENGCOM-8164 -->

* 基於`schedule_id`和`status`的索引已新增到`cron_schedule`資料表。 [GitHub-29601](https://github.com/magento/magento2/issues/29601)

### 自訂客戶屬性

<!-- MC-23545-->

* 建立後，應用程式現在會在[帳戶資訊]頁面上顯示`file`型別的客戶屬性。 先前，當您嘗試儲存此型別的新屬性時，應用程式會顯示下列錯誤： `The "newAttribute" attribute value is empty. Set the attribute and try again`和`Validation is failed`。

<!-- MC-23544-->

* 應用程式現在可以正確顯示多行自訂客戶屬性值。 以前並非所有資料都會顯示。

<!-- MC-36978-->

* 現在，當購物者在建立帳戶時輸入無效的出生日期時，應用程式會提醒他們。 之前，驗證器會忽略地區設定設定，而購物者會重新導向至建立新客戶帳戶頁面，且出現無效的日期錯誤。

<!-- MC-38846-->

* 自訂地址屬性現在已如預期包含在結帳工作流程的付款步驟中。

<!-- MC-38114-->

* 自訂地址多重選取屬性現在會在來賓結帳期間以及管理員和我的帳戶訂單詳細資訊頁面上正確顯示。

<!-- MC-37581-->

* 自訂地址屬性現在在「我的帳戶」區域和「管理員訂單詳細資料」頁面中正確顯示。

<!-- MC-37101-->

* 當`Input Type`設為`Text`且`Input Validation`設為`Numeric Only`時，您現在可以刪除自訂客戶屬性中的前導零。

<!-- MC-36721-->

* 應用程式現在已成功匯出包含自訂性別屬性值的客戶資料。

<!-- MC-34650-->

* 應用程式現在會如預期為B2B使用者儲存自訂客戶屬性值。 之前，為新增或編輯公司使用者而建立的自訂客戶屬性不會與新增使用者表單繫結，因此，屬性值不會儲存。 此外，自訂日期屬性衍生自資料庫，做為字串，且未轉換為店面顯示的適當日期格式。

### 客戶

<!-- MC-35771-->

* 店面客戶帳戶頁面出生日期欄位的行事曆介面工具集現在會使用指定的店面地區設定。

<!-- MC-38498-->

* 從Admin為現有客戶重新訂購結帳時，應用程式不再儲存客戶地址的重複專案。

<!-- MC-37393-->

* 現在從「管理員」刪除多個客戶的所有地址，會從客戶地址清單刪除所有地址，並移除預設帳單和送貨地址。 以前，應用程式會從客戶地址清單中刪除該地址，但並未移除預設帳單和送貨地址。

<!-- MC-37377-->

* 在管理員執行大量刪除地址後，「管理員客戶地址」索引標籤現在可以正確顯示地址計數。 以前，應用程式會在計數中包含已刪除的地址。

<!-- MC-36718-->

* 已更正客戶註冊頁面上&#x200B;**出生日期**&#x200B;欄位的DateTime格式。 先前，位數天的前導零會遺失。

<!-- MC-36024-->

* **出生日期**&#x200B;欄位的日期格式驗證現在可在購物者按一下&#x200B;**建立帳戶**&#x200B;按鈕之前運作。 以前，購物者輸入的值格式無效，當他們按一下&#x200B;**建立帳戶**&#x200B;按鈕時，購物者將被重新導向到具有無效日期錯誤的「建立新客戶帳戶」頁面。

<!-- MC-33867-->

* 當管理員嘗試儲存包含屬性無效資料的新客戶帳戶時，應用程式不再擲回嚴重錯誤。

<!-- MC-36258-->

* 當客戶嘗試在先前已安裝Magento Shipping且目前已部署預設Luma主題的部署中存取其購物車時，應用程式不再擲回400錯誤。 以前，應用程式在將請求傳送到伺服器之前，不會篩選掉先前安裝/啟用的Admin不支援的模組所建立的區段名稱，這會導致錯誤。

<!-- MC-35812-->

* 當啟用&#x200B;**要求電子郵件確認**&#x200B;設定且已覆寫`Magento\Customer\Controller\Account\CreatePost`時，當購物者建立來賓帳戶時，應用程式現在會如預期顯示訊息。 以前，應用程式不允許這種型別的自訂使用者註冊程式，在這些條件下，使用者的電子郵件確認狀態會被視為完成，新使用者會自動登入，並且不會顯示錯誤訊息。

<!-- ENGCOM-8039 -->

* 應用程式現在會在購物者於已啟用&#x200B;**啟用自動指派至客戶群組**&#x200B;的商店中，以非預設客戶群組下訂單時，將購物者指派至正確的客戶群組。 [GitHub-26976](https://github.com/magento/magento2/issues/26976)

<!-- MC-39783-->

* 當索引設定為&#x200B;**依排程更新**&#x200B;時，在多站台部署中刪除非預設網站時，現在可如預期使用管理員客戶網格。 之前，應用程式未顯示網格，並擲回此錯誤： `[2020-12-09 11:31:54] report.CRITICAL: The website with id 2 that was requested wasn't found. Verify the website and try again. \{"exception":"[object] (Magento\\Framework\\Exception\\NoSuchEntityException(code: 0): The website with id 2 that was requested wasn't found. Verify the website and try again. at /var/www/html/magento24ee/vendor/magento/module-store/Model/WebsiteRepository.php:110)"}`

### dotdigital

* 從dotdigital Engagement Cloud擷取程式清單時，已改善錯誤處理。

* 訪客同步處理期間在存放區名稱欄中同步處理的值，現在會如預期般成為存放區檢視名稱。 之前，此欄會包含網站名稱。

* 在儲存訂單後循環處理訂單狀態自動化之前新增陣列檢查。

* 已解決Composer升級的問題，這些問題是dotdigital模組對`magento/module-authorization`的相依性的結果。

### 可下載

<!-- ENGCOM-7679 -->

* 在可下載產品已退款部分後，應用程式不會再在「我的下載產品」標籤中列出可下載產品。 [GitHub-28388](https://github.com/magento/magento2/issues/28388)

### 動態區塊（原為橫幅）

<!-- MC-23938-->

* 在您刪除與區塊關聯的客戶區段後，應用程式就不會再在店面上顯示動態區塊。

<!-- MC-37322-->

* 應用程式現在會在決定是否顯示動態區塊時，正確考量目錄價格規則。

### EAV

<!-- MC-35934-->

* 如果API呼叫建立產品時，裝載中未提供值，則使用`\Magento\Eav\Model\Entity\Attribute\Backend\ArrayBackend`的自訂屬性現在會使用預設值。

### 電子郵件

<!-- ENGCOM-7961 -->

* 未在`\Magento\Config\Model\Config\Source\Email\Template::toOptionArray`之前呼叫`setPath()`時，`toOptionArray()`不再擲回錯誤。 [GitHub-29315](https://github.com/magento/magento2/issues/29315)

<!-- MC-36777-->

* 載入電子郵件範本時，應用程式現在會在您按一下&#x200B;**傳回Html版本**&#x200B;時，將純文字正確轉換為HTML。

<!-- MC-34803-->

* 傳送給客戶的電子郵件若包含部份發票，現在會包含精確的專案小計。 先前，此電子郵件中的小計是訂購數量的總計，而不是已開立商業發票數量的總計。

<!-- MC-38337-->

* 應用程式現在會傳送電子郵件提醒給具有有效電子郵件地址的所有相關客戶。 之前，應用程式在遇到一個無效地址後停止向客戶傳送提醒電子郵件。

<!-- ENGCOM-7517 -->

* 從目錄移除產品後，以非同步模式傳送銷售電子郵件現在可如預期運作。 先前已封鎖非同步電子郵件傳送，且應用程式顯示此錯誤： `main.ERROR: Cron Job sales_send_order_invoice_emails has an error: Call to a member function getData() on null. Statistics: {"sum":0,"count":1,"realmem":0,"emalloc":0,"realmem_start":73400320,"emalloc_start":37177640} [] []main.CRITICAL: Error when running a cron job {"exception":"[object] (RuntimeException(code: 0): Error when running a cron job at /var/www/html/vendor/magento/module-cron/Observer/ProcessCronQueueObserver.php:327, Error(code: 0): Call to a member function getData() on null at /var/www/html/vendor/magento/module-catalog/Helper/Image.php:502)"} []`。 [GitHub-26878](https://github.com/magento/magento2/issues/26878)

<!-- ENGCOM-8381 -->

* 當`sales_email/order_comment/enabled`停用且`sales_email/order_comment/copy_method`設定為`bcc`時，應用程式不再復制訂單確認電子郵件上的客戶。 [GitHub-29915](https://github.com/magento/magento2/issues/29915)

### 框架

<!-- MC-24195-->

* 現在當在客戶上搜尋時，可正確套用自訂的篩選器群組。 先前，`afterSearch`函式沒有如預期般進行OR篩選。 [GitHub-24576](https://github.com/magento/magento2/issues/24576)

<!-- MC-36942-->

* 商店首頁上的影像現在已成功轉譯。 先前，頁面來源HTML已損毀，因為影像base64程式碼中的三個連續斜線會誤解為評論。

<!-- MC-37369-->

* 現在，在使用阿拉伯語地區設定(`ar_SA - Saudi Arabia`)的存放區中篩選[管理訂單]清單上的訂單時，DatePicker可正確運作。

<!-- MC-38344-->

* 現在，商家在部署中儲存購物車價格規則後，DatePicker會顯示正確的日期。 [GitHub-30382](https://github.com/magento/magento2/issues/30382)

<!-- MC-31085-->

* 應用程式現在可正確代表阿拉伯千分位分組和阿拉伯小數分隔符號。 先前已修剪阿拉伯文符號。 [GitHub-26676](https://github.com/magento/magento2/issues/26676)

<!-- MC-30631-->

* 應用程式現在會如預期從資料庫`session`資料表中刪除過期的資料庫工作階段。

### 一般修正

<!-- MC-38105-->

* 您現在可以設定與`php.ini`中定義之處理常式不同的原生工作階段處理常式。 以前，`SessionManager`未將memcache設定為`save_handler`，而是使用檔案的`session_handler`。 應用程式擲回此錯誤： `main.CRITICAL: Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 {"exception":"[object] (Exception(code: 0): Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in ../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 at ../vendor/magento/framework/App/ErrorHandler.php:61)"}`。 [GitHub-24717](https://github.com/magento/magento2/issues/24717)

<!-- ENGCOM-8052 -->

* 已對`LoginAsCustomer`模組進行下列改良：

   * 已將`around`外掛程式取代為`after`

   * 已移除多餘的程式碼

   * 以`(bool)->getValue()`取代`isSetFlag`。 [GitHub-29689](https://github.com/magento/magento2/issues/29689)

<!-- ENGCOM-8093 -->

* 以萬用字元(*)重新載入所有客戶資料區段不會再導致`customer/section/load`的請求擲回400錯誤。 [GitHub-28154](https://github.com/magento/magento2/issues/28154)

<!-- ENGCOM-7994 -->

* 應用程式現在會傳遞在生產模式下將配置轉譯為`var/report`時發生的例外狀況。 [GitHub-29606](https://github.com/magento/magento2/issues/29606)

<!-- MC-38587-->

* 變更商店檢視時，應用程式不再將客戶重新導向首頁。 現在只有在第二個商店檢視找不到`\Magento\VersionsCmsUrlRewrite\Model\StoreSwitcher::switch()`時，`$urlPath`方法才會將購物者重新導向首頁。

<!-- ENGCOM-7527 -->

* 當不存在客戶請求重設密碼時，應用程式現在會擲回例外狀況。 [GitHub-26288](https://github.com/magento/magento2/issues/26288)

<!-- MC-33687 ENGCOM-8497-->

* 現在，當管理員嘗試在上傳具有此屬性值的檔案時儲存包含無效客戶屬性的客戶帳戶時，應用程式會顯示資訊性錯誤訊息。 之前，應用程式擲回嚴重錯誤。 [GitHub-30295](https://github.com/magento/magento2/issues/30295)

<!-- ENGCOM-8400 -->

* 應用程式現在會依預期將HTML列印檢視的&#x200B;**標誌**&#x200B;組態設定套用至店面發票PDF。 [GitHub-24730](https://github.com/magento/magento2/issues/24730)

<!-- ENGCOM-8425 -->

* 在用於存取私人常數之程式碼基底中，`static::`已取代為`self::`。 [GitHub-30781](https://github.com/magento/magento2/issues/30781)

<!-- ENGCOM-8395 -->

* 當商家在建立產品期間按兩下&#x200B;**建立新屬性**&#x200B;按鈕時，應用程式現在會如預期開啟「新屬性」頁面。 之前，應用程式顯示空白頁面並擲回錯誤。 [GitHub-30361](https://github.com/magento/magento2/issues/30361)

<!-- ENGCOM-8426 -->

* 優惠券移除後，應用程式不再顯示`The coupon code has been accepted`訊息。 [GitHub-30255](https://github.com/magento/magento2/issues/30255)

<!-- ENGCOM-8396 -->

* 管理員現在可以將Widget指派給特定類別。 [GitHub-30009](https://github.com/magento/magento2/issues/30009)

<!-- ENGCOM-8216 -->

* 屬性選取器`input[type=datetime]`已取代為較不具體的輸入型別選取器。 [GitHub-30064](https://github.com/magento/magento2/issues/30064)

<!-- ENGCOM-8282 -->

* 應用程式現在會依預期顯示與自訂類別屬性相關聯的商店特定值。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-8287 -->

* 當商店地址與運送目的地屬於不同的歐盟國家/地區時，應用程式現在會顯示提示，詢問當您按一下訂單建立頁面上的&#x200B;**驗證VAT編號**&#x200B;按鈕時，是否應該變更客戶群組。 [GitHub-29652](https://github.com/magento/magento2/issues/29652)

<!-- ENGCOM-8031 -->

* 已重構`\Magento\Catalog\Model\ImageUploader`類別以使用新的`moveFileFromTmp`方法。 [GitHub-29598](https://github.com/magento/magento2/issues/29598)

<!-- ENGCOM-8178 -->

* 當商家嘗試建立具有`product_type`和`type_id`程式碼的產品屬性以提供更清楚的描述時，應用程式現在會顯示更清楚的錯誤訊息。 [GitHub-28479](https://github.com/magento/magento2/issues/28479)

<!-- ENGCOM-8135 -->

* 已更正「管理員&#x200B;**商店** > **設定** > **服務** > **OAuth**」頁面上&#x200B;**客戶權杖存留期（小時）**&#x200B;及&#x200B;**管理員權杖存留期（小時）**&#x200B;欄位的驗證邏輯。 [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-8132 -->

* 應用程式現在可正確剖析Widget內容欄位中包含`}}`的文字。 [GitHub-12087](https://github.com/magento/magento2/issues/12087)

<!-- ENGCOM-8098 -->

* 您現在可以從產品類別頁面中移除篩選器。 先前，當您嘗試刪除篩選器時，應用程式不允許您移除篩選器並顯示此錯誤： `Something went wrong`。 [GitHub-8538](https://github.com/magento/magento2/issues/8538)

<!-- ENGCOM-8050 -->

* 當選擇性模組`Magento\Framework\MessageQueue\ConfigInterface`停用時，`Magento_MessageQueue`現在可以具現化。 之前，應用程式擲回此錯誤： `PHP Fatal error:  Uncaught Error: Cannot instantiate interface Magento\Framework\MessageQueue\ConfigInterface in /var/www/magento2/magento2/lib/internal/Magento/Framework/ObjectManager/Factory/AbstractFactory.php:121`。 [GitHub-26080](https://github.com/magento/magento2/issues/26080)

<!-- ENGCOM-7312 -->

* 已改善判斷應用程式何時可從永久儲存裝置擷取電子郵件值的邏輯。 先前，當未註冊的使用者在第一次完成電子郵件欄位後返回簽出頁面時，應用程式會在簽出頁面上顯示填入的密碼欄位。 [GitHub-26903](https://github.com/magento/magento2/issues/26903)

<!-- ENGCOM-7777 -->

* 已新增遺失的`aclResource`屬性至Admin標頭`AdminNotification`工具列區塊。 以前，即使管理員使用者沒有檢視它的角色資源許可權，也可以看到管理員通知工具列專案。 [GitHub-29067](https://github.com/magento/magento2/issues/29067)

<!-- ENGCOM-8022 -->

* `framework/database/select` `where`函式現在可以正確處理`type`。 [GitHub-29590](https://github.com/magento/magento2/issues/29590)

<!-- ENGCOM-8260 -->

* 在整個程式碼基底中，改善了在回圈中使用`array_merge`的效率低，這改善了多個位置（包括靜態內容部署程式中）的效能。 [GitHub-30183](https://github.com/magento/magento2/issues/30183)

<!-- ENGCOM-8445 -->

* 預設的管理員工作階段存留期已從加密模組移至安全性模組。 [GitHub-30859](https://github.com/magento/magento2/issues/30859)

<!-- ENGCOM-8425 -->

* 應用程式現在會檢查類別中的私用常數，並在有任何`static::`呼叫時顯示警告。 之前，應用程式擲回此錯誤： `Undefined class constant`。

<!-- ENGCOM-8219 -->

* 在`editorconfig`中新增規則，以支援將JSON和YAML檔案縮排為兩個空格。 [GitHub-30066](https://github.com/magento/magento2/issues/30066)，[GitHub-30063](https://github.com/magento/magento2/issues/30063)

<!-- ENGCOM-8079 -->

* `FlushCacheByTags`類別已更新為使用外掛程式，而非周邊外掛程式。 [GitHub-29558](https://github.com/magento/magento2/issues/29558)

<!-- ENGCOM-8358 -->

* `MessageValidator`在不包含`0`元素的雜湊陣列上不再失敗。 [GitHub-30563](https://github.com/magento/magento2/issues/30563)

<!-- ENGCOM-8370 -->

* 已從`checkout_index_index.xml`、`sortOrder`、`messages`、`authentication`及`progressBar`元件中移除`estimation`，以增強`sidebar checkout`檔案中的程式碼。 [GitHub-30550](https://github.com/magento/magento2/issues/30550)

<!-- ENGCOM-8379 -->

* `calc`中的內容現已逸出，導致CSS輸出檔案中有正確的`calc`值。 以前，應用程式傳回不正確的`calc`值。 [GitHub-30542](https://github.com/magento/magento2/issues/30542)

<!-- ENGCOM-8030 -->

* URL重寫產生器現在會在儲存全域範圍的類別URL重寫時，將類別物件`url_key`、`url_path`和`store_id`設定為預設的存放區值。 之前，它使用上次處理的存放區ID的值儲存`url_key`、`url_path`和`store_id`。 [GitHub-29585](https://github.com/magento/magento2/issues/29585)

<!-- ENGCOM-8250 -->

* `\Magento\Widget\Controller\Adminhtml\Widget\Instance\Validate`現在會將片語結果值辨識為錯誤訊息，並在Widget驗證期間將其輸出給使用者。 [GitHub-27397](https://github.com/magento/magento2/issues/27397)

<!-- ENGCOM-8311 -->

* `Magento\Catalog\Model\Category\DataProvider::getFieldsMap()`中類別屬性的硬式編碼清單已由快取產生的屬性清單取代。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-7759 -->

* 已移除`req.http.host/client.ip`的備援雜湊，雜湊是由Varnish內建VCL處理。 [GitHub-29988](https://github.com/magento/magento2/issues/29988)

<!-- ENGCOM-8302 -->

* 已將失敗回呼新增至`Magento_Ui`檔案上傳程式。 [GitHub-29557](https://github.com/magento/magento2/issues/29557)

<!-- ENGCOM-8405 -->

* 已更正`acl.xml`已啟用，但`Magento_LoginAsCustomerAssistance`或`Magento_LoginAsCustomerAdminUi`已停用時所發生的`Magento_LoginAsCustomerLog`不一致。 先前，當具有這些認證的管理員嘗試登入管理員時，應用程式顯示空白頁面，並在發生下列情況時擲回此錯誤： `Exception #0 (LogicException): Could not create an acl object: Invalid Document Element 'resource': The attribute 'title' is required but missing. Line: 13`。 [GitHub-30680](https://github.com/magento/magento2/issues/30680)

<!-- ENGCOM-8157 -->

* 外掛程式建立期間產生`Undefined class constant`時，應用程式不再擲回`Interceptor`錯誤。 [GitHub-28981](https://github.com/magento/magento2/issues/28981)，[GitHub-29879](https://github.com/magento/magento2/issues/29879)

<!-- ENGCOM-8108 -->

* 應用程式現在可以正確處理非同步大量操作的傳訊和記錄。 先前，雖然產品已更新，`magento_operation`和`queue_message_status`資料表未正確更新，且系統訊息不正確。 [GitHub-29718](https://github.com/magento/magento2/issues/29718)

<!-- ENGCOM-8388 -->

* 當商店啟用&#x200B;**需要電子郵件確認**&#x200B;時，購物者按一下[重設密碼]電子郵件中的&#x200B;**設定新密碼**，系統現在會按預期將購物者重新導向至[設定新密碼]頁面。 以前，購物者會被重新導向回登入頁面上的&#x200B;**忘記密碼**&#x200B;按鈕。 [GitHub-27954](https://github.com/magento/magento2/issues/27954)

<!-- ENGCOM-8337 -->

* 以預設值儲存列系統組態時，更正陣列至字串轉換錯誤。 [GitHub-30314](https://github.com/magento/magento2/issues/30314)

<!-- ENGCOM-8440 -->

* 您現在可以設定訊息佇列的引數。 [GitHub-30216](https://github.com/magento/magento2/issues/30216)

<!-- ENGCOM-8384 -->

* 基礎檔案收集器現在遵循`AppState->emulateAreaCode()`。 [GitHub-39656](https://github.com/magento/magento2/issues/29656)

<!-- ENGCOM-8441 -->

* 新`BlockByIdentifier`類別支援根據CMS區塊識別碼擷取配置區塊。 因此，從快取中移除CMS區塊時，應用程式也會清除配置區塊快取。 [GitHub-28309](https://github.com/magento/magento2/issues/28309)

<!-- ENGCOM-8385 -->

* 修正佇列中數值引數轉換的問題。 先前，當您在`type`中宣告含數值`queue_topology.xml`引數的佇列時，引數值會轉換為字串。 [GitHub-29615](https://github.com/magento/magento2/issues/29615)

## 禮品卡

<!-- MC-38989-->

* 現在，當訂單專案訂購時&#x200B;**建立禮品卡帳戶**&#x200B;組態設定啟用時，包含禮品卡代碼的電子郵件只會在訂單成功儲存後才傳送。 先前，如果訂購商品時產生禮卡帳戶，但傳送虛擬禮卡後發生例外狀況，則會重複使用禮卡代碼並傳送給不同客戶。

<!-- MC-36496-->

* 應用程式不再複製禮品卡訂單。 以前，當購物者訂購一張禮品卡時，應用程式會傳送兩個禮品代碼。 發生此狀況是因為`cron`個呼叫`\Magento\GiftCard\Observer\GenerateGiftCardAccountsInvoice::execute()`的工作，而且此方法並未檢查是否已在建立發票期間產生禮品卡代碼。

<!-- MC-35058-->

* 商家現在可以根據預期取消指派類別中的產品。 之前，應用程式擲回與此錯誤類似的錯誤： `Could not save product "4" with position 0 to category 3`。

<!-- ENGCOM-8326 -->

* 新增錯誤頁面和維護模式中符號連結`root`的支援。 先前，如果`root`或`magento/pub`已符號連結至不同的目錄，則錯誤處理器(`Magento\Framework\Error\Processor`)不會產生正確的檢視檔案URL。 [GitHub-30296](https://github.com/magento/magento2/issues/30296)

<!-- ENGCOM-8087 -->

* 已將遺失的`order_data`陣列新增至`EmailSender`類別。 這使得這些類別符合Magento的建議，使用純量變數而不是電子郵件範本中的物件。 [GitHub-29604](https://github.com/magento/magento2/issues/29604)

### Google Tag Manager

<!-- MC-34818-->

* Google Tag Manager `productClick`函式現在可如預期運作。 之前，清單頁面上的產品並未觸發`productClick`，且Google Tag Manager無法擷取該事件。

<!-- MC-38781-->

* 在購物車中編輯可設定的產品選項後，Google Tag Manager可設定的產品選項現在會在資料層中按預期更新。 先前，當產品選項變更時，`removeFromCart`事件的資料會錯誤重寫，且數量保持不變。

### GraphQL

<!-- MC-37615-->

* `urlResolver`查詢現在可以正確處理查詢引數。

<!-- ENGCOM-8422 -->

* 將自訂CMS節點和頁面指定為輸入時，`urlResolver`查詢不再傳回NULL。 [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209 ENGCOM-8386-->

* `category`查詢不再傳回已停用的父類別的子類別。 [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* 停用URL重寫時，`category`查詢現在會傳回類別影像的正確路徑。

<!-- MC-36648 8321-->

* `resetPassword`突變現在會在發生錯誤時傳回資訊性更強的訊息。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078 ENGCOM-8504-->

* 產品位置變更時，`products`查詢的快取結果會如預期失效。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- MC-35355 ENGCOM-8404-->

* 當使用`products`關鍵字指定`category_id`篩選器時，`in`查詢現在會傳回預期的結果。 [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8373 -->

* `categories`和`categoryList`查詢現在會根據類別許可權組態和父類別識別碼來考量類別可用性。 [GitHub-29880](https://github.com/magento/magento2/issues/29880)，[GitHub-30624](https://github.com/magento/magento2/issues/30624)

<!-- MC-37603-->

* `updateProductsInWishList`突變現在已正確驗證願望清單專案。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- ENGCOM-8430 PWA-1107-->

* 已棄用`ProductInterface`和`CategoryInterface`中的幾個屬性，以防止在店面上使用它們。 [GitHub-30625](https://github.com/magento/magento2/issues/30625)

* 現在，當類別許可權設定為隱藏價格時，產品查詢結果會隱藏價格。 [GitHub-29926](https://github.com/magento/magento2/issues/29926)

<!-- MC-36898 PWA-1299-->

* 您現在可以使用`addProductsToWishList`突變將具有使用者定義數量的組合產品新增至願望清單。

<!-- MC-36648 -->

* 將產品加入購物車的變動現在會遵循目錄許可權。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-36946 -->

* 新增至購物車操作的GraphQL回應時間已改善。

<!-- ENGCOM-8099 -->

* `products`查詢現在會如預期傳回層級價格值。 [GitHub-29168](https://github.com/magento/magento2/issues/29168)

<!-- ENGCOM-7528 -->

* 已從`getMappedNums`中的回圈移除多餘的`lib/internal/Magento/Framework/GraphQl/Query/EnumLookup.php`。 [GitHub-30031](https://github.com/magento/magento2/issues/30031)

<!-- ENGCOM-8172 -->

* 當查詢的產品具有停用的相關產品時，`products`查詢不再傳回錯誤。 [GitHub-28892](https://github.com/magento/magento2/issues/28892)

<!-- MC-37395 -->

* `cart`查詢現在會傳回已轉換為正確貨幣（預設顯示貨幣）的價格。 以前，查詢會傳回以基本貨幣表示的料號價格值，而貨幣代碼會傳回為預設顯示貨幣。

<!-- MC-37388-->

* GraphQL現在會遵循目錄許可權。 應用程式會根據購物者的客戶群組，限制針對`products`查詢傳回哪些專案。

<!-- MC-39690-->

* 已將`customizable_option`屬性新增至實作`CartItemInterface`的多個資料型別。

<!-- MC-39744-->

* 已新增`storeConfig`查詢的屬性，以傳回商店、商店群組和網站資訊。

<!-- MC-37414-->

* 已復原`SelectedCustomizableOption.type`屬性。 此外，`customizable_options`的各種實作中的`CartItemInterface`屬性現在為非Null。

<!-- MC-23860-->

* `products`查詢的搜尋功能不再傳回已啟用類別許可權的專案。

<!-- MC-37726-->

* `products`查詢針對擁有多種貨幣的存放區檢視傳回正確的貨幣。

<!-- MC-37727-->

* `products`查詢篩選的標籤現在會傳迴轉譯的值（如果適用於非預設存放區檢視）。

<!-- MC-37728-->

* 固定購物車中禮品卡上的商店貨幣金額。

<!-- MC-38443-->

* 新增`ConfigurableProductOptionsSelection`資料型別，其中包含與產品可選取之可設定選項對應的中繼資料。 在`products`查詢中使用此物件，以儘量減少當購物者選取可設定的產品選項時顯示的媒體收藏館專案數量。

### 已分組的產品

<!-- MC-35361-->

* 產品查詢現在會傳回分組產品的所有預期資料。 以前，`product_links`是空陣列。

<!-- MC-37718-->

* 現在，當所有子簡單產品無庫存時，分組的產品會在產品編輯頁面上列為無庫存。

<!-- MC-37249-->

* 現在，當分組產品的子簡單產品的狀態變更為無庫存，其狀態會在產品編輯頁面上正確更新。 先前，已分組產品之父項的庫存料號在其子項變更庫存狀態後並未更新。

### 影像

<!-- MC-36942-->

* 商店首頁上的影像現在已成功轉譯。 先前，頁面來源HTML已損毀，因為影像base64程式碼中的三個連續斜線會誤解為評論。

<!-- ENGCOM-8116 -->

* 已從CMS模組中移除`fileinfo`擴充功能的相依性。 先前，當您嘗試使用影像上傳程式上傳影像時，應用程式擲回錯誤，此影像上傳程式會在您新增內容時按一下&#x200B;**插入影像**&#x200B;按鈕而啟動。 [GitHub-24332](https://github.com/magento/magento2/issues/24332)，[GitHub-16531](https://github.com/magento/magento2/issues/16531)，[GitHub-29852](https://github.com/magento/magento2/issues/29852)

<!-- ENGCOM-8020 -->

* 新增讀取`exif_image.png`或`exif-image.jpeg`中繼資料的支援。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- MC-37042-->

* 影像現在由目錄事件轉盤Widget在上傳後依預期顯示。 先前，`catalog_event_status_checker` cron工作已刪除上傳的影像。

<!-- ENGCOM-8296 -->

* CMYK影像顏色現在可正確演算。 當Imagick介面現在偵測到開啟的影像有CMYK色域時，該色域會轉換為SRGB。 以前，這些影像會以反轉的顏色呈現。 [GitHub-22375](https://github.com/magento/magento2/issues/22375)

<!-- ENGCOM-8251 -->

* 不再為`image_with_border.phtml`設定布林值。 已從`max-width`移除多餘的`height`和`.product-image-photo`設定。 （這些值已透過重設樣式在影像上全域設定。） [GitHub-30186](https://github.com/magento/magento2/issues/30186)

### 匯入/匯出

<!-- MC-35081-->

* 當您使用CSV檔案（`region_id`和`NULL`）匯入客戶地址（某些欄位值已從其中刪除）時，客戶地址`entity type = "customer address"`不再獲派`import behavior = "add/update"`值。

<!-- MC-35295-->

* 您現在可以在匯入期間隱藏店面上的產品影像。

<!-- MC-35395-->

* 如果CSV檔案也包含不正確的專案，排程產品匯入程式現在會以正確的資料欄位更新產品。 以前，如果CSV檔案包含不正確的專案，則不會更新任何專案，因為&#x200B;**發生錯誤：繼續處理**&#x200B;已啟用。

<!-- MC-35836-->

* 當匯入的產品在CSV檔案中將`qty`設定為0但`is_in_stock set`設定為1時，該產品未列在類別頁面上，且產品詳細資料頁面將其識別為無庫存。 以前，具有這些值的產品在匯入後會顯示在店面上。

<!-- MC-38433-->

* CSV匯入不再忽略其他屬性的`dropdown`和`textarea`值。 以前，這些屬性值在匯入期間不會更新。

<!-- MC-37933-->

* 產品匯出CSV檔案現在會如預期顯示在匯出CSV檔案的「管理員」清單中。 之前，應用程式在您執行此命令時擲回錯誤： `bin/magento queue:consumers:start exportProcessor --single-thread --max-messages=10000`。

<!-- MC-37672-->

* 匯入包含孟加拉文（孟加拉文）字母字元的CSV資料時，應用程式不再擲回錯誤。

<!-- MC-36410-->

* 現在，當管理員在匯入檔案期間按一下&#x200B;**檢查資料**，且檔案在匯出後於Chrome中工作時已變更，應用程式會顯示資訊性錯誤訊息。 以前，應用程式顯示控制檯錯誤，但未告知使用者如何繼續。

<!-- ENGCOM-8252 -->

* 若您多次匯入相同的產品CSV資料，應用程式就不會再重複產品影像。 [GitHub-21885](https://github.com/magento/magento2/issues/21885)

<!-- ENGCOM-8262 -->

* 已移除`vendor/magento/framework/File/Uploader.php`中影像檔案名稱的90個字元限制。  以前，目錄和檔案名稱的長度不能超過255個字元。 應用程式已匯入其檔案名稱超過此限制的影像產品，但未匯入影像檔案。 [GitHub-29377](https://github.com/magento/magento2/issues/29377)

<!-- ENGCOM-8153 -->

* 優惠券代碼現在可以成功匯出為CSV或XML。 先前，當您嘗試匯出優惠券時，應用程式在您按一下&#x200B;**匯出CSV**&#x200B;或&#x200B;**匯出XML**&#x200B;時顯示404錯誤。 [GitHub-29277](https://github.com/magento/magento2/issues/29277)

<!-- ENGCOM-8252 -->

* 現在匯入包含影像的CSV檔案後，會移除重複的產品影像。 [GitHub-14398](https://github.com/magento/magento2/issues/14398)，[GitHub-21885](https://github.com/magento/magento2/issues/21885)

## 索引

<!-- MC-38003-->

* 我們已改善部分索引器的效能。 應用程式現在會清除針對每個1000-ID批次反複專案變更的快取ID。 快取內容不再累積ID。 先前，快取內容累積快取ID用於每個1000-ID批次疊代，並清除每個疊代上的相同ID集。

<!-- ENGCOM-7929 -->

* 已修正部分重新索引系統與完整重新索引系統之間的不一致。 現在，兩個索引系統都使用相同的程式碼，這可以正常運作。 先前，兩個索引系統對共用索引器使用不同的邏輯，這可能會導致每次執行部分重新索引系統後索引器失效。 [GitHub-29478](https://github.com/magento/magento2/issues/29478)，[GitHub-29297](https://github.com/magento/magento2/issues/29297)

<!-- MC-38168-->

* 我們已解決導致空白類別頁面或類別頁面上的產品計數減少的手動索引器的問題。 發生下列情況時，發生不完整的類別頁面或產品計數問題：

   * `catalogsearch_fulltext`和`catalog_product_price`部分索引子已在大型目錄上執行，直到這些索引子完成執行為止。

   * 部分索引器是在`catalog_category_product`或`catalog_product_category`索引上執行，同時在這些索引之一上執行完整重新索引。 這兩個索引程式可能會發生衝突，導致類別頁面中遺失產品。

   * `bin/magento indexer:reindex inventory`已在大型目錄上執行。 在`catalogsearch_fulltext`部分索引器完成執行之前，類別頁面中遺漏產品。

<!-- MC-39700-->

* 已將索引器新增至`Magento_Bulk` MySQL資料表，以改善大量作業的效能。

<!-- MC-38806-->

* 資料庫表格中的註解現在會在重新索引(`bin/magento indexer:reindex`)後正確反映表格狀態。 以前，重新索引後的表格註解包含的值與全新安裝後註解包含的值相同。

<!-- ENGCOM-7542 -->

* 在實作MariaDB v.10.3.18的部署中，`SELECT entity_id IN`陳述式已改善，這已改善目錄類別索引的效能。 [GitHub-25199](https://github.com/magento/magento2/issues/25199)

<!-- ENGCOM-8237 -->

* Adobe Commerce已藉由消除每個索引器例項多次清除標籤的作業來改善快取效能。 [GitHub-29890](https://github.com/magento/magento2/issues/29890)

### 基礎架構

<!-- MC-34353-->

* 您現在可以使用`app/etc/env.php`將訊息代理程式從MYSQL變更為AMQP。

<!-- MC-38242-->

* 已在相關JavaScript資料庫中更正產品數量小數值的餘數計算問題。 應用程式先前錯誤地計算出超過兩位數的小數位數，隨後顯示不正確的訊息。

<!-- MC-38993 ENGCOM-8473-->

* 已棄用`\Magento\Authorization\Model\Rules::update`方法。 [GitHub-29128](https://github.com/magento/magento2/issues/29128)

<!-- ENGCOM-8000 -->

* 從UTC轉換日期物件時，應用程式不再擲回嚴重錯誤。 之前，在某些情況下，`convertConfigTimeToUtc`方法擲回例外狀況。 [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7987 -->

* 已在`DataObject`中將`\Magento\MediaGalleryCatalogUi\Ui\Component\Listing\Columns\Thumbnail::prepareDataSource`取代為產品模型。[GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- ENGCOM-7914 -->

* `RequireJS`解析程式不再無法偵測封鎖的資源。 以前，解析程式無法正確偵測頁面上的所有資源是否已正確載入或處理，且頁面仍持續載入。 [GitHub-28116](https://github.com/magento/magento2/issues/28116)

<!-- ENGCOM-8229 -->

* 屬性存放庫代碼驗證現在遵循`Magento\Eav\Model\Entity\Attribute::ATTRIBUTE_CODE_MAX_LENGTH`，而不是硬式編碼值。 [GitHub-29017](https://github.com/magento/magento2/issues/29017)

<!-- MC-35699-->

* HTML縮制不再移除PHTML檔案中HTML字串的三斜線(///)。 之前，在縮制期間，三重斜線會解譯為註解，而在部署時，會在產生的PHTML檔案中完全移除該行的其餘部分。

<!-- MC-38201-->

* 商戶現在可以在表格欄層級（而非表格層級）設定索引子訂閱。 已新增引數至`\Magento\Framework\Mview\View\Subscription`，以允許針對特定檢視或資料表組合忽略資料行。 [GitHub-30243](https://github.com/magento/magento2/issues/30243)

<!-- MC-30171-->

* 在產品頁面JavaScript完全初始化之前按一下&#x200B;**新增到購物車**&#x200B;按鈕，不再導致重複的`form_key`值。 以前，產品可以透過觸發例外狀況的快取`form_key`值新增到購物車。 當&#x200B;**加入購物車**&#x200B;在JavaScript完全初始化之前被點按，則表單資料中傳送的`form_key`值與使用者工作階段不相符，而且產品未加入購物車。 [GitHub-13746](https://github.com/magento/magento2/issues/13746)

<!-- ENGCOM-8107 -->

* 目前的cURL使用者端現在會遵循不區分大小寫的標頭名稱。 以往，`Set-Cookie`比較是區分大小寫的，這可能會造成某些HTTP伺服器發生問題。 [GitHub-29524](https://github.com/magento/magento2/issues/29524)

<!-- ENGCOM-8360 -->

* 更新`api-functional`和測試案例XML檔案中的XSD URN格式。 [GitHub-30552](https://github.com/magento/magento2/issues/30552)

<!-- ENGCOM-8295 -->

* 已將事件字首與事件物件加入至目錄產品選項值集合，以改善`\Magento\Catalog\Model\ResourceModel\Product\Option\Value\Collection`之集合載入的自訂。 [GitHub-29621](https://github.com/magento/magento2/issues/29621)

<!-- ENGCOM-8261 -->

* `array_merge`的所有相符專案都已重構為使用編碼標準中建議的格式。 [GitHub-30005](https://github.com/magento/magento2/issues/30005)

<!-- ENGCOM-7718 -->

* 型別`head.additional`的`\Magento\Framework\View\Element\Text\ListText`區塊已新增至`adminhtml` `default`配置（由`magento2/module-base`）。 [GitHub-29165](https://github.com/magento/magento2/issues/29165)

<!-- ENGCOM-8312 -->

* 將遺漏的URL方法新增至版面配置範本模組Widget。 [GitHub-30036](https://github.com/magento/magento2/issues/30036)

<!-- ENGCOM-8127 -->

* `\Magento\Framework\Filesystem\Io\File::read()`方法現在與`\Magento\Framework\Filesystem\Io\IoInterface::read()`相容。 [GitHub-27866](https://github.com/magento/magento2/issues/27866)

### 卡拉納

* 移除對PayPal模組的相依性。 [GitHub-29421](https://github.com/magento/magento2/issues/29421)

### 記錄

<!-- ENGCOM-8443 -->

* `Magento_Logging`模組現在已正確登入新值以及之前的值。 先前，「變更前的值」欄中的值會顯示N/A的值，無論這是第一次變更還是下一次變更，也無論何時傳回預設值。 [GitHub-26943](https://github.com/magento/magento2/issues/26943)

### 媒體集

<!-- ENGCOM-8014 -->

* 管理員&#x200B;**商店** > **設定** > **進階** > **系統**&#x200B;頁面已更新，以顯示正確的產品名稱（媒體收藏館）。 包括對使用者介面的次要重新設計。 [GitHub-1738](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-8019 -->

* Media Gallery影像說明的「使用位置」區段中的連結現在會顯示已如預期由選取的影像篩選的格線。 以前，顯示的網格標題不正確，清單專案不正確。 [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019 -->

* 您現在可以在「媒體集」中成功編輯多個影像。 之前，將標籤新增至一個影像後，無法再新增標籤至第二個影像。 [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015 -->

* 當您從「媒體集」中的影像移除標籤後，「標籤」下拉式功能表現在會如預期般呈現空白狀態。 [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

<!-- ENGCOM-8146 -->

* 現在支援批次處理Media Gallery同步佇列訊息。 [GitHub-1724](https://github.com/magento/adobe-stock-integration/issues/1724)

<!-- ENGCOM-8064 -->

* 在&#x200B;**增強型媒體集**&#x200B;停用時，當您嘗試開啟媒體集時，應用程式現在會依預期顯示404頁面。  [GitHub-1760](https://github.com/magento/adobe-stock-integration/issues/1760)

<!-- ENGCOM-8072 -->

* 如果發生例外狀況，`MediaGalleryMetadata`現在會略過區段讀取器，而是依預期剖析並顯示影像中繼資料。 先前，影像中繼資料是空的，因為`exif_read_data`區段讀取器發生例外狀況。 [GitHub-1782](https://github.com/magento/adobe-stock-integration/issues/1782)

<!-- ENGCOM-8069 -->

* 資料夾名稱長度不再阻止影像上傳至「媒體集」。 媒體集現在將路徑欄設定為型別`text`。 [GitHub-1778](https://github.com/magento/adobe-stock-integration/issues/1778)

<!-- ENGCOM-8217 -->

* 現在當從「媒體集」插入轉譯時，影像上傳程式會顯示正確的影像大小。 [GitHub-1806](https://github.com/magento/adobe-stock-integration/issues/1806)

<!-- ENGCOM-8467 -->

* 路徑驗證已新增到`Mediagallery`上傳程式外掛程式。 先前，驗證失敗，而且在&#x200B;**啟用舊媒體集**&#x200B;停用時，應用程式未匯入產品。 [GitHub-30649](https://github.com/magento/magento2/issues/30649)

<!-- ENGCOM-8057 -->

* 已新增`Magento_Cms::media_gallery`個ACL子資源並強制用於新的媒體集，以支援下列分散式作業設定的許可權：

   * 上傳資產
   * 將資產插入內容
   * 刪除資產
   * 建立資料夾
   * 刪除資料夾。 [GitHub-1487](https://github.com/magento/adobe-stock-integration/issues/1487)

<!-- ENGCOM-8047 -->

* 不再裁切長Media Gallery文字字串和資料夾名稱。 以前，應用程式顯示裁切的文字和影像，並顯示此訊息： `We couldn't find any records`。 [GitHub-1763](https://github.com/magento/adobe-stock-integration/issues/1763)，[GitHub-1758](https://github.com/magento/adobe-stock-integration/issues/1758)

<!-- ENGCOM-8042 -->

* 編輯新頁面的內容時，若未選取任何影像，應用程式就不會再顯示&#x200B;**新增選取專案**&#x200B;按鈕。 [GitHub-1769](https://github.com/magento/adobe-stock-integration/issues/1769)

<!-- ENGCOM-8047 -->

* 篩選器現在已如預期套用至&#x200B;**內容** > **媒體集**&#x200B;類別格線。 [GitHub-1763](https://github.com/magento/adobe-stock-integration/issues/1763)

<!-- ENGCOM-8183 -->

* Gallery現在會依預期使用多個中斷點選項組態。 先前，中斷點選項設定無法正常運作，因為`mediaCheck`在頁面載入時觸發了退出媒體查詢函式。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### MFTF

<!-- ENGCOM-8359 -->

* 以`CheckStaticBlocksTest`中的動作群組取代重複式動作。 [GitHub-30561](https://github.com/magento/magento2/issues/30561)

<!-- ENGCOM-8267 -->

* `AdminUpdateCategoryAndMakeInactiveTest`和`VerifyChildCategoriesShouldNotIncludeInMenuTest`已重構以符合MFTF最佳實務。 [GitHub-30058](https://github.com/magento/magento2/issues/30058)

<!-- ENGCOM-8458 -->

* 已移除重複的`AdminOpenCMSBlocksGridActionGroup`。 [GitHub-30896](https://github.com/magento/magento2/issues/30896)

<!-- ENGCOM-8156 -->

* 已將`AdminOpentCmsBlockActionGroup`取代為AdminOpenCmsBlockActionGroup。 [GitHub-29839](https://github.com/magento/magento2/issues/29839)

<!-- ENGCOM-8226 -->

* 已棄用`GoToAttributeGridPageActionGroup`。 [GitHub-30103](https://github.com/magento/magento2/issues/30103)

<!-- ENGCOM-8061 -->

* 已將動作群組新增至`Analytics`模組。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-7334 -->

* 更新`CheckCheckoutSuccessPageAsRegisterCustomerTest`和`CheckCheckoutSuccessPageAsGuestTest`以在測試執行後取消建立的訂單。 [GitHub-28324](https://github.com/magento/magento2/issues/28324)

<!-- ENGCOM-8214 -->

* 已移除`AdminNavigateToPageGridActionGroup`，因為備援。 [GitHub-29838](https://github.com/magento/magento2/issues/29838)

<!-- ENGCOM-8280 -->

* 已解決造成`StorefrontProductListWidgetWithSharedCatalogTest`略過測試的問題。 [GitHub-322](https://github.com/magento/partners-magento2b2b/issues/322)

<!-- ENGCOM-8122 -->

* 已實作`ActionGroup`以瀏覽至結帳頁面。 [GitHub-29843](https://github.com/magento/magento2/issues/29843)

<!-- ENGCOM-8124 -->

* 已實作`AdminOpenCreateNewCMSPageActionGroup`以導覽以建立新的CMS頁面。 [GitHub-29824](https://github.com/magento/magento2/issues/29824)

<!-- ENGCOM-8268 -->

* 已修正媒體集CMS頁面的MFTF測試中的略過問題。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

<!-- B2B-831 -->

* 已在`Company`、`CompanyCredit`、`CompanyPayment`、`CompanyShipping`和`ConfigurableSharedCatalog`模組的MFTF測試中新增有意義的標題和說明。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

#### 新測試

<!-- ENGCOM-7804 -->

* 新增在管理員中啟用電子郵件給朋友的測試。 [GitHub-29145](https://github.com/magento/magento2/issues/29145)

<!-- ENGCOM-8316 -->

* 新增管理員從網格中刪除CMS區塊的測試。 [GitHub-30372](https://github.com/magento/magento2/issues/30372)

<!-- ENGCOM-7933 -->

* 新增將購物車規則套用至單一套件專案的測試。 [GitHub-28921](https://github.com/magento/magento2/issues/28921)

<!-- ENGCOM-8075 -->

* 新增測試，以檢查刪除實體後是否顯示「媒體集」影像的&#x200B;**Used In**&#x200B;資訊。 [GitHub-1774](https://github.com/magento/adobe-stock-integration/issues/1774)

#### 新動作群組

* `AssertStorefrontCustomerLogoutSuccessPageActionGroup`。 [GitHub-29841](https://github.com/magento/magento2/issues/29841) <!-- ENGCOM-8121 -->

* `AdminOpenConfigurationStoresPageActionGroup`。 [GitHub-29848](https://github.com/magento/magento2/issues/29848) <!-- ENGCOM-8259 -->

* `ReloadPageActionGroup`。 [GitHub-30683](https://github.com/magento/magento2/issues/30683) <!-- ENGCOM-8394 -->

* `StorefrontClickRefundTabCustomerOrderViewActionGroup`。 [GitHub-30032](https://github.com/magento/magento2/issues/30032) <!-- ENGCOM-8203 -->

* `AdminOpenAdminThreeDSecurePageActionGroup`。 [GitHub-29845](https://github.com/magento/magento2/issues/29845) <!-- ENGCOM-8115 -->

* `AdminCustomerClickFirstRowEditLinkActionGroup`。  [GitHub-29501](https://github.com/magento/magento2/issues/29501) <!-- ENGCOM-8043 -->

* `StorefrontClickAddToCartButtonActionGroup`。 [GitHub-29823](https://github.com/magento/magento2/issues/29823) <!-- ENGCOM-8113 -->

* `AdminDeleteTaxRateActionGroup`。 [GitHub-29940](https://github.com/magento/magento2/issues/29940) <!-- ENGCOM-8192 -->

* `AdminOpenWebConfigurationPageActionGroup`。 [GitHub-29846](https://github.com/magento/magento2/issues/29846) <!-- ENGCOM-8126 -->

* `AdminOpenGeneralConfigurationPageActionGroup`。 [GitHub-29847](https://github.com/magento/magento2/issues/29847) <!-- ENGCOM-8114 -->

* `AdminOrderClickSubmitOrderActionGroup`。 [GitHub-29649](https://github.com/magento/magento2/issues/29649) <!-- ENGCOM-8023 -->

* `AdminOpenCatalogProductPageActionGroup`。 [GitHub-29941](https://github.com/magento/magento2/issues/29941) <!-- ENGCOM-8209 -->

* `AdminClickInvoiceButtonIntoOrderActionGroup`。 [GitHub-25399](https://github.com/magento/magento2/issues/25399) <!-- ENGCOM-8210 -->

* `AdminGridBulkActionGroup`。 [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminGridColumnShowActionGroup`。 [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminOpenIndexManagementPageActionGroup`。 [GitHub-29825](https://github.com/magento/magento2/issues/29825) <!-- ENGCOM-8123 -->

* `AdminOpenCatalogSearchTermIndexPageActionGroup`。 [GitHub-29844](https://github.com/magento/magento2/issues/29844) <!-- ENGCOM-8128 -->

* `AdminClickAddProductToggleAndSelectProductTypeActionGroup`。 [GitHub-30917](https://github.com/magento/magento2/issues/30917) <!-- ENGCOM-8439 -->

* `StorefrontCheckoutClickSaveAddressButtonActionGroup`。 [GitHub-30916](https://github.com/magento/magento2/issues/30916) <!-- ENGCOM-8454 -->

* `AdminOpenCurrencyRatesPageActionGroup`。 [GitHub-30783](https://github.com/magento/magento2/issues/30783) <!-- ENGCOM-8432 -->

* `AdminClickGetShippingMethodsAndRatesActionGroup`。 [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `AdminSelectFixedShippingMethodActionGroup`。 [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `StorefrontClickProceedToCheckoutActionGroup`。 [GitHub-30926](https://github.com/magento/magento2/issues/30926) <!-- ENGCOM-8438 -->

* `StorefrontOpenMyAccountPageActionGroup`。 [GitHub-29842](https://github.com/magento/magento2/issues/29842) <!-- ENGCOM-8143 -->

### 電子報

<!-- MC-38789-->

* 當客戶訂閱已排入佇列的Newsletter時，管理員使用者現在可以依預期編輯客戶帳戶。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8034 -->

* 如果購物者未確認其電子報訂閱，應用程式現在會重新傳送電子報訂閱確認。 [GitHub-28422](https://github.com/magento/magento2/issues/28422)

<!-- ENGCOM-8429 -->

* 當客戶訂閱已排入佇列的Newsletter時，您現在可以依預期編輯客戶帳戶。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

### 付款方法

<!-- MC-35161-->

* 現在，所有網站的付款方法會如多商店部署所預期在Admin中載入。

<!-- MC-36954-->

* 在購物者輸入任何資訊之前，應用程式不再顯示優惠券代碼欄位上方的`Purchase Order number is a required field`訊息，這些資訊的部署已將採購單設定為唯一可用的付款選項。

<!-- MC-35152-->

* 當購物者的名稱包含重音字母時，應用程式現在會成功完成Payflow Pro付款。 先前付款未完成，應用程式記錄此錯誤： `report.CRITICAL: String to be escaped was not valid UTF-8 or could not be converted`。

<!-- ENGCOM-8173 -->

* 當啟用&#x200B;**自動指派至客戶群組**&#x200B;時，訪客購物者現在可以下達PayPal訂單。 付款會在PayPal閘道處理，訂單會在Magento中建立，而購物者會看到訂單感謝頁面。 之前，訂單已在PayPal閘道成功處理，但訂單並非在Adobe Commerce中建立。 購物者被重新導向至訂單檢閱頁面，應用程式顯示這個錯誤： `Failed address validation: %1" error`。 [GitHub-25399](https://github.com/magento/magento2/issues/25399)

#### PayPal

<!-- MC-35692-->

* 現在，從使用信用卡的付款方式切換為非信用卡付款方式後，商家可以成功向管理員下訂單。 先前，當商家按一下&#x200B;**提交訂單**&#x200B;按鈕時，載入程式會開始但從未完成，而且未下訂單。

<!-- MC-37649-->

* 使用PayPal Express下訂單時，應用程式不會再建立重複訂單。 先前，當購物者嘗試透過PayPal Express支付訂單，但PayPal傳回錯誤時，應用程式仍會建立訂單。 這會導致商家網站上出現重複訂單。 [GitHub-13952](https://github.com/magento/magento2/issues/13952)

<!-- MC-38829-->

* PayPal結算報告現在可在&#x200B;**報告** > **銷售** > **PayPal結算**&#x200B;正常取得。 之前，應用程式未在PayPal結算報表格線中列出這些報表，且會顯示下列訊息： `We couldn't find any records`。

<!-- MC-39442-->

* 結帳時按一下&#x200B;**PayPal**&#x200B;按鈕不再觸發備援`web-api`呼叫。 之前會觸發兩個請求，使得產品費用加倍。

### 效能

<!-- MC-37705-->

* `module-catalog-import-export/Model/Import/Product/Option.php`中的效能問題已解決。 匯出或匯入超過100,000筆記錄所需的時間已縮短。 檢視大量產品選項的[匯入/匯出所花的時間比預期長](https://support.magento.com/hc/en-us/articles/360050695772)知識庫文章。

<!-- MC-37799-->

* `Magento_Csp/Model/BlockCache`已重新建構，以減少記憶體耗用量和產生不需要的大型快取字串。 以前，包含動態列入白名單的指令碼和樣式的頁面經常會因效能問題而發生問題。 [GitHub-29964](https://github.com/magento/magento2/issues/29964)

<!-- MC-37816 -->

* 針對使用消費者超過100,000種產品的目錄，我們已改善其排程匯出的效能。

<!-- MC-38306 -->

* 當您新增或儲存已停用的產品至類別時，應用程式不再排清類別快取。 以前，應用程式不顧產品狀態仍會排清相關類別的快取，這會影響伺服器效能。

<!-- MC-38518 -->

* 更新購物車中產品數量的頁面載入時間已改善。 以前，應用程式會針對購物車中的每個產品執行多個個別的查詢，這會增加頁面載入時間。

<!-- MC-39700 -->

* 已將索引器新增至`Magento_Bulk` MySQL資料表，以改善大量作業的效能。

<!-- MC-38593 -->

* 應用程式現在會快取可設定產品的子項ID。 藉由減少資料庫要求的數目，已改善頁面載入效能。 [GitHub-30585](https://github.com/magento/magento2/issues/30585)

<!-- MC-37594 -->

* 已改善管理員控制面板的載入作業。 以前，應用程式在頁面完成載入之前，以清單形式顯示索引標簽名稱。

<!-- MC-37417 -->

* 透過為版面配置快取新增到期限制，改善了Redis快取管理。 以前，Redis在大型部署中會快速達到配置的最大記憶體，而應用程式會在寫入作業時擲回錯誤。

<!-- ENGCOM-8016 -->

* 移除`app/code/Magento/Catalog/Model/CategoryLink.php`中的多餘資料庫查詢，已改善簽出效能。 [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- ENGCOM-8290 -->

* `Magento\Framework\DB\Adapter\Pdo\Mysql->isTableExists`已重構以改善效能。 減少對`SHOW TABLE STATUS`的重複呼叫，以檢查資料表是否存在。 [GitHub-29662](https://github.com/magento/magento2/issues/29662)

<!-- ENGCOM-8258 -->

* `getPageLayoutsConfig`現在儲存在快取中，這已改善設定產生器的效能。 [GitHub-29546](https://github.com/magento/magento2/issues/29546)

<!-- MC-35614-->

* 針對包含超過3,000,000名客戶的客戶區段，在編輯和儲存作業期間的Adobe Commerce效能已有所改善。

### 永久

<!-- MC-36647 -->

* 啟用永久購物車時，購物者在其工作階段Cookie過期後無法再下訂單。 相反地，應用程式會顯示登入頁面，讓購物者可以登入。 之前，應用程式會下訂單。 當`PHPSESSID`過期時，應用程式未正確驗證永久客戶，且從永久資訊重新建立`customerSession`。

<!-- MC-39127-->

* 當購物者登入已啟用永久購物車的商店後，應用程式現在會依預期顯示歡迎訊息。 以前，應用程式顯示&#x200B;**不是您？登入後**&#x200B;則訊息。

<!-- MC-38269-->

* 應用程式不再顯示&#x200B;**不是您嗎？當客戶登入已啟用永久購物車的部署時，選取**&#x200B;記住我&#x200B;**選項時出現**&#x200B;文字。

<!-- MC-37109-->

* 在客戶工作階段過期後，應用程式不再顯示客戶購物車的內容。 以前，當訪客客戶嘗試在啟用永久購物車時結帳時，應用程式會顯示此錯誤： `No such entity with cartid = 0`。

### 定價

<!-- MC-34394-->

* 連續的非同步價格更新不再互相干擾，而且會為每個作業指派正確的狀態。 先前，如果非同步價格更新失敗，則後續的所有非同步價格更新都會失敗，直到對應的佇列消費者重新啟動為止。 [GitHub-27865](https://github.com/magento/magento2/issues/27865)

### 報表

<!-- MC-36652 38925-->

* **報告** > **行銷** > **購物車中的產品**&#x200B;現在只會顯示正在產生報告之使用者允許範圍內的記錄。 以前，所有資料都可用於所有範圍。

<!-- MC-38074-->

* 在「購物車中的產品」報表中顯示產品貨幣時，應用程式現在會使用產生報表之商家角色範圍中指定的貨幣。

<!-- MC-37934-->

* 「最近檢視」和「最近比較」產品功能現在會在管理員中顯示不同商店和網站的統計資料，如同多商店部署中的預期。 以往，這些功能並未考慮所有商店或網站。

<!-- MC-37217-->

* 訂單報表中的價格現在使用正確的貨幣符號。

<!-- ENGCOM-8314 -->

* 應用程式現在會在使用者按一下Admin儀表板&#x200B;**移至進階報告**&#x200B;按鈕時，驗證權杖是否存在。  如果Token存在，應用程式會顯示「進階報告」頁面。 如果未設定Token，應用程式會在使用手冊中顯示資訊頁面。 [GitHub-25411](https://github.com/magento/magento2/issues/25411)

### 退貨授權(RMA)

<!-- MC-36057-->

* 分割RMA時，選取的選項現在會套用至分割明細專案。 以前，不會儲存「退貨原因」、「料號條件」和「解決方式」的值。

<!-- MC-35360-->

* 啟用JavaScript套件組合時，您現在可以刪除RMA的追蹤和運送資訊。

<!-- MC-36757-->

* 僅能有限制存取特定網站範圍中產品的管理員，現在可以新增專案至回訪，即使該專案不再在其網站範圍中亦然。

### 評論

<!-- MC-37145-->

* **存放區** > **屬性** > **評等**&#x200B;上顯示的評等數目現在符合多網站部署中的評等計數。 [GitHub-30258](https://github.com/magento/magento2/issues/30258)

<!-- MC-37117-->

* 當您按一下管理員&#x200B;**行銷** > **所有檢閱**&#x200B;上的&#x200B;**新增檢閱**&#x200B;按鈕時，新檢閱頁面現在會如預期載入。 按一下此頁面上的產品會開啟該產品預期的新檢閱表單。

<!-- ENGCOM-8383 -->

* 當您嘗試從管理員&#x200B;**行銷** > **所有評論**&#x200B;編輯訂單時，應用程式不再擲回此錯誤： `Uncaught TypeError: Event.observe is not a function`。 [GitHub-30388](https://github.com/magento/magento2/issues/30388)

### 獎勵

<!-- MC-38257-->

* 部份訂單完成時，可依預期計算應稅訂單的獎勵積分。

<!-- MC-37244-->

* 商戶現在可以針對已使用獎勵點數購買的訂單，成功發出部份退款，並且之後仍可退還剩餘的訂單金額。 以前，商家無法退還剩餘訂單的獎勵積分。

<!-- MC-37113-->

* 當購物者在移除獎勵點後重新套用獎勵點數時，應用程式不再顯示此錯誤： `You removed the reward points from this order`。

<!-- MC-37032-->

* 現在，當客戶在支援多種貨幣的商店中使用非基本貨幣下訂單時，可正確計算獎勵積分。

### 銷售

<!-- MC-36219-->

* `order_created_at`的`sales_shipment_grid`資料行現在會在每次更新後依預期更新。

<!-- MC-36405-->

* 您現在可以從已啟用&#x200B;**使用JavaScript行事曆**&#x200B;的商店中，成功重新訂購具有自訂選項日期的產品。 先前，當您嘗試重新排序時，應用程式沒有將專案加入購物車並顯示此錯誤： `Could not add the product with SKU "simp1" to the shopping cart: Please specify date required option(s).`

<!-- MC-36533-->

* 當購物者結帳的訂單包含已啟用零小計結帳方法的部署中總成本為$0的虛擬產品時，應用程式不再立即關閉訂單。

<!-- MC-36755-->

* 應用程式在處理訂單前不再加以封存。 以前，管理員訂單格上的多選動作會影響未選取的訂單。

<!-- MC-37371-->

* 現在當沙烏地裡亞爾(SAR)設為基本貨幣時，銷退折讓單格線會顯示正確的貨幣符號。

<!-- MC-37880-->

* 應用程式現在會在結帳時，如預期在訂單頁面上一致地顯示送貨地址資訊。

<!-- MC-38666-->

* `total_qty`的值現在與銷售發票中`total_qty_ordered`的值相符。

<!-- MC-38717-->

* 非同步傳送銷售電子郵件現在只會傳送上次更新日期後所建立訂單的電子郵件。 以往，啟用非同步傳送時，應用程式不會依日期篩選電子郵件。

<!-- MC-39135-->

* 現在，當管理員下訂單時，應用模組會依預期傳送發票電子郵件。

<!-- MC-38917-->

* 現在，當商家從管理員為客戶建立新訂單時，應用程式會在工作階段期間清除現有的訂單資料。

<!-- MC-38915-->

* 啟用&#x200B;**啟用自動指派至客戶群組**&#x200B;時，您現在可以變更透過管理員訂單建立之新客戶的客戶群組。 您也可以根據VAT驗證來指定客戶群組。 先前，驗證VAT編號時，請求物件沒有檢查指派的請求`group_id`。 依預設，它使用預設的`group_id`。

<!-- MC-37539-->

* 當商家使用REST API建立部份出貨後，應用程式不再將狀態為`Suspected Fraud`的自訂訂單狀態變更為`Processing`。

### 銷售規則

<!-- MC-34793-->

* 購物者變更送貨方式時，已根據送貨方式套用的優惠券代碼將不再套用。 以往，當購物者切換送貨方式時，應用程式不會清除優惠券代碼。

<!-- MC-34649-->

* 購物者套用優惠券代碼的頻率不能超過&#x200B;**每位客戶使用次數**&#x200B;設定許可。 先前，如果購物者開啟了多個瀏覽器視窗且同時下多張訂單，則每張訂單都會收到折扣，即使&#x200B;**每位客戶使用次數**&#x200B;設定的值為&#x200B;**1**。

### 搜尋 {#search-heading}

<!-- MC-35095-->

* 購物者搜尋搜尋同義字時，Elasticsearch不再擲回未知的修飾元錯誤。 先前，逸出在規則運算式中缺少逸出斜線符號，這會導致嚴重錯誤。

<!-- MC-37577-->

* 當子產品設定為可見度設定為&#x200B;**不個別顯示**&#x200B;時，進階搜尋不再傳回可設定產品的子項作為個別搜尋結果。

<!-- MC-37954-->

* 搜尋結果中的Elasticsearch產品名稱排序不再區分大小寫。

<!-- ENGCOM-8329 -->

* 當在管理員&#x200B;**存放區** > **設定** > **目錄** > **目錄** > **目錄搜尋**&#x200B;中啟用&#x200B;**設定要快取的上層搜尋結果數目為0**&#x200B;設定時，搜尋結果頁面現在會如預期快取。

<!-- MC-36807-->

* 目錄搜尋索引子現在會執行，不會因為Elasticsearch欄位限制而擲回錯誤。 之前，應用程式擲回此錯誤： `Limit of total fields [xxx] in index [m24dev_product_1_v10] has been exceeded`。

<!-- MC-35491-->

* 目錄搜尋的效能已改善。 停用&#x200B;**啟用搜尋建議** （**存放區** > **組態** > **目錄** > **目錄搜尋** ）如預期般運作。 之前，應用程式查詢MySQL `search_query`表格而非Elasticsearch以取得自動完成搜尋建議。 [GitHub-25534](https://github.com/magento/magento2/issues/25534)

<!-- MC-35256-->

* Elasticsearch現在會篩選與MySQL相同的產品價格。 在Elasticsearch索引中，欄位型別`price_*`已從`float`變更為`double`，以提高精確度並更正浮點錯誤。

<!-- ENGCOM-8393 -->

* 已新增一個鍵值事件接聽程式至Admin，以便在輸入正斜線時啟動全域搜尋表單。 [GitHub-29551](https://github.com/magento/magento2/issues/29551)

<!-- MC-24217-->

* 當使用`string`值來依具有`integer`或`decimal`後端型別的屬性篩選產品時，Elasticsearch不再擲回錯誤，而是不再如預期顯示產品。 以前，應用程式在`exception.log`中顯示此錯誤： `number format exception`。

<!-- ENGCOM-8303 -->

* 當搜尋詞包含`/`時，Elasticsearch不再擲回例外狀況。  [GitHub-25886](https://github.com/magento/magento2/issues/25886)，[GitHub-25110](https://github.com/magento/magento2/issues/25110)

* 在一般類別許可權中的&#x200B;**不允許目錄搜尋依據**&#x200B;組態設定已啟用時，現在會依預期停用產品查詢中選取之客戶群組的搜尋。 [GitHub-29927](https://github.com/magento/magento2/issues/29927)

<!-- ENGCOM-8466 -->

* 搜尋結果不再包含相同字的多重引號。 [GitHub-30104](https://github.com/magento/magento2/issues/30104)

### 送貨

<!-- MC-38247 -->

* 當網路中斷中斷與DHL傳送方法的連線時，結帳程式不會再失敗。 應用程式改為顯示其他可用的送貨方法。 以前，當與DHL傳送的連線中斷時，結帳程式會停止，且應用程式會顯示此錯誤： `Sorry, no quotes are available for this order at this time`。 [GitHub-29902](https://github.com/magento/magento2/issues/29902)

<!-- MC-35194-->

* 在管理員&#x200B;**商店** > **設定** > **銷售** > **傳遞方法**&#x200B;上描述UPS傳遞方法的欄位現在已如預期啟用。

<!-- MC-35633-->

* 透過POST `/rest/V1/shipment`端點建立的出貨現在可以正確更新訂單。 之前，應用程式已建立出貨，但出貨狀態仍維持在處理狀態。

<!-- MC-37120-->

* 使用「送至多個地址」結帳之前，若有其他產品從購物車移除，應用程式就不會再從購物車移除簡單產品。 [GitHub-30259](https://github.com/magento/magento2/issues/30259)

<!-- MC-38031-->

* 「訂單複查」頁面現在會針對出貨至多個地址的訂單，依預期顯示出貨金額之前的稅捐金額。

<!-- ENGCOM-8257 -->

* UPS出貨追蹤現在只有在已遞送包裹時，才會顯示`Delivered On`的狀態。 [GitHub-30032](https://github.com/magento/magento2/issues/30032)

<!-- MC-38825-->

* 當購物者從多個地址結帳回到購物車時，應用程式現在會顯示包含虛擬產品之訂單的正確購物車小計。

<!-- MC-38682-->

* 啟用JavaScript套件組合時，商家現在可以從出貨頁面針對使用FedEx出貨的現有訂單建立出貨標籤。 以前，當商家按一下&#x200B;**建立送貨標籤**&#x200B;按鈕時，應用程式擲回錯誤。

<!-- MC-36953-->

* 傳送給客戶的出貨確認電子郵件中的出貨追蹤連結，現在可如預期運作。 之前，此連結會傳回404錯誤。

<!-- ENGCOM-8025 -->

* 當購物者使用多個地址結帳，然後移除虛擬產品以外的所有產品時，應用程式現在會顯示資訊性錯誤訊息。 [GitHub-25595](https://github.com/magento/magento2/issues/25595)

<!-- ENGCOM-8253 -->

* 您現在可以依預期為部份訂單建立送貨標籤。 先前，當您嘗試為訂單中僅一個專案建立送貨標籤時，應用程式會將所有產品新增至封裝，而驗證失敗。 [GitHub-29552](https://github.com/magento/magento2/issues/29552)

<!-- ENGCOM-8154 -->

* 呼叫`/V1/guest-carts/:cartId/totals-information`時不再略過送貨方法的驗證。 [GitHub-25147](https://github.com/magento/magento2/issues/25147)

### Sitemap

<!-- MC-37306-->

* `cron`產生的網站地圖現在包含正確的影像URL。 先前，在多存放區部署中，產生的快取影像路徑不正確。

### 分段

<!-- MC-39046 -->

* 當您檢查首頁排定的更新時，「編輯首頁」頁面現在會依預期顯示所有排定的更新。 之前，應用程式只會顯示數個排程更新中的一個。

<!-- MC-34988 -->

* 使用`/rest/V1/products/special-price-information`特殊價格端點傳送0現在會儲存價格並如預期傳回排程。

<!-- MC-35362 -->

* 當匯入CSV檔案包含位元組順序標籤(BOM)時，已排程的匯入現在會如預期般執行。

<!-- MC-38026 -->

* 當商家排程類別更新時，應用程式不再移除版面配置本文類別。

<!-- MC-38234 -->

* 重新排程的產品變更在`cron`執行後不再清除。

<!-- MC-38759-->

* 當您嘗試排程類別的更新時，應用程式不再擲回錯誤。 先前，當您在[排程新更新]頁面上按一下&#x200B;**儲存**&#x200B;時，應用程式擲回此錯誤： `Something went wrong while saving the Magento\Catalog\Api\Data\CategoryInterface`。

<!-- MC-38455-->

* `rest/V1/products/special-price` API現在可用來排定多個商店的產品特別價格。 先前，當商家針對相同的`from`和`to`時間排定多個商店的價格更新時（當新排程的開始時間有復原可用時），應用程式會擲回錯誤。

### 儲存

<!-- ENGCOM-7543 -->

* 管理員和主要商店切換器現在會反映在管理員中對商店排序順序所做的變更。 [GitHub-13401](https://github.com/magento/magento2/issues/13401)

<!-- ENGCOM-8274 -->

* 應用程式現在會在商店檢視的頂層URL金鑰變更後，為類別和產品建立正確的URL。 先前，當存放區檢視的類別樹狀結構包含修改過的`url_keys`時，如果類別索引鍵並未變更，但類別父項的索引鍵有變更，則原始程式碼在建立URL時會使用類別的預設存放區檢視。 [GitHub-28633](https://github.com/magento/magento2/issues/28633)

### Target規則

<!-- MC-34998-->

* 已最佳化載入產品詳細資料頁面。 我們已新增資料庫表格的索引，這些索引可最佳化許多案例的目標規則條件查詢。

<!-- MC-36288-->

* 現在，當「要顯示的產品」功能所使用的`is one of`條件包含多個條件時，相關產品的目標規則即可運作。 先前，當此條件包含多個值時，不會進行剖析。

### 稅金

<!-- MC-37666-->

* 客體訂單上的VAT驗證不再導致應用模組以不正確的「客戶稅捐類別」儲存報價單。 [GitHub-30018](https://github.com/magento/magento2/issues/30018)

<!-- MC-37761-->

* 現在當設定FPT時，可以在結帳期間儲存要運送到多個地址的訂單。 先前，完成多個地址的訂單後，應用程式會顯示一個空白頁面，而不是訂單成功頁面。

<!-- ENGCOM-8158 -->

* 店面產品詳細資訊頁面現在會依預期顯示新舊價格（含稅或不含稅）。 [GitHub-27500](https://github.com/magento/magento2/issues/27500)，[GitHub-11998](https://github.com/magento/magento2/issues/11998)

### 測試

<!-- MC-37364-->

* `bin/magento dev:tests:run`現在會如預期啟動下列測試：全部、單位、整合、整合全部、靜態、靜態、完整性、舊版和預設。

<!-- MC-38488-->

* `AdminMediaGalleryInsertLargeImageFileSizeTest`已重構。

<!-- ENGCOM-8158 -->

* 單元測試現在與PHPUnit 8相容。 [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-8009 -->

* `\Magento\TestFramework\TestCase\WebapiAbstract`現在包含支援比較測試中預期和實際結果的大型巢狀陣列的函式。 結果中的無關索引鍵現在可以忽略。 [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-8024 -->

* `AdminMediaGalleryCatalogUiEditCategoryGridPageTest`不再隨機失敗。 [GitHub-1764](https://github.com/magento/adobe-stock-integration/issues/1764)

<!-- ENGCOM-8041 -->

* `dev/tests/integration/testsuite/Magento/Customer/Controller/AccountTest`已改善。 （`assert`現在以`XPath`選擇器為基礎，而非`assertStringContainsString`。） [GitHub-29700](https://github.com/magento/magento2/issues/29700)

<!-- ENGCOM-8017 -->

* 已新增`AdminAnalytics`模組的測試涵蓋範圍。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-8266 -->

* 整合和API功能測試現在與PHPUnit 9.3相容。[GitHub-30146](https://github.com/magento/magento2/issues/30146)

<!-- MC-35798 8109-->

* 已修正GraphQL `testRequestCacheTagsForCategoryListOnMultipleIds`測試的問題。 [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-8327 -->

* 公司點數的貨幣可用性測試已自動化。

<!-- ENGCOM-7762 -->

* 包含URL的標頭值現在已在`ApiFunctional TestFramewor`k中正確剖析。[GitHub-26425](https://github.com/magento/magento2/issues/26425)

<!-- ENGCOM-8382 -->

* `—no-tablespaces`已新增至`mysqldump`的所有專案，允許執行整合測試而不使用`PROCESS`許可權（自MySQL 5.7.31 / 8.0.21預設為執行`mysqldump`以來為必要）。 [GitHub-30566](https://github.com/magento/magento2/issues/30566)

### 主題

<!-- ENGCOM-8419 -->

* 已新增新的`--no-parent`旗標至`bin/magento setup:static-content:deploy`命令，以防止編譯佈景主題的父系。 這個新標幟可避免不必要的編譯，進而大幅提升靜態內容部署程式的效能。 請注意，使用`compact`策略時，這個新標幟無法運作。 [GitHub-30184](https://github.com/magento/magento2/issues/30184)

<!-- MC-37630 -->

* 設計設定不再產生DDL作業。 先前，當更新設計組態時，應用程式會產生可能觸發MySQL錯誤的DDL敘述句。

<!-- ENGCOM-8112 -->

* 已移除管理員主題中`Magento_ConfigurableProduct`模組中的備援程式碼。  [GitHub-29857](https://github.com/magento/magento2/issues/29857)

<!-- ENGCOM-8144 -->

* 已移除多餘的少樣式導覽和空白主題中未使用的屬性。 [GitHub-29914](https://github.com/magento/magento2/issues/29914)

<!-- ENGCOM-8285 -->

* 在行動檢視的空白主題中新增可摺疊的導覽功能。 [GitHub-30237](https://github.com/magento/magento2/issues/30237)

<!-- ENGCOM-7803 -->

* 已最佳化主題的Web字型載入。  [GitHub-29526](https://github.com/magento/magento2/issues/29526)

<!-- ENGCOM-8068 -->

* 開發人員現在可以在佈景主題中宣告自訂字型時，指定字型型別。 [GitHub-29719](https://github.com/magento/magento2/issues/29719)

### 翻譯與地區設定

<!-- MC-36836 -->

* 當Admin地區設定為阿拉伯文(`ar_SA - Saudi Arabia`)時，[Admin Orders]網格[日期選擇器]現在會如預期般運作。

<!-- MC-38476 -->

* 當購物者在註冊或新增新地址時，應用程式不再顯示錯誤訊息，而是以有效的郵遞區號輸入阿根廷地址。 以前，應用程式顯示這個錯誤： `Provided Zip/Postal Code seems to be invalid. Example: 1234. If you believe it is the right one you can ignore this notice.`

<!-- MC-38663-->

* 當購物者輸入韓文地址的五位數郵遞區號時，應用程式不會再擲回錯誤。

<!-- ENGCOM-8244 -->

* 新增對[ISO 3166-2:UY](https://en.wikipedia.org/wiki/ISO_3166-2:UY)所定義的烏拉圭地區的支援。 [GitHub-29729](https://github.com/magento/magento2/issues/29729)

<!-- ENGCOM-8220 -->

* `zip_codes.xml`已更新，強制執行巴西郵遞區號的八位數。 [GitHub-29984](https://github.com/magento/magento2/issues/29984)

<!-- ENGCOM-8304 -->

* 改善剩餘未當地語系化片語的本地化。 [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8380 -->

* 現在可以翻譯格線搜尋輸入預留位置。 [GitHub-30510](https://github.com/magento/magento2/issues/30510)

<!-- ENGCOM-8018 -->

* 應用程式現在只會在內嵌翻譯JavaScript模組啟用時下載這些模組。  [GitHub-29553](https://github.com/magento/magento2/issues/29553)

### UI

<!-- MC-38509-->

* 當購物者輸入無效資料時，「建立新帳戶」頁面上的「**建立帳戶**」按鈕會保持作用中。 此按鈕先前已停用，可防止購物者在發生錯誤後重新嘗試建立帳戶。 這是2.4.1中的已知問題。[GitHub-30513](https://github.com/magento/magento2/issues/30513)

<!-- MC-38698-->

* 改善「管理訂單編輯」頁面上的出貨格線載入功能。

<!-- MC-37870-->

* 當產品已由SKU新增到購物車時，應用程式現在會在訂單頁面上按預期顯示&#x200B;**與帳單地址相同**&#x200B;核取方塊。

<!-- ENGCOM-8007 -->

* 定義有限寬度的CSS類別現在會依預期套用至管理員&#x200B;**存放區** > **組態** > **目錄** > **XML Sitemap** > **產生設定**&#x200B;上的&#x200B;**開始時間**&#x200B;欄位。  [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992 -->

* 修正條款與條件核取方塊標籤的顯示問題。  [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7948 -->

* 無法使用層級價格時，應用程式不再於產品頁面上顯示層級價格區塊的CSS程式碼。 [GitHub-29194](https://github.com/magento/magento2/issues/29194)

<!-- ENGCOM-8084 -->

* 影像檢視詳細資訊頁面上的按鈕位置已重新排序，以符合使用者介面准則。  [GitHub-1783](https://github.com/magento/adobe-stock-integration/issues/1783)

<!-- ENGCOM-8342 -->

* 抵用券代碼文字欄位現在在Internet Explorer/EDGE瀏覽器中以適當的寬度顯示。

<!-- ENGCOM-7630 -->

* `@button__border-radius`變數現在已在`lib/web/css/source/lib/variables/_buttons.less`資料庫中定義。  `border-radius`的預設值為`3px`。 之前，`border-radius`是硬式編碼。  [GitHub-28674](https://github.com/magento/magento2/issues/28674)

<!-- ENGCOM-8067 -->

* 現在，在達到最小搜尋字串長度之前，迷你搜尋欄位中的提交搜尋按鈕（放大鏡）會停用。 [GitHub-29704](https://github.com/magento/magento2/issues/29704)

<!-- MC-38807-->

* **預覽範本**&#x200B;按鈕現在可在「編輯佇列」頁面中如預期般運作。

<!-- MC-35624-->

* 已將游標位置從&#x200B;**我的帳戶** > **禮品登入** > **共用禮品登入**&#x200B;上的&#x200B;**訊息**&#x200B;欄位中間的開頭調整。

<!-- MC-33497-->

* 「新增排程匯出」頁面上的欄版面問題已解決。

<!-- MC-31892-->

* 現在，將屬性從一個群組移動到另一個群組時，應用程式會保留屬性值。

<!-- MC-37635-->

* 應用程式現在會在店面建立帳戶頁面上如預期的&#x200B;**日期**&#x200B;輸入欄位旁顯示行事曆圖示。

<!-- ENGCOM-8085 -->

* 已新增字型粗細量變數至`lib/web/css/source/lib/variables/_typography.less`。 [GitHub-29778](https://github.com/magento/magento2/issues/29778)

<!-- ENGCOM-8211 -->

* 篩選器可見度現在可與管理網格中預期的欄可見度搭配使用。  [GitHub-30345](https://github.com/magento/magento2/issues/30345)

<!-- ENGCOM-7977 -->

* 當使用者捲動時，應用程式在「以客戶身分登入」頁面上顯示的橫幅現在會維持在頁面頂端。 [GitHub-29354](https://github.com/magento/magento2/issues/29354)

<!-- ENGCOM-8152 -->

* 設定`this.disabled(true)`時，UI選取元件選項不再可見。 [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7901 -->

* 載入Open Sans字型時不再使用`@font-family-name__base`變數。 [GitHub-29515](https://github.com/magento/magento2/issues/29515)

<!-- ENGCOM-8120 -->

* WAI-ARIA屬性`aria-atomic="true"`已新增至錯誤容器標籤。 [GitHub-29560](https://github.com/magento/magento2/issues/29560)

<!-- ENGCOM-8175 -->

* UI元件網格現在會顯示所選專案的準確計數。 先前，當依關鍵字搜尋選取了所有格點專案，而購物者隨後在選取標題核取方塊之前取消選取了某些專案時，格點會指出錯誤的選取次數。 [GitHub-29968](https://github.com/magento/magento2/issues/29968)

<!-- ENGCOM-8118 -->

* 應用模組不再於發票與出貨概觀頁面上顯示未轉譯的HTML。 [GitHub-29958](https://github.com/magento/magento2/issues/29958)

<!-- ENGCOM-8066 -->

* 按一下Admin **商店** > **匯率**&#x200B;上的&#x200B;**選項**，現在會將使用者導向至系統設定頁面的擴充貨幣選項區段。 [GitHub-29336](https://github.com/magento/magento2/issues/29336)

<!-- ENGCOM-8361 -->

* 改善對於在使用選擇器Widget型別時，根據`adminhtml`個Widget的其他條件來顯示Widget的支援。 [GitHub-13316](https://github.com/magento/magento2/issues/13316)，[GitHub-7252](https://github.com/magento/magento2/issues/7252)，[GitHub-6868](https://github.com/magento/magento2/issues/6868)

<!-- ENGCOM-8336 -->

* 改善Luma主題中確認快顯對話方塊的文字邊框間距。 [GitHub-30452](https://github.com/magento/magento2/issues/30452)

### 儲存庫

<!-- MC-39109-->

* `Vault`模組現在會從付款資訊管理服務的要求中辨識付款方式代碼。 先前，當購物者使用儲存的Braintree信用卡下訂單時，即使使用有效的付款方式，應用程式也會擲回此錯誤： `The requested Payment Method is not available`。

### 頂點

* 修改地址時，現在會依預期移除地址建議。

* 有些客戶無法將其地址儲存在帳戶面板中的競爭條件已解決。

* 在某些情況下，頂點位址驗證不再將「位址編輯」頁面新增至全頁快取。

* 當免運費設定為包含稅捐的金額時，現在會考量頂點計算的稅捐。

### Web API框架

<!-- MC-23904 ENGCOM-8421-->

* 您現在可以使用POST `V1/invoice/:invoiceId/refund`，退款產品數量為零且運費為零的發票（例如，`{"items": [{"qty": 0, "orderItemId": 6, "extensionAttributes": {}}], "appendComment": false, "notify": true, "isOnline": true, "arguments": {"adjustment_negative": 0.0, "adjustment_positive": 0.99, "shipping_amount": 0}}.` ）。之前，應用程式擲回此錯誤： `You can't create a creditmemo without products`。 [GitHub-23069](https://github.com/magento/magento2/issues/23069)

<!-- MC-33732 -->

* 您現在可以使用POST `V1/categories`來建立或更新類別。 以前，如果將`default_sort_by`值設定為陣列，應用程式不會儲存值。 當`default_sort_by`值設定為字串時，應用程式擲回此錯誤： `Error occurred during \"custom_attributes\" processing. Attribute \"default_sort_by\" has invalid value. The \"string\" value's type is invalid. The \"string[]\" type was expected. Verify and try again.`

<!-- MC-35740 -->

* 使用POST `V1/invoices/:id/capture`擷取付款資訊現在可如預期運作。 以前，應用模組會授權訂單，但只會在付款閘道的網站上擷取訂單。

<!-- MC-37794 -->

* 當您使用POST `V1/order/:orderId/ship`建立部份出貨時，端點會傳回正確數目的出貨產品。

<!-- MC-38425-->

* 使用POST `V1/order/:orderID/invoice`建立的商業發票現在可以正確反映商店信用額度所支付的部分款項。 先前，當部份訂單付款給含商店信用額的訂單時，建立發票時不會將商店信用額列入考量。

<!-- MC-36830-->

* GET `rest/all/V1/categories`和GET `rest/all/V1/categories?rootCategoryId=2`呼叫現在會如預期傳回樹狀結構中所有類別的`name`和`product_count`欄位。 之前，類別欄位值是空的。 資料表名稱解析程式外掛程式傳回不正確的資料表名稱，無法依類別擷取產品計數。

<!-- ENGCOM-8286 -->

* 提供`V1/categories/:id`自訂屬性時，PUT `save_rewrites_history`端點現在會儲存類別URL金鑰建立301重新導向所需的資料。 [GitHub-29174](https://github.com/magento/magento2/issues/29174)，[GitHub-30240](https://github.com/magento/magento2/issues/30240)

### 願望清單

<!-- MC-33626-->

* 當產品被指派給自訂庫存來源時，購物者現在可以將產品新增到願望清單。 [GitHub-3018](https://github.com/magento/inventory/issues/3018)

<!-- MC-35416-->

* 客戶從店面將產品新增至其願望清單後，管理員現在可以從管理員客戶頁面存取管理購物車頁面。 以前，當管理員按一下&#x200B;**管理購物車**&#x200B;按鈕時，應用程式會顯示下列錯誤： `An error has occurred. See error log for details`。

<!-- MC-35573-->

* 共用願望清單頁面上的&#x200B;**加入購物車**&#x200B;按鈕現在可如預期運作，適用於未登入的匿名、來賓和使用者。

<!-- MC-34411-->

* 購物者現在可以成功地將產品從一個願望清單移至另一個願望清單。

<!-- ENGCOM-8062 -->

* 應用程式現在會依預期在願望清單頁面中顯示選取的可設定產品屬性選項。 [GitHub-24091](https://github.com/magento/magento2/issues/24091)，[GitHub-22503](https://github.com/magento/magento2/issues/22503)

<!-- ENGCOM-7779 -->

* 已為`ActionInterface`實作`\Magento\Wishlist\Controller\Shared\Allcart`。 [GitHub-29537](https://github.com/magento/magento2/issues/29537)

## 已知問題

**問題**： `[magento_root]/index.php`檔案已移除，Apache設定預設會從`/pub`執行應用程式。 從子資料夾提供的存放區將無法如預期運作，並可能顯示404錯誤。 **因應措施**：使用symlink將安裝模擬至子資料夾。 下列範例使用兩個存放區（`https://shop01.com/shop/`和`https://shop02.com/shop/`）來說明如何使用symlink來模擬子資料夾中的安裝。

1. 建立`https://shop01.com/shop/`的子目錄：

   ```bash
   mkdir magento_root/pub/shop01
   ```

   ```bash
   cd magento_root/pub/shop01
   ```

1. 在新建立的目錄中建立存放區父目錄的符號連結：

   ```bash
   ln -s ../media media
   ```

   ```bash
   ln -s ../static static
   ```

   ```bash
   ln -s ../../../pub pub
   ```

   ```bash
   ln -s ../.htaccess .htaccess
   ```

   ```bash
   ln -s ../health_check.php health_check.php
   ```

1. 在新目錄(`index.php`)中建立`magento_root/pub/shop01/index.php`檔案，並新增此內容：

```php
   <?php
   require realpath(__DIR__) . '/../../../app/bootstrap.php';

   switch ($_SERVER['HTTP_HOST']) {
       case 'shop01.com':
       case 'www.shop01.com':
           $params = $_SERVER;
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = 'shop01';
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = 'website';
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
           break;

       default:
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $_SERVER);
           /** @var \Magento\Framework\App\Http $app */
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
       break;
   }
```

1. 將Apache伺服器設定為指向新的子目錄。 部署設定可能大不相同。 以下是伺服器設定的範例：

```xml
   <VirtualHost *:80>
       DocumentRoot "magento_root/pub/shop1"
       ServerName shop01.com
   </VirtualHost>
```

**問題**：商家必須從管理員啟用Fastly Force TLS功能，才能為所有商店頁面啟用全域HTTP至HTTPS重新導向。 請參閱[將雲端上所有頁面的HTTP重新導向至HTTPS （強制TLS）](https://support.magento.com/hc/en-us/articles/360006296953)知識庫文章。<!-- MC-39988-->

**問題**：您無法在執行詳細目錄的多重存放區部署中，使用`addConfigurableProductToCart` GraphQL突變將可設定產品新增到非預設存放區檢視中的購物車。 （Luma店面不受影響。）應用程式顯示這個錯誤： `Could not add item to cart. Please check required options and try again`。 **因應措施**：改用`addProductsToCart`突變。 [GitHub-31660](https://github.com/magento/magento2/issues/31660)<!-- PWA-1298-->

**問題**：當購物者先在[付款]頁面的[驗證碼]欄位中輸入正確的程式碼時，應用程式未如預期提交付款資訊，但會顯示此錯誤： `There has been an error processing your request`。 只有當購物者嘗試下訂單而未輸入驗證碼或輸入錯誤時，才會發生這種情況。  **因應措施**：重新整理頁面。<!-- MC-40506-->

**問題**：當購物者按一下&#x200B;**使用Venmo**&#x200B;付款，但未在Admin中建立訂單時，應用程式會在Braintree中建立訂單。 **因應措施**：無。 請參閱[2.4.2已知問題： Braintree Venmo付款無法運作](https://support.magento.com/hc/en-us/articles/360054662652/)知識庫文章。 <!-- BUNDLE-2894-->

### B2B已知問題

**問題**： B2B購買者可以使用線上付款方式，略過一般的採購單流程。 如果買家將結帳總數減少到0 （例如，透過促銷代碼或禮品卡），然後移除代碼或禮品卡，就可能發生這種情況。 即使在這些條件下，應用程式仍會根據指定目錄中的專案價格，下達正確金額的訂單。 **因應措施**：啟用線上付款方式以核准採購單時，請停用禮品卡與優惠券代碼。<!-- B2B-1603-->

**問題**：當買家嘗試使用PayPal Express Checkout從採購單下訂單時，**內容模式**&#x200B;已停用，系統會將買家重新導向至購物車。<!-- B2B-1604-->

**問題**：當採購員建立採購單，然後導覽至結帳頁面時，應用程式有時會顯示404錯誤。 當採購員先前使用線上付款方式建立不同的採購單，而未完成先前的採購就瀏覽至結帳頁面時，就會發生此錯誤。 採購員仍然可以下採購單。 **因應措施**：無。<!-- B2B-1605-->

**問題**：在採購單結帳期間，即使買方在最後結帳期間變更付款方式，特定付款方式的折扣仍會持續存在。 因此，客戶可能會獲得他們無權享有的折扣。 發生此狀況是因為儘管付款方式有所變更，原始付款方式的購物車規則仍會套用。 **因應措施**：無。 請參閱[2.4.2 B2B已知問題：付款方式變更後，線上採購單的折扣仍會保留](https://support.magento.com/hc/en-us/articles/360054667312)知識庫文章。<!-- B2B-1012 -->

**問題**： `deleteRequisitionListOutput`查詢傳回已刪除的請購單清單的詳細資料，而非其餘的請購單清單。<!-- MC-39894-->

## 社群貢獻

我們感謝更廣泛的Magento Open Source社群，並感謝他們為此版本所作出的貢獻。

社群工程團隊[Magento貢獻者](https://magento.biterg.io/app/kibana)會依月份、季度和年度維護最佳貢獻個人和合作夥伴的清單。 從該貢獻者頁面，您可以前往GitHub上的合併個人資料連結。

### 合作夥伴貢獻

下表重點說明合作夥伴所做的貢獻。 下表列出提出提取請求的合作夥伴、外部提取請求，以及與之相關聯的GitHub問題編號（若有）。

{{$include /help/_includes/release-notes/engcomm-2-4-2-partner.md}}

### 個人貢獻者

下表列出我們社群成員的貢獻。 此表格列出外部提取請求、與其相關聯的GitHub問題編號（如果有的話），以及提出提取請求的社群成員。

{{$include /help/_includes/release-notes/engcomm-2-4-2-issues.md}}

### 系統需求

我們的技術棧疊是以PHP和MySQL為基礎所建置。 如需詳細資訊，請參閱[系統需求](../../../installation/system-requirements.md)。

### 安裝和升級指示

您可以使用[撰寫器](../../../installation/composer.md)安裝Adobe Commerce 2.4.2。

## 移轉工具套件

資料移轉工具可協助將現有Magento 1.x存放區資料傳輸至Magento 2.x。此命令列介麵包含驗證、進度追蹤、記錄和測試功能。 如需安裝指示，請參閱[安裝資料移轉工具](../../../tools/data-migration-tool/install.md)。 請考慮探索或參與[資料移轉存放庫](https://github.com/magento/data-migration-tool)。

[程式碼移轉工具組](https://github.com/magento-commerce/code-migration)可協助將現有的Magento 1.x存放區擴充功能和自訂功能傳輸至Magento 2.x。命令列介麵包含轉換Magento 1.x模組和版面的指令碼。
