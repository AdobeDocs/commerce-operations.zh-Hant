---
title: Adobe Commerce 2.4.7-beta2發行說明
description: 瞭解2.4.7-beta2 Adobe Commerce版本的新功能、增強功能、錯誤修正和已知問題。
badgeCoreBeta: label="2.4.7測試版" type="informative"
exl-id: 6ceb1d6d-5076-49a1-925f-913aa3598c90
source-git-commit: 9a74f87e0da5a7f11cd0930c8265556d80e3d1de
workflow-type: tm+mt
source-wordcount: '13350'
ht-degree: 0%

---


# Adobe Commerce 2.4.7-beta2發行說明

>[!IMPORTANT]
>
>Beta版可能包含瑕疵，並依「原狀」提供，不含任何保固。 Adobe沒有義務維護、更正、更新、變更、修改或以其他方式支援(透過Adobe支援服務或其他方式)Beta版。 建議客戶謹慎使用，切勿依賴測試版和/或任何隨附檔案或資料的正確運作或效能。 因此，使用測試版完全由客戶自行承擔風險。

Adobe Commerce 2.4.7-beta2包含200多項品質修正和增強功能。 核心撰寫器相依性和協力廠商程式庫已升級至最新可用版本。

此版本提高GraphQL對自訂屬性和GraphQL解析器快取的涵蓋範圍。 此外，也推出對最近更新的FedEx和UPS服務的支援。

{{bics}}

## 其他發行資訊

雖然這些功能的程式碼已與Adobe Commerce核心程式碼的發行版本整合，但其中幾個專案(例如B2B、頁面產生器和Progressive Web Application(PWA) Studio)也獨立發行。 這些專案的錯誤修正記錄在每個專案檔案中提供的個別專案特定發行資訊中。

## Adobe Commerce 2.4.7-beta2

Adobe Commerce 2.4.7-beta2已針對下列元件版本進行測試：

* Apache 2.4
* Composer 2.5
* Elasticsearch8.7
* MariaDB 10.6
* MySQL 8.0
* OpenSearch 2.5
* PHP 8.2和8.1
* PHPUnit 9.x
* RabbitMQ 3.11
* Redis 7.0
* 亮漆7.3

我們的技術棧疊是以PHP和MySQL為基礎所建置。 另請參閱 [系統需求](https://experienceleague.adobe.com/docs/commerce-operations/installation-guide/system-requirements.html).


## Adobe Commerce 2.4.7重要功能

請檢視此版本中的下列重點專案。

### 安全性增強功能

Adobe Commerce 2.4.7-beta2推出十項安全性修正及平台安全性改善。 Adobe Commerce 2.4.7之前的測試版推出13項安全性修正及平台安全性改善。

目前尚未發生與這些問題相關的已確認攻擊。 但是，某些漏洞可能會被用來存取客戶資訊或接管管理員工作階段。 這些問題大多需要攻擊者先取得Admin的存取權。 因此，我們提醒您採取一切必要步驟來保護您的管理員，包括但不限於這些工作：

* IP允許清單
* [雙因素驗證](https://developer.adobe.com/commerce/testing/functional-testing-framework/two-factor-authentication/)
* 使用VPN
* 使用唯一位置，而非 `/admin`
* 良好的密碼衛生

另請參閱 [Adobe安全性公告](https://helpx.adobe.com/security/products/magento/apsb23-50.html) 以取得這些已修正問題的最新討論。

#### 其他安全性增強功能

此版本的安全性改善專案可改善對最新安全性最佳實務的合規性。

**2.4.7-beta2版新的安全性增強功能**

此發行版本引進新的全頁快取設定值，有助於降低與相關的風險。 `{BASE-URL}/page_cache/block/esi HTTP` 端點。 此端點支援來自Commerce配置控點和區塊結構的不受限制、動態載入的內容片段。 新的 **[!UICONTROL Handles Param]** 組態設定會設定此端點的值 `handles` 引數，決定每個API允許的最大控制代碼數量。 此屬性的預設值為100。 商家可以從管理員( **[!UICONTROL Stores]** > **[!UICONTROL Settings:Configuration]** > **[!UICONTROL System]** > **[!UICONTROL Full Page Cache]** > **[!UICONTROL Handles Param]** )。 另請參閱 [設定Commerce應用程式以使用Varnish](https://experienceleague.adobe.com/docs/commerce-operations/configuration-guide/cache/configure-varnish-commerce.html). <!-- AC-9113 -->

**2.4.7-beta1版本匯入的安全性重點專案**

* **透過REST和GraphQL API傳輸的付款資訊的原生費率限制**. 商戶現在可以設定使用REST和GraphQL傳輸之付款資訊的費率限制。 此新增的保護層可支援防止梳理攻擊，並可能會減少同時測試許多信用卡號碼的梳理攻擊的數量。 這是現有REST端點預設行為的變更。 另請參閱 [速率限制](https://developer.adobe.com/commerce/webapi/get-started/rate-limiting/).

* 的預設行為 [isEmailAvailable](https://developer.adobe.com/commerce/webapi/graphql/schema/customer/queries/is-email-available/) GraphQL查詢和([V1/customers/isEmailAvailable](https://adobe-commerce.redoc.ly/2.4.6-admin/tag/customersisEmailAvailable/#operation/PostV1CustomersIsEmailAvailable)) REST端點已變更。 依預設，API現在一律傳回true。 商家可以啟用原始行為，即 `true` 如果電子郵件不存在於資料庫中，並且 `false` 如果它存在。

### 平台增強功能

此版本的平台升級可改善對最新安全性最佳實務的合規性。

**2.4.7-beta2版的新平台增強功能**

下列平台元件已升級至2.4.7-beta2的最新版本：

* `allure-framework/allure-phpunit`  <!-- AC-8063 -->
* `colinmollenhour/cache-backend-file`  (1.4.5)  <!-- AC-8064 -->
* `colinmollenhour/cache-backend-redis` (1.16.0) <!-- AC-8065 -->
* `colinmollenhour/php-redis-session-abstract`  (1.5.1)  <!-- AC-8066 -->
* `dealerdirect/phpcodesniffer-composer-installer` (1.0.0) <!-- AC-8067 -->
* `jquery.ui.widget.js` (v1.13.2)  <!-- AC-9173 -->
* `squizlabs/php_codesniffer` <!-- AC-8070 -->
* `strip-json-comments library` <!-- AC-2783 -->
* `grunt` 相依性 <!-- AC-8097 -->
* `less js` 資料庫 <!-- AC-8098 -->
* `underscore.js` 資料庫 <!-- AC-8099 -->
* `jquery/bootstrap` 相依性 <!-- AC-9154 -->

NPM套件：

* `grunt` (1.6.1) <!-- AC-8072 -->
* `grunt-contrib-clean` (2.0.1) <!-- AC-8073 -->
* `grunt-contrib-less` (3.0.0) <!-- AC-8074 -->
* `grunt-eslint`  (24.0.1) <!-- AC-8075 -->

撰寫器相依性：

* `friendsofphp/php-cs-fixer` (3.22.0) <!-- AC-8087 -->
* `jquery/jstree` 相依性 <!-- AC-9131 -->
* `jquery` 相依性 <!-- AC-9132 -->
* `jquery/tinycolor` <!-- AC-9133 -->
* `laminas` 相依性套件 <!-- AC-8088 -->
* `magento/composer-dependency-version-audit-plugin` (0.1.5) <!-- AC-8087 -->
* `moment-timezone-with-data.js` <!-- AC-9130 -->
* `pdepend/pdepend`  (2.14.0) <!-- AC-8087 -->
* `pdepend/pdepend`  (2.14.0) <!-- AC-8087 -->
* `pdepend/pdepend`  (2.14.0) <!-- AC-8087 -->
* `pdepend/pdepend`  (2.14.0) <!-- AC-8087 -->
* `php-amqplib/php-amqplib` (3.5.4) <!-- AC-8087 -->
* `phpseclib/mcrypt_compat` (2.0.4) <!-- AC-8087 -->
* `symfony` 相依性套件  <!-- AC-8093 -->

**2.4.7-beta1中推出的平台增強功能**

* Composer 2.5.x.與Composer 2.2.x的相容性保持不變。

* **支援清漆快取7.3**. 此版本相容於最新版的Varnish Cache 7.3。6.0.x和7.2.x版本仍維持相容性，但我們建議僅將Adobe Commerce 2.4.7-beta2與Varnish Cache 7.3或6.0版LTS搭配使用。

* **RabbitMQ 3.11支援**. 此版本與最新版RabbitMQ 3.11相容。RabbitMQ 3.9仍支援相容性至2023年8月，但我們建議僅將Adobe Commerce 2.4.7-beta2與RabbitMQ 3.11搭配使用。

#### 其他升級和取代

Adobe Commerce 2.4.7-beta2推出這些平台升級：

* Commerce UPS XML API閘道已移轉至新的Commerce UPS REST API，以支援UPS對其進行的更新 [API安全性模型](https://developer.ups.com/oauth-developer-guide?loc=en_US&amp;sp_rid=NTA5MzQ1OTE2NjEyS0&amp;sp_mid=72989914). (UPS正在針對所有API實作OAuth 2.0安全性模型（持有人權杖）。)  所有先前的Commerce UPS XML API已從Adobe Commerce 2.4.7程式碼基底中移除。 <!-- AC-8918 -->

* Adobe Commerce與FedEx的整合已從舊版FedEx WSDL Web Services移轉至最新的FedEx RESTful API。 FedEx網站服務追蹤、地址驗證和驗證郵遞區號WSDLS將於2024年5月淘汰。 <!-- AC-1470 -->

* 新增對新USPS Ground Advantage送貨方法的支援。 這是與USPS的新配送方法USPS Ground Advantage （於2023年7月發行）的開箱即用整合。

  這項新整合可用於透過USPS配送服務擷取運費、排程交貨與退貨。 USPS Ground Advantage送貨方法取代這些在USPS Ground Advantage送貨方法發行時已淘汰的送貨方法：

   * USPS零售場
   * 第一級封裝服務
   * 包裹選取基底 <!-- AC-9182 -->

* Temando送貨模組已從核心Commerce程式碼基底中移除。 Adobe Commerce 2.4.4已棄用此功能。 <!-- AC-8130 -->

**2.4.7-beta1中推出的程式庫升級**

過時的JavaScript程式庫已升級至最新版本，包括：

* `moment.js` 資料庫(v2.29.4)
* `jQuery UI` 資料庫(v1.13.2)
* `jQuery` 驗證外掛程式庫(v1.19.5)

### 效能與擴充性增強功能

此版本大幅改善大型部署設定的儲存作業處理速度。

**2.4.7-beta2版的新增強功能**

* **REST現在支援JSON格式 [匯入API](https://developer.adobe.com/commerce/webapi/rest/modules/import/)**. 商戶現在可以每分鐘將最多100,000筆記錄匯入JSON格式的Adobe Commerce。 <!-- ACPT-943 -->

* **銷售規則效能改善**. 透過許多（約100,000個）有效的銷售規則，改善企業部署的效能。  大量實作促銷活動的企業部署通常會部署許多作用中的購物車規則。 在結帳操作期間，這些型別的企業部署執行Commerce 2.4.7時，不會看到任何與已設定購物車價格規則數量相關的效能降低。 <!-- ACPT-1198 -->

**2.4.7-beta1中推出的效能增強功能**

Adobe Commerce 2.4.7之前的測試版已推出：

* **針對許多商店的部署，更快速地儲存商店層級設定的作業**. 在擁有超過500個存放區的部署中儲存組態設定可能很耗時。 新的 [非同步設定](https://experienceleague.adobe.com/docs/commerce-operations/performance-best-practices/configuration.html?lang=en#asynchronous-configuration-save-2.4.7-beta1) 模組會透過執行使用取用者處理訊息佇列中的儲存作業的cron作業，來啟用非同步設定儲存作業。 AsyncConfig預設為停用。

* **加速產生大型設定的設定快取**. 此 `bin/magento cache:clean config` 命令現在會在啟用設定快取時，預先預熱設定快取。 這能縮短產生大型組態之設定快取所需的停機時間。 設定儲存作業不再清除 `config_scopes` 將資料寫入快取之前先快取快取，這也會縮短寫入設定資料時其他請求鎖定的時間。

### GraphQL API的應用程式伺服器

Commerce 2.4.7-beta2推出適用於GraphQL API的新PHP應用程式伺服器，並在Openswoole PHP架構上實作。 此應用程式伺服器可讓Adobe Commerce維持Commerce GraphQL API請求中的狀態，並免除啟動載入需求，進而提高所有GraphQL API的輸送量、降低延遲及有效使用資源。 透過在程式之間共用應用程式狀態，GraphQL API要求的效率大幅提高，而GraphQL API回應的速度平均可加快30%。

此 `ApplicationServer` 模組會實作PHP應用程式伺服器。 開發人員如果要在內部部署中實作此模組，也必須安裝並設定Swoole和Nginx。 使用Adobe Commerce進行雲端基礎結構專案的開發人員不需要下載這些元件，因為基礎結構已包含Nginx和OpenSwool。 雲端開發人員必須手動啟用應用程式伺服器，且無法像其他服務一樣啟動或停止模組。 必須重新部署Adobe Commerce才能啟動或停止模組，而這需要網站停機時間。

另請參閱 [GraphQL API的應用程式伺服器](https://experienceleague.adobe.com/docs/commerce-operations/performance-best-practices/performance-best-practices/application-server.html) 適用於內部部署和雲端部署。

這是適用於GraphQL API模組的PHP Application Server測試版。 包含自訂和擴充功能的部署可能與模組不相容。 啟用此模組的商家應準備好解決與已部署的自訂和擴充功能之間的潛在不相容問題。 <!-- ACPT-27 -->

### Adobe Commerce擴充功能中繼資料

此發行版本推出Adobe Commerce擴充功能中繼套件v2.0.0-beta2，這會自動將特定Adobe Commerce擴充功能與此核心版本整合。 此中繼套件中包含的這些擴充功能版本，會在下列情況下安裝： `composer update` 會執行，在升級至最新核心版本時，可簡化升級這些擴充功能的程式。 這些擴充功能會維護獨立的發行排程。

Adobe Commerce 2.4.7-beta2的Adobe Commerce擴充功能中繼資料包含下列擴充功能：

* [Adobe Commerce的Adobe I/O事件](https://developer.adobe.com/commerce/extensibility/events/)
* [付款服務](https://experienceleague.adobe.com/docs/commerce-merchant-services/payment-services/guide-overview.html)
* [Adobe Commerce管理員UI SDK](https://developer.adobe.com/commerce/extensibility/admin-ui-sdk/)

Commerce 2.4.7-beta1中包含的Bolt checkout擴充功能已從此Beta版中移除。

此擴充功能中繼資料包的未來版本可能包含其他擴充功能。

### B2B

此版本已與B2B 1.4.2封裝。它僅包含錯誤修正，儘管隨Adobe Commerce 2.4.6-beta2封裝的PHP應用程式伺服器版本引入B2B GraphQL API的涵蓋範圍。

**2.4.7-beta1中推出的B2B增強功能**

Adobe Commerce 2.4.7-beta1包含B2B議價報價、REST API更新以及多項錯誤修正的新功能和增強功能。

* **賣方起始的報價**. B2B銷售代表現在可以直接從「管理員」中的「報價單」與「客戶」網格啟動報價單。 另請參閱 [詢價](https://experienceleague.adobe.com/docs/commerce-admin/b2b/quotes/quote-request.html)

* **明細專案折扣**. 折扣現在可套用為報價內特定明細專案的百分比折扣、固定值或延伸訂價。

* **報價單上的備註交換**. 在議價過程中，B2B買方和賣方現在可以直接新增備註至報價單。 附註建立和更新會包含在明細專案與報價單歷史記錄中，以取得透明度。 另請參閱 [交涉報價](https://experienceleague.adobe.com/docs/commerce-admin/b2b/quotes/quote-price-negotiation.html).

* **已改善報價詳細資料檢視**. 檢視報價詳細資料頁面時，賣家和買方現在可以透過SKU或從產品目錄新增專案、新增或編輯附註、套用明細專案折扣，以及直接從報價詳細資料頁面存取產品組態。

* REST和GraphQL的更新

   * 新增端點，以提供本發行版本中介紹之賣家起始報價功能的網頁API涵蓋範圍。 另請參閱 [管理可協商的報價](https://developer.adobe.com/commerce/webapi/rest/b2b/negotiable-manage/)： `POST /V1/negotiableQuote/draft`.

   * 針對共用目錄提供的店面功能包含增強的網頁API涵蓋範圍，包括指派和重設自訂價格動作的新端點： `POST /V1/sharedCatalog/:sharedCatalogId/assignTierPrices` 和 `POST /V1/sharedCatalog/:sharedCatalogId/resetTierPrices`.

如需Commerce B2B的REST和GraphQL API涵蓋範圍詳細資訊，請參閱 [Commerce Web API](https://developer.adobe.com/commerce/webapi/) 開發人員檔案。 另請參閱 [B2B發行說明](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html) 以取得錯誤修正說明。

### GraphQL

**2.4.7-beta2版新的GraphQL增強功能**

此發行版本引入了對解析器快取的支援，並擴展了對自訂客戶屬性快取的支援。

* 下列GraphQL查詢解析器現在可在GraphQL解析器結果快取中快取，以改進隨POST請求提交查詢時的效能：

   * `Magento\CustomerGraphQl\Model\Resolver\Customer::resolve`
   * `Magento\CustomerGraphQl\Model\Resolver\CustomerAddress::resolve`
   * `Magento\CustomerGraphQl\Model\Resolver\IsSubscribed::resolve` <!-- B2B-2658 -->
   * `Magento\CatalogGraphQl\Model\Resolver\Product\MediaGallery::resolve` <!-- B2B-2677 -->

* 已新增訂單取消的GraphQL支援。 此 `cancelOrder` 突變可讓客戶取消訂單，傳遞其識別碼和取消原因。 <!-- LYNX-197 -->

* 已新增 `order_cancellation_enabled` 和 `order_cancellation_reasons.description` 回應欄位至 `storeConfig`
查詢以支援使用者起始的訂單取消請求。 另請參閱 [查詢商店的訂單取消設定](https://developer-stage.adobe.com/commerce/webapi/graphql/schema/store/queries/store-config/#query-a-stores-order-cancellation-configuration)

* 已將下列欄位新增至 `setBillingAddressOnCart` 和 `setShippingAddressesOnCart` 變異：

   * `fax`
   * `middlename`
   * `prefix`
   * `suffix`

**2.4.7-beta1中引入的GraphQL增強功能**

此版本新增增強的GraphQL快取功能，並對自訂屬性的GraphQL結構描述提供支援，包括：

* **增強對自訂屬性的支援**. GraphQL已透過豐富API資料來支援所有屬性型別，進而增強自訂屬性支援。 GraphQL EAV屬性方案現在支援在管理員中擴充客戶屬性和客戶位址物件，以及使用GraphQL擷取它們。 特定的增強功能包括： <!-- LYNX-61 110-->

   * 擴充/新增自訂屬性對特定領域的支援，例如客戶和客戶地址
   * 新增自訂屬性的快取
   * 增強產品的現有自訂屬性支援

* **增強的GraphQL快取功能可改善頁面載入速度**. 快取功能已新增到這些查詢，改善了大部分PWA頁面的頁面載入時間速度：

      * [可用商店](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/available-stores/)
      * [國家](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/countries/)和[國家](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/country/)
      * [storeConfig](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/store-config/)
      * [currency](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/currency/)
      * [customAttributeMetadata](https://developer.adobe.com/commerce/webapi/graphql-api/index.html#query-customAttributeMetadata)
  
* 已新增 `quickorder_active` 欄位至 [storeConfig](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/store-config/) 和 [availableStores](https://developer.adobe.com/commerce/webapi/graphql/schema/store/queries/available-stores/) 查詢。 此欄位指出是否啟用快速訂購功能。


* 透過減少每個請求呼叫剖析方法的次數，GraphQL剖析器的效能已有所改善。 現在只呼叫一次。 之前，至少呼叫過剖析器三次。

#### 新查詢

* [attributeForms](https://developer.adobe.com/commerce/webapi/graphql/schema/attributes/queries/attributes-form/) <!-- LYNX-151 -->
* [attributeList](https://developer.adobe.com/commerce/webapi/graphql/schema/attributes/queries/attributes-list/)<!-- LYNX-150 -->
* [cancelerorder](https://developer.adobe.com/commerce/webapi/graphql/schema/orders/mutations/cancel-order/) <!-- LYNX-172 -->
* [customAttributeMetadataV2](https://developer.adobe.com/commerce/webapi/graphql/schema/attributes/queries/custom-attribute-metadata-v2/)

#### 已棄用的查詢

* [attributeMetadata](https://developer.adobe.com/commerce/webapi/graphql/schema/attributes/queries/attributes-metadata/)
* [customAttributeMetadata](https://developer.adobe.com/commerce/webapi/graphql/schema/attributes/queries/custom-attribute-metadata/)

### 付款

此發行版本引進了對以下付款方式的存放式付款的支援：

* ApplePay  <!-- BUNDLE-3246 -->
* GooglePay  <!-- BUNDLE-3270 -->
* PayPal點數  <!-- BUNDLE-3272 -->

此發行版本也包含對這些付款方法的支援：

* UnionPay卡與Braintree卡付款 <!-- BUNDLE-3268 -->
* GooglePay搭配3D安全付款 <!-- BUNDLE-3271 -->

### 頁面產生器

Page Builder v.1.7.4與Adobe Commerce 2.4.7-beta2相容。

### PWA Studio

PWA Studio v.13.3.x與Adobe Commerce 2.4.7-beta2相容。 其中包含多項改善協助工具的增強功能。 如需有關錯誤修正的資訊，請參閱 [PWA Studio版本](https://github.com/magento/pwa-studio/releases). 另請參閱 [版本相容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 以取得PWA Studio版本及其相容Adobe Commerce核心版本的清單。

## 已修正的問題

我們已修正Adobe Commerce 2.4.7-beta2核心程式碼中的數百個問題。 此版本中包含的已修正問題子集說明如下。 也說明Commerce 2.4.7-beta1中的修正。

### 安裝、升級、部署

<!-- ACP2E-2198 -->

* `/bin/magento setup:install` 現在在以下時間後成功完成： `app/etc/config.php` 已刪除。 之前，在安裝期間不會重新產生遺失的檔案，且Commerce擲回錯誤。 [GitHub-37805](https://github.com/magento/magento2/issues/37805)


<!-- AC-8381 -->

* `bin/magento setup:upgrade` 已重構為在安裝同時安裝表格和相關聯的新模組時成功執行 `mview` 索引子。 [GitHub-37304](https://github.com/magento/magento2/issues/37304)

<!-- ACP2E-1882 -->

* 資料庫還原不再因分隔符號錯誤而失敗。 以前，Commerce在以下情況下拋出此錯誤： `bin/magento setup: rollback --db` 已執行： `Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'delimiter' at line 1, query was: delimiter ;;`.

<!-- ACP2E-1505 -->

* 此 `bin/magento setup:upgrade` 命令不再失敗，因為發生此型別的MySQL記憶體限制相關錯誤： `PHP Fatal error:  Allowed memory size of 4294967296 bytes exhausted (tried to allocate 20480 bytes)`. 多選屬性移轉已經過最佳化，以節省期間使用的記憶體 `setup:upgrade`.

<!-- ACP2E-1751 -->

* 現在，從管理員和命令列產生資料庫備份後，可如預期般運作。 之前，Adobe Commerce擲回此錯誤： `Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'delimiter' at line 1, query was: delimiter ;;`.

<!-- ACP2E-1604 -->

* 執行中 `setup:config:set` 而不指定 `--lock-db-prefix` 引數不再拭除目前的值 `env.php` 檔案。

<!-- ACP2E-1498 -->

* 清漆設定已更新，以防止訪客使用者存取與其他客戶群組相關的快取內容。

<!-- AC-7113 -->

* 購物者現在可以在實作分割資料庫的部署中下訂單，當 **[!UICONTROL Checkout Async]** 已啟用。 之前，Adobe Commerce擲回此錯誤： `An error occurred on the server. Please try to place the order again`.

<!-- https://github.com/magento/magento2/pull/33092 -->

* `bin/magento setup:upgrade` 現在安裝同時安裝表格和相關聯的新模組時可順利完成 `mview` 索引子。

<!-- ENGCOM-9243 -->

* `bin/magento setup:upgrade` 現在，當訊息佇列主題不包含主題名稱時，會顯示資訊更豐富的錯誤訊息。 [GitHub-34246](https://github.com/magento/magento2/issues/34246)

<!-- https://github.com/magento/magento2/pull/36239 -->

* `bin/magento setup:upgrade` 現在，當合併的XML檔案無效時，會顯示資訊更豐富的錯誤訊息。 錯誤訊息現在包含檔案名稱。

### Analytics

<!-- AC-9275 -->

* 收入報表現在會在Google Analytics (GA4)入口網站中如預期般顯示。 [GitHub-37605](https://github.com/magento/magento2/issues/37605)

<!-- ACP2E-1880 -->

* `price` 和 `quantity` Google Tag Manager資料層中的值現在會如預期般傳送給Google Analytics。 以前，這些值會以字串形式傳送。

<!-- ACP2E-2030 -->

* 當傳送部署資料到new relic模組時處理標頭資料的錯誤已解決。

<!-- ACP2E-1833 -->

* 透過啟用Google標籤管理器 **[!UICONTROL Configuration]** > **[!UICONTROL Sales]** > **[!UICONTROL Google API]** > **[!UICONTROL Google Analytics]** 執行Google Chrome擴充功能開發人員工具時，現在觸發GA Analytics 3標籤不會在產品詳細資料頁面中觸發。

### 橫幅

<!-- ACP2E-1818 -->

* 已重構橫幅內容載入方式，以移除過多的資料庫查詢，進而改善購物車載入時間。

### 套裝產品

<!-- ACP2E-1650 -->

* 修正使用時發生的錯誤 `POST V1/shipment` 端點，以建立包含套件組合產品的出貨。 端點現在會如預期新增專案，且不再傳回此錯誤： `The shipment couldn't be saved`.

<!-- ACP2E-1926 -->

* 您現在可以儲存套件組合產品的排程更新，該套件組合產品包含一個具有無限排程更新的簡單產品。 建立套件組合產品快照時，連結的產品現在會被ID、實體ID以及SKU擷取。 先前，儲存套件產品的排程更新時，會檢查簡單產品的原始版本，而非簡單產品的目前版本。

<!-- ACP2E-1650 -->

* 您現在可以使用 `GET V1/shipment/` API路由，當產品具有 **[!UICONTROL together]** 出貨型態集。 套件組合產品現在也會根據其出貨型別屬性進行驗證。

<!-- ACP2E-2038 -->

* 購物者現在可以編輯店面購物車中捆綁產品的數量。 之前，Adobe Commerce不會處理null值 `ItemId` 在店面購物車中編輯產品並顯示此錯誤時： [GitHub-37696](https://github.com/magento/magento2/issues/37696)

<!-- ACP2E-1801 -->

* 現在，您可以使用包含斜線(`/`)個字元。 之前，管理員使用者無法使用此方法將產品新增至管理員訂單，且Commerce擲回JavaScript錯誤。

<!-- ACP2E-1799 -->

* 管理員使用者現在可以在以下情況下，為新增的套件組合選項設定十進位預設值： **[!UICONTROL Qty Uses Decimal]** 會針對對應的簡單產品啟用。 以前，只能為儲存的選取專案設定小數值。

<!-- ACP2E-1347 -->

* 針對儲存具有大量選項的套件組合產品而最佳化的效能

<!-- ACP2E-1478 -->

* 套件組合產品現在無需在產品選項中複製SKU即可成功匯入。 之前，當您匯入含有重複專案的套件產品時，Adobe Commerce會在產品選項中建立多個重複的SKU。

<!-- ACP2E-1388 -->

* 現在，當套件中的其中一個產品無存貨時，即可正確計算套件組合產品價格。 先前，如果屬於該套裝一部份的產品無庫存，則會從價格計算中移除該產品。

<!-- ACP2E-1503 -->

* 現在，當最後一個必要的子產品已購買時，套裝產品會顯示為無庫存。 以前，當簡單的產品無庫存時，店面上的捆綁產品會顯示為有庫存。

<!-- ACP2E-1443 -->

* 使用將套件組合產品與非必要選項新增至購物車時出現效能問題 `addBundleProductsToCart` 變異已解決。

<!-- ACP2E-1264 -->

* 此 `categoryList` 查詢現在會傳回所有套件組合選項，當 **[!UICONTROL Show out-of-stock products]** 已啟用組態設定。 以往，無庫存選項不會納入查詢回應中。

<!-- ACP2E-1345 -->

* 套件組合產品建立方式 `POST V1/products` 現在於目錄價格範圍設定為時成功 `website`. 以前，發生完整性限制違規。 [GitHub-35595](https://github.com/magento/magento2/issues/35595)

### 快取

<!-- ACP2E-2070 -->

* 現在瀏覽網站後，登入後的快取Cookie會相同。 先前，登入控制器傳送了錯誤的快取Cookie，而頁面可能已快取多次。

<!-- ACP2E-1840 -->

* 在包含CMS區塊的CMS頁面上，來自GraphQLGET作業的回應現在會如預期般在Fastly快取中清除。 後續的排程更新現在會顯示這些頁面的正確更新內容。

<!-- ACP2E-1524 -->

* 當父產品的其中一個子產品已從「管理員」中儲存時，父產品的頁面快取現在會如預期般清除。 已引入外掛程式檢查，以針對可配置變體（類似於其他產品型別）讓快取失效，無論索引子狀態（已排程或即時）為何。 以前，從管理員更新可設定的變數後，店面價格沒有正確更新。

<!-- ACP2E-1454 -->

* 新增AWS憑證的快取機制。 認證提供者現在會使用Magento快取來快取從AWS擷取的認證，以進行EC2設定。

<!-- AC-7639 -->

* 外掛程式的用途是在儲存與可設定產品相關聯的簡單產品時新增可設定快取標籤，現在可如預期運作。 當簡單產品由更新時，所有相關的可設定快取標籤都會如預期移除 `POST V1/products`. 之前，並非所有價格都會在店面更新，而且快取必須手動清除。 [GitHub-36726](https://github.com/magento/magento2/issues/36726)

### 購物車與結帳

<!-- AC-9340 -->

* 將訂單運送至多個地址時，區域ID處理期間不會再觸發錯誤。

<!-- AC-8853 -->

* 在購物車層級套用的固定折扣金額現在是正確的。[GitHub-37496](https://github.com/magento/magento2/issues/37496)

<!-- AC-2044 -->

* 現在，當購物者在選取固定運費送貨方式（其送貨方式設定為條件的購物車價格規則適用）後套用優惠券時，優惠券將成功套用至訂單。 以前，購物車頁面顯示「優惠券無效」錯誤，且未套用優惠券。 [GitHub-34866](https://github.com/magento/magento2/issues/34866)

<!-- AC-8596 -->

* 此 **[!UICONTROL My billing and shipping address are the same]** 當購物者使用Chrome自動完成填寫其送貨地址然後按一下時，核取方塊現在預設保持勾選狀態 **下一個** 重新載入送貨方法區塊之前。 [GitHub-33725](https://github.com/magento/magento2/issues/33725)

<!-- ACP2E-2005 -->

* 此 `applied_rule_ids` 中的值 `quote_item` 表格現在包含已套用規則ID的正確清單。 過去，此值僅包含最後套用的規則ID。

<!-- ACP2E-2025 -->

* 現在當工作階段從伺服器移除時，會重設本機儲存空間中的迷你購物車和客戶資料。 先前，移除工作階段檔案時，此資料仍會顯示。

<!-- ACP2E-1763 -->

* 啟用永久購物車時，不再錯誤地從管理員合併分散式購物車。

<!-- ACP2E-1988 -->

* 結帳出貨步驟中的預設出貨地址不再填入先前選取的店內取貨地址。

<!-- ACP2E-1614 -->

* 快取清除後，購物車中的產品不再從相關和追加銷售產品清單中排除。

<!-- ACP2E-1580 -->

* 購物車稅和運送估算程式現在會正確反映預設目的地設定。 先前，當您設定預設稅捐目的地計算設定並指定州/地區和ZIP時，購物車下方僅會顯示ZIP值 **[!UICONTROL Estimate Tax and Shipping]**. 這是因為在從管理員叫用設定預設區域ID的條件陳述式之前，Adobe Commerce將區域ID設定為undefined 。

<!-- ACP2E-1547 -->

* 啟用永久購物車時，Adobe Commerce在結帳期間不再擲回此錯誤： `Invalid state change requested`. 先前，擲回此錯誤時，有多份訂單具有相同的 `quote_id` 偶爾會建立。

<!-- ACP2E-1456 -->

* 迷你購物車現在會顯示反映購物車稅務組態設定的套裝產品價格。 之前，迷你購物車一律會將稅金納入套裝產品的價格中。

<!-- ACP2E-1414 -->

* 已改善依賴作用中購物車的客戶區段規則的效能，這減少了將產品新增到購物車所需的時間。

<!-- AC-7503 -->

* 從購物車頁面提供的運費估計現在準確。 `collectShippingRates` 現在僅設定一次。 先前是重複送貨預估。 [GitHub-36648](https://github.com/magento/magento2/issues/36648)

<!-- ACP2E-1417 -->

* 此 `cart` 指定購物車中的產品無存貨時，查詢不再傳回錯誤。 以往，使用此查詢進行購買的購物者，在專案無庫存，且結帳頁面為空白時，無法完成購買。

<!-- ACP2E-1459 -->

* 訪客API請求至 `POST V1/guest-carts/<cartId>/shipping-information` 不再傳回 `cancel` 如果頁面在登入行動環境期間重新載入，則為狀態。 之前，Adobe Commerce擲回500錯誤並記錄此例外狀況： `TypeError: Argument 2 passed to Magento\CustomerCustomAttributes\Model\Plugin\ProcessCustomerShippingAddressCustomAttributes::beforeSaveAddressInformation() must be of the type string, null given`.

<!-- AC-7886 -->

* 免費送貨資格現在會依照預期計算，當 **[!UICONTROL Subtotal (Excl. Tax)]** 已套用購物車規則的條件。 [GitHub-36760](https://github.com/magento/magento2/issues/36760)

<!-- AC-6672 -->

* 此 `cart` query現在會傳回產品的正確層級定價。 [GitHub-29655](https://github.com/magento/magento2/issues/29655)

<!-- ACP2E-1162 -->

* 已將資訊性錯誤訊息新增至結帳頁面，以在出貨頁面上套用優惠券與所選出貨方法衝突時引導購物者。 之前，系統會傳送一條訊息要求購物者返回上一頁。

<!-- ENGCOM-8387 -->

* 驗證快顯視窗現在僅在需要時初始化，而非在啟用訪客簽出時。 現在，當訪客購物者嘗試繼續結帳，且訪客結帳停用時，它會初始化。 [GitHub-30672](https://github.com/magento/magento2/issues/30672)

### 購物車價格規則

<!-- ACP2E-2029 -->

* 此 `If an item is FOUND/NOT FOUND in the cart with ALL/ANY of these conditions true` 目錄價格規則條件現在可正確搭配類別和SKU屬性運作。 之前，此條件未正確套用至購物車價格優惠券邏輯，且無效的優惠券套用至訂單。 [GitHub-37660](https://github.com/magento/magento2/issues/37660)

<!-- ACP2E-1932 -->

* 您現在可以使用成功儲存新的購物車價格規則 `Magento_OfflineShipping` 擴充功能已停用。 之前，Adobe Commerce擲回此錯誤： `[2023-05-09T00:49:34.666107+00:00] report.ERROR: Warning: Undefined array key "simple_free_shipping" in /Users/npuchko/www/l3/mem/magento24i3/app/code/Magento/SalesRule/Controller/Adminhtml/Promo/Quote/Save.php on line 67 [] []`. [GitHub-37580](https://github.com/magento/magento2/issues/37580)

<!-- ACP2E-1516 -->

* 當為商店設定與一種運送方式相關的購物車價格規則，且在結帳期間此運送方式變更為另一種時，購物車價格規則現在會依預期套用。 先前， `applied_rule_ids` 值從未在 `sales_order_item` 資料表，且購物車價格規則未套用至訂單。

### 目錄

<!-- ACP2E-2043 -->

* 當產品庫存狀態根據庫存組態（數量）自動更新為無庫存，庫存狀態隨後將在庫存數量更新時更新為庫存。 先前， `stock_status_changed_auto` 產品的庫存設定更新為庫存時，會忽略設定。

<!-- AC-8904 -->

* 工具列排序現在可在搜尋頁面上如預期運作，當 **[!UICONTROL Remember Category Pagination]** 設定已啟用。 [GitHub-33220](https://github.com/magento/magento2/issues/33220)

<!-- ACP2E-1640 -->

* 現在多選屬性會如預期儲存，當 **[!UICONTROL Use Default Value]** 已選取存放區檢視範圍中的核取方塊。 先前，編輯產品並儲存預設值時，取消勾選此核取方塊會取消勾選。

<!-- ACP2E-1878 -->

* 具有網站限制存取權的管理員使用者現在可以將影像新增至其範圍內的產品。 如果管理員使用者沒有產品的存取權，Commerce會顯示資訊訊息。 以前，具有網站限制存取權的管理員使用者無法將影像新增至他們有權存取的產品。

<!-- ACP2E-1956 -->

* 使用者定義 `special_from_date`， `special_to_date`， `news_from_date`、和 `news_to_date` 在存放區檢視範圍內編輯產品時不會覆寫值。

<!-- AC-6761 -->

* 現在，在「管理員>」中依名稱排序產品後，Commerce會顯示正確的名稱 **[!UICONTROL Category]** > **[!UICONTROL Products in category]** 產品名稱會因商店而異的多商店部署中。 [GitHub-36208](https://github.com/magento/magento2/issues/36208)

<!-- ACP2E-1975 -->

* 此 `addProductsToCart` 突變現在會傳回包含資料的可自訂選項。 以前只傳回空白的可自訂選項。 [GitHub-37599](https://github.com/magento/magento2/issues/37599)

<!-- ACP2E-1859 -->

* 當管理員使用者在清除快取但未重新載入類別頁面後將新產品新增到類別時，產品位置和ID選擇現在會正確顯示。 以前，產品位置和選擇內容不相符，且顯示不正確。

<!-- ACP2E-1779 -->

* 商戶現在可以更新可下載產品未來開始日期或排程變更時間。 之前，Adobe Commerce在可下載產品未來開始日期或時間的更新期間擲回此錯誤： `The downloadable link isn't related to the product. Verify the link and try again`.

<!-- ACP2E-1943 -->

* 現在，店面可正確顯示產品延期交貨狀態。 以前，可供出貨的產品被錯誤地識別為延期交貨。

<!-- ACP2E-1948 -->

* 從管理員存取可下載的產品不再會導致錯誤，當管理員使用者將商店檢視從產品建立期間使用的檢視變更為另一個商店檢視。 現在，當管理員使用者將商店檢視從所有商店檢視切換為預設商店檢視時，產品價格已成功轉換為浮點數。 之前，Adobe Commerce擲回錯誤。 [GitHub-37519](https://github.com/magento/magento2/issues/37519)

<!-- ACP2E-1994 -->

* 匯出的產品現在具有正確的值 `manage_stock` 值，當 `use_config_manage_stock` 值等於 `1`. 之前，此預設值不正確。

<!-- ACP2E-1479 -->

* 當您儲存使用自訂選項建立的產品時（在刪除其影像後），Adobe Commerce不再顯示警告訊息。

<!-- ACP2E-1419 -->

* 當產品重新補充庫存時，所傳送的產品庫存警示電子郵件現在會如預期般顯示產品縮圖影像。 以前，此影像不會顯示在警報電子郵件中

<!-- AC-3003 -->

* 類別樹狀結構中的產品計數（管理員） **[!UICONTROL Catalog]** > **[!UICONTROL Category]**)現在準確。 之前，無法從 `catalog_category_product_index` 表格。 已修正觸發此錯誤的錯字。 [GitHub-35417](https://github.com/magento/magento2/issues/35417)

<!-- ACP2E-1239 -->

* 產品詳細資料頁面上的主要產品影像在頁面載入期間不再明顯向下移轉，當 `product_image_white_borders` 佈景主題中 `view.xml` 已停用。 之前，由於Fotorama JS中的高度設定不正確，產品影像在頁面載入期間會明顯向下位移。

<!-- ACP2E-1361 -->

* 客戶訂閱降價警示時，現在會收到產品價格下降的通知。 以往，由於應用程式層級的快取，系統不會一律傳送降價通知。

<!-- ACP2E-1422 -->

* 透過網頁API建立產品屬性的程式已新增伺服器端驗證。 您無法啟用 **[!UICONTROL Use in Layered Navigation Catalog]** 欄位當 **[!UICONTROL Catalog Input Type for Store Owner]** 欄位值為 `Text Field`，  `Text Area`，  `Text Editor`， `Date`，或 `Date and Time`. 以前，類別和搜尋結果中會忽略產品。

<!-- ACP2E-1413 -->

* 現在，當購物者開啟頁面、變更分頁、導覽至產品頁面，然後返回類別頁面後，類別頁面會以正確的分頁重新載入。  [GitHub-36563](https://github.com/magento/magento2/issues/36563)

<!-- ACP2E-1334 -->

* 沒有庫存的簡單產品如果是可供設定之產品的選項，現在會在下列情況下，在店面顯示為停用 **[!UICONTROL Display Out of Stock Products]** 設為 **是**. 以前，所有選項都會顯示為可用，無論其狀態和實際可用性為何。

<!-- ACP2E-1384 -->

* 更新特定存放區檢視中的網站範圍屬性，不再覆寫全域範圍中該屬性的值。 先前，當同一SKU和可使用多個資料列時匯入產品價格 `store_view_code` 導致預設和所有存放區檢視範圍的價格不正確。

<!-- ACP2E-1632 -->

* 商戶現在可以從Admin將GIF影像新增至產品的影像庫。 Adobe Commerce之前會顯示此錯誤：  `imagecolorsforindex(): Argument #2 ($color) is out of range`.

<!-- ACP2E-1709 -->

* 已新增檢查以處理未定義陣列索引鍵造成的錯誤。 先前，產生宣告式結構描述白名單時發生錯誤。

<!-- ACP2E-1749 -->

* Adobe Commerce現在會傳回自訂日期的有效結果 `01/01/1970`. 以前，自訂屬性傳回此錯誤： `Invalid input datetime format of value '1/01/1970`. [GitHub-37274](https://github.com/magento/magento2/issues/37274)

<!-- AC-6507 -->

* `routes` 使用片段的查詢現在會如預期傳回類別資訊。 之前，類別頁面上發生內部伺服器錯誤。 [GitHub-35906](https://github.com/magento/magento2/issues/35906)

<!-- ACP2E-1772 -->

* 的問題 `cataloginventory_stock` 部分重新索引程式已解決，且索引器效能已改善。 以前，庫存和產品類別無法準確更新。

<!-- AC-8226 -->

* Adobe Commerce現在會在產品所屬的類別已移至新父項時，為產品產生301重新導向。 [GitHub-37039](https://github.com/magento/magento2/issues/37039)

### 目錄規則

<!-- ACP2E-1834 -->

* 現在當由排程更新啟用時，目錄規則可正確索引。 因此，現在可以正確產生折扣價格並編制索引。 先前，如果有兩個目錄規則可用，且在第一個規則的目錄規則索引作業完成之前，於第一個規則之後啟動一個規則時，系統不會為第二個目錄規則產生目錄規則折扣價格。

<!-- ACP2E-1579 -->

* 現在，目錄規則可如預期般套用於多網站環境。

### 可設定的產品

<!-- ACP2E-2003 -->

* 排程更新停用一個子產品時，不再將具有兩個子產品的可設定產品標示為無庫存。 這是2.4.7-beta1的已知問題。

<!-- AC-8060 -->

* 針對具有多個選項之可設定產品，其儲存操作的效能已有所改善。 以前，在產品儲存操作期間可能會發生逾時。 [GitHub-36928](https://github.com/magento/magento2/issues/36928)

<!-- ACP2E-1764 -->

* 當購物者選取產品選項時，可設定產品價格的店面顯示現在會如預期變更。 [GitHub-37378](https://github.com/magento/magento2/issues/37378)

### 優惠券

<!-- ACP2E-1551 -->

* 購物者現在可以使用由相同購物車價格規則產生的兩個個別自動產生優惠券代碼。 此 `Uses per Coupon` 現在於已選取優惠券型別時啟用欄位 `Auto` (與抵用券型別類似=`Specific Coupon`) 。 如此一來，購物者便可套用多個優惠券代碼至相同的購物車價格（若代碼不同）。

<!-- ACP2E-1496 -->

* 現在，當購物者的單次使用優惠券套用至的訂單取消時，其單次使用優惠券值會如預期般還原。

<!-- ACP2E-1195 -->

* 此 `GET V1/coupons/<couponId>` 端點現在會傳回手動建立之優惠券的完整預期回應，就像自動產生優惠券一樣。  以前會忽略一些欄位(例如 `usage_limit`， `usage_per_customer`、和 `created_at`)。

### cron

<!-- AC-9207 -->

* 修正cron運算式中除以零的嚴重錯誤。 [GitHub-37804](https://github.com/magento/magento2/issues/37804)

<!-- ACP2E-1792 -->

* 此 `sales_clean_quotes` 透過新增複合索引，cron流程已最佳化以更快執行。 `store_id` 和 `updated_at columns` 在報價表中。 這項變更可改善處理許多報價時的cron工作效能。

<!-- AC-7987 -->

* 管理員使用者現在可以檢視 `bin/magento cron:run` 處理目前正在執行。 目前執行中的程式標題現在會列出群組和工作名稱。 [GitHub-34321](https://github.com/magento/magento2/issues/34321)

### 客戶

<!-- AC-6748 -->

* Adobe Commerce現在顯示 **[!UICONTROL Date of Birth]**， **[!UICONTROL Tax/VAT Number]**， **[!UICONTROL Gender]**， **[!UICONTROL Telephone]**， **[!UICONTROL Company]**、和 **[!UICONTROL Fax]** 根據組態設定在「編輯客戶」頁面上的欄位。 [GitHub-36196](https://github.com/magento/magento2/issues/36196)

### 電子郵件

<!-- ACP2E-2018 -->

* 對於具有自訂影像選項的產品，影像選項不再顯示為「傳回客戶電子郵件」（預設範本）中的HTML標籤。

<!-- ACP2E-1529 -->

* 現在會如預期儲存公司管理員詳細資料，而且當指派公司管理員電子郵件包含 `CMS Block URL` 變數中。

<!-- AC-2903 -->

* 客戶電子郵件地址現在可以包含變音符號。 以前，前端驗證禁止在電子郵件地址中建立變音符號的使用者。 [GitHub-12075](https://github.com/magento/magento2/issues/12075)

<!-- ACP2E-1682 -->

* 庫存和價格警示電子郵件現在會根據為網站預設商店檢視設定的語言進行翻譯。 以前，這些電子郵件不會翻譯。

<!-- ACP2E-1571 -->

* `POST V1/order/notify-orders-are-ready-for-pickup` 現在會傳送電子郵件，提醒客戶訂單已準備好提貨。 現在僅當無一例外履行請求時，才會觸發電子郵件。

### 框架

<!-- ACP2E-1999 -->

* `bin/magento config:show` 和 `set` 使用的命令 `$_ENV` 變數現在支援使用包含駝峰字或大寫字元的網站和商店程式碼。

<!-- AC-8923 -->

* 新增的類別具有  `!important` 如用於Tailwind 3以支援CSS版面。 [GitHub-37568](https://github.com/magento/magento2/issues/37568)

<!-- AC-9115 -->

* 遺失 `jQuery` 相依性已新增至 `trim-input.js` 檔案。 [GitHub-37683](https://github.com/magento/magento2/issues/37683)

<!-- AC-9387 -->

* 事件特定詳細資料現在會作為第二個屬性傳遞(`context`的) `log` 方法。 [GitHub-37879](https://github.com/magento/magento2/issues/37879)

<!-- AC-9109 -->

* 外觀比例值已新增至目錄影像，且已從UI架構中移除不必要的指令碼。 [GitHub-37691](https://github.com/magento/magento2/issues/37691)

<!-- AC-9188 -->

* 修訂無效XML設定所觸發的錯誤訊息，以提供更多資訊。 [GitHub-37788](https://github.com/magento/magento2/issues/37788)

<!-- AC-9335 8817-->

* 已重構的已棄用程式碼，與在整個程式碼基底中建立動態屬性有關。

<!-- AC-7009 -->

* 對於擁有極活躍產品資料庫的大型商店，索引器的效能已有所改善。 索引器現在會為每個索引編制一次最新產品資訊的索引，而非多次。 以前，產品會從網站上消失，而網站上的產品資料可能會過期。 [GitHub-30012](https://github.com/magento/magento2/issues/30012)

<!-- ACP2E-1971 -->

* `mview_state` 現在，當從屬資料庫連線可用時，記錄狀態會根據變更記錄檔活動準確地指出狀態。 之前，這些記錄會保留在 `waiting` 即使changelog中沒有新專案，雲端部署中的狀態。

<!-- ACP2E-2022 -->

* 新增對 `precision` 貨幣格式的選項，用於保留與已棄用的同位功能 `ZendCurrency` 類別。

<!-- AC-8854 -->

* Cookie訊息已轉換為可觀察屬性，開發人員現在可以控制狀態，這可能會觸發UI變更。 之前，Cookie是唯讀狀態且無法操控。 [GitHub-37308](https://github.com/magento/magento2/issues/37308)

<!-- AC-6325 -->

* 管理員使用者現在可以在其Commerce執行個體連線至S3儲存空間時產生發票。 以前，Commerce會顯示此錯誤： `Cannot create image resource. File not found`. [GitHub-35706](https://github.com/magento/magento2/issues/35706)

<!-- AC-6906 -->

* 當VIES驗證服務進行VAT編號驗證失敗時，Adobe Commerce現在會如預期記錄例外訊息。 [GitHub-36065](https://github.com/magento/magento2/issues/36065)

<!-- AC-8146 -->

* 此 `Administrators` 在建立管理員角色期間，名稱已從用來擷取管理員角色的查詢中移除。 [GitHub-36998](https://github.com/magento/magento2/issues/36998)

<!-- AC-8607 -->

* 此 `bin/magento setup:config:set` 當無效的資料庫使用者名稱包含在時，命令不再失敗 `app/etc/env.php` 檔案。 [GitHub-37409](https://github.com/magento/magento2/issues/37409)

<!-- AC-8595 -->

* 依預設管理員UI元件中保留文字的欄排序時，不再導致以下專案出現SQL錯誤： `var/log/exception.log`. [GitHub-37423](https://github.com/magento/magento2/issues/37423)

<!-- AC-8562 -->

* 已新增 `AddDataForCostaRica.php` 為哥斯大黎加提供國家資訊。 [GitHub-37382](https://github.com/magento/magento2/issues/37382).

<!-- AC-8577 -->

* 改善使用者嘗試從管理員存取無效URL的案例的錯誤訊息。 [GitHub-35682](https://github.com/magento/magento2/issues/35682).

<!-- ACP2E-1841 -->

* `Param $options[`position`]` 貨幣符號現在可如預期運作，並支援自訂貨幣符號位置。 先前，從Zend Framework 1移轉之後， `toCurrency` 方法已忽略 `position` 引數。 此問題在整個管理員介面中發生。

<!-- AC-8817 -->

* 已重構的已棄用程式碼，與在整個程式碼基底中建立動態屬性有關。

<!-- AC-8154 -->

* 透過在Adobe Commerce中擴充TinyMCE編輯器和2.4.6之前的Magento Open Source版本所建立的自訂樣式格式，現在可如預期在Page Builder中使用 `text` 內容型別。 以前會忽略自訂樣式格式，而且只有在升級至Adobe Commerce 2.4.6-p1後才會載入預設格式。 [GitHub-36950](https://github.com/magento/magento2/issues/36950)

<!-- AC-8576 -->

* 已將下列資訊性附註新增至 `quote.php` 檔案： `Important: This method also copies customer data to quote and removes quote addresses`. [GitHub-37400](https://github.com/magento/magento2/issues/37400)


<!-- ACP2E-1973 -->

* 鎖定提供者的例項化現在會完成 `\Magento\Framework\Lock\Proxy` 類別。 鎖定提供者現在已設定為 `lock` 透過 `app/etc/env.php` 檔案。

<!-- ACP2E-1492 -->

* 已對訂單實作Mutex，以防止在並行請求更新期間出現競爭條件。 以前，訂單取消的並行請求（競爭條件）會導致 `inventory_reservation` 表格。

<!-- ACP2E-1381 -->

* 此 `populateWithArray` 函式現在將物件屬性正確轉換為Snake大小寫，使其與 `AbstractModel` getter和setter。 先前，當資料屬性名稱連續包含數個大寫字母時，Snake大小寫格式不正確。

<!-- ACP2E-1522 -->

* 中的自動增量值 `catalog_product_entity_varchar` 現在表格會在儲存產品後正確增加。 以前此值會增加十。

<!-- ACP2E-1701 -->

* 當您嘗試清除JavaScript/CSS快取時，Adobe Commerce不再擲回此檔案系統例外狀況：  `No such file or directory`.

<!-- ACP2E-1358 -->

* 的值 `value_id` 在 `customer_entity_int` 現在已正確增加。 會執行更新查詢，而不是 `insert on duplicate key update` 更新合併這些屬性的實體時。 因此，EAV模型中使用的自動增加欄現在會以線性方式增加。 先前，欄的自動遞增程式會略過由於失敗的插入查詢而略過的值。 [GitHub-28387](https://github.com/magento/magento2/issues/28387)

<!-- AC-8462 -->

* 移除不必要的空白字元 `id` 不需要的屬性。 (此錯誤是由Adobe Commerce 2.4.6程式碼變更所造成。)

<!-- AC-7923 -->

* 當存放區處於單一存放區模式時，存放區代碼不再出現在存放區URL中。 [GitHub-36831](https://github.com/magento/magento2/issues/36831)

<!-- AC-7988 -->

* 已進行微幅更新 `around` 外掛程式。 [GitHub-31443](https://github.com/magento/magento2/issues/31443)

<!-- AC-7989 -->

* 色票 `Helper` 已重構為移除誤導性的匯入別名。 [GitHub-31373](https://github.com/magento/magento2/issues/31373)

<!-- AC-8708 -->

* 管理員使用者現在可以刪除或重新命名 `sitemap.xml` 檔案（如預期）。 以前，管理員使用者可以從管理員中刪除檔案，但檔案會保留在檔案系統中。  [GitHub-37468](https://github.com/magento/magento2/issues/37468)

<!-- ACP2E-1747 -->

* 當已套用優惠券的訂單付款失敗時，不再將優惠券標示為已使用。 佇列訊息現在會依消費者啟動時的發佈順序進行處理。 先前，系統會從佇列中提取第一個訊息，僅檢查訊息是否已加入佇列，之後系統會拒絕第一個訊息，導致第一個訊息最後經過處理。

<!-- ACP2E-1627 -->

* 當使用者嘗試列印出貨標籤時，Adobe Commerce不會再在記錄檔中擲回例外狀況。 先前，如果擴充功能修改包含附件的回應標頭，系統會在記錄檔中擲回例外狀況。

<!-- AC-7986 -->

* 已新增對更多HTML類別的支援 `elements.xsd`. [GitHub-36891](https://github.com/magento/magento2/issues/36891)


### 一般修正

<!-- AC-8823 -->

* 密碼現在會如預期顯示，當 **[!UICONTROL Show Password]** 「登入」頁面上的核取方塊為作用中。


<!-- ACP2E-2037 -->

* 客戶實體(`rp_token`)驗證功能在建立客戶帳戶期間已從屬性驗證中移除，且變音符號驗證僅包含在產生的客戶電子郵件中。 以前，Commerce不會儲存客戶記錄並顯示此錯誤： `Something went wrong while saving the customer`.

<!-- AC-8826 -->

* 刪除欄之後，您現在可以成功將編輯儲存至「管理頁面」和「區塊」格線。 [GitHub-37525](https://github.com/magento/magento2/issues/37525)

<!-- ACP2E-1933 -->

* 公司管理員現在可以從店面新增公司使用者。 以前，當管理員使用者嘗試新增使用者時，Commerce會記錄此錯誤： `report.CRITICAL: Error: Call to a member function __toArray() on null in app/code/Magento/LoginAsCustomerLogging/Observer/LogSaveCustomerObserver.php:123`.

<!-- ACP2E-1972 -->

* 客戶現在可以在其他裝置上重設密碼後，使用新密碼從一部裝置成功登入。

<!-- ACP2E-1609 -->

* 管理員客戶地址 **州/省** 欄位現在會如預期保留上次儲存的值。 先前，當您從此欄位移除值時，Commerce會繼續在 **州/省** 欄位。 [GitHub-36846](https://github.com/magento/magento2/issues/36846)

<!-- ACP2E-1796 -->

* 當您取消選取然後選取新建立的CMS頁面時，Adobe Commerce不再擲回違反限制錯誤。

<!-- ACP2E-1639 -->

* 階層網站根目錄現在會正確指派給新建立的CMS頁面。 之前，階層網站根目錄選擇在新建立的CMS頁面上是不相符的。

<!-- ACP2E-1508 -->

* 在以下情況下請求類別的RSS摘要期間不再發生錯誤： **[!UICONTROL RSS Feed Top Level Category]** 已啟用。 之前，瀏覽RSS摘要類別頁面會導致Elasticsearch `CRITICAL` 發生下列情況時，記錄檔中發生錯誤： **[!UICONTROL RSS Feed Top Level Category]** 已啟用。

<!-- ACP2E-1490 -->

* 現在已儲存正確的值 `gws_store_groups` 使用者角色建立期間角色範圍變更時。 先前，當角色範圍選取為 `All`，則 `gws_store_groups` 值在使用者建立期間儲存為Null，但在角色編輯期間則未儲存。 此外，如果角色範圍被選取為 `Custom`，然後 `gws_store_groups` 值一律儲存為null。

<!-- ACP2E-1446 -->

* 現在，在下列情況下，按一下管理員登入頁面上的管理員重設密碼連結，即可存取重設密碼頁面： **[!UICONTROL Add Store Code to Urls]** 設定已啟用。 管理員重設密碼連結先前會開啟登入頁面或404頁面。

<!-- ACP2E-1274 -->

* 現在，管理員統計儀表板中的日期範圍會根據組態設定中所設定的時區進行計算，然後轉換為UTC以便從資料庫擷取資料。

<!-- ACP2E-1665 -->

* CMS階層篩選在您篩選存放區檢視，然後按一下 **[!UICONTROL Save]** 在管理員上 **[!UICONTROL Content]** > **[!UICONTROL Hierarchy]**. 先前，按一下 **[!UICONTROL Save]** 已重新整理頁面，但內容已遺失，且選取的存放區檢視不再顯示。

<!-- ACP2E-1631 -->

* 按一下 **[!UICONTROL Send invitation]** 按鈕（管理員） **[!UICONTROL Marketing]** > **[!UICONTROL Private sales]**  > **[!UICONTROL Invitation]**)現在會連同表單金鑰一起提交POST要求，並成功傳送邀請。 之前，當您按一下此按鈕時，HTTPPOST方法和表單索引鍵都不會出現。

<!-- ACP2E-1608 -->

* 現在可以使用AWS S3成功將零位元組檔案複製到遠端儲存體。

<!-- AC-7402 -->

* 現在，當為其他網站（其商店ID與網站ID不符）建立該客戶時，管理員使用者可以從管理員新增客戶地址。 Adobe Commerce先前會顯示此快顯訊息： `Something went wrong`. [GitHub-36582](https://github.com/magento/magento2/issues/36582)

<!-- AC-8247 -->

* CMS區塊編輯器頁面現在會顯示正確的Widget `block_id` 值。  [GitHub-29644](https://github.com/magento/magento2/issues/29644)

### 禮品卡與包裝

<!-- AC-7372 -->

* 商家無法再建立負值的禮品卡。

<!-- ACP2E-1890 1806-->

* 此 `setGiftOptionsOnCart` 突變現在會如預期從訂單中移除贈品包裝。  的值 `gift_wrapping_id` 現在已在購物車層級取消設定。 先前， `gift_wrapping_id` 已更新至下訂單後的先前值，即使已在購物車層級取消設定此值。

<!-- ACP2E-1866 -->

* 當從套用禮品卡的訂單處理簡單產品的部分退款時，禮品卡帳戶現在會如預期保持有效。 先前已刪除禮卡帳戶。

<!-- ACP2E-1805 -->

* 此 `setGiftOptionsOnCart` 現在當從購物車移除禮品訊息時，突變可成功更新資料庫。 以前，資料庫中未更新訊息詳細資料，而且禮品訊息未從購物車中移除。

<!-- ACP2E-1741 -->

* 贈品登入 `Event Information` 標籤現在會如預期般翻譯。

<!-- ACP2E-1586 -->

* 現在可以正確計算自訂禮卡金額的小計。

<!-- ACP2E-1350 -->

* 現在，在多個地址結帳時，可正確套用禮品卡。 以前，多地址出貨的禮品卡金額套用不正確，導致禮品卡金額無效。

<!-- ACP2E-1341 -->

* 模擬現在於以下期間開始： `send()` 模擬完成時呼叫 `getInfoBlockHtml()` 呼叫，且不會記錄任何錯誤。 先前， `system.log` 檔案已因下列錯誤而泛濫： `main.ERROR: Environment emulation nesting is not allowed`. [GitHub-35603](https://github.com/magento/magento2/issues/35603)

<!-- ACP2E-1612 -->

* 您現在可以使用 `updateCartItems` 變異以更新購物車中的禮品卡。 之前，只有卡片數量可以透過此突變更新購物車中。

<!-- ACP2E-1669 -->

* 贈品包裝現在已如預期納入以合併購物車為基礎的報價中。 先前已順利合併贈品訊息，但並未包裝選取專案。

<!-- AC-7530 -->

* 此 `addProductsToCart` 突變現在已成功將禮品卡新增到購物車。 以前，此查詢需要禮品卡收件者名稱，但會傳回寄件者名稱。 Adobe Commerce擲回此錯誤： `Please specify a recipient name`. [GitHub-36665](https://github.com/magento/magento2/issues/36665)

### Google ReCAPTCHA

<!-- ACP2E-1539 -->

* 結帳工作流程中的Google reCAPTCHA現在可如預期般用於支票、匯票和自訂付款方法。

<!-- ACP2E-1311 -->

* 在Adobe Commerce ReCAPTCHA核取方塊載入之前，無法再提交Google表單。

<!-- ACP2E-1338 -->

* reCAPTCHA Widget現在位於 **[!UICONTROL Place Order]** 付款頁面上的按鈕。 過去，Widget會顯示在頁面頂端。

### Google Tag Manager

<!-- ACP2E-1520 -->

* Google標籤模組現在會將正確的資料推送至資料層。 以前，頁面曝光資料不會推送至資料層。

### GraphQL

<!-- AC-8623 -->

* GraphQL程式庫元件的位址錯誤處理現在可如預期運作。

<!-- AC-9058 -->

* 此 `products` 當「動態訂價」設為「否」且套用折扣時，「查詢」現在會傳回所有相關店面訂價明細。 以前不會傳回產品的價格範圍。 [GitHub-35649](https://github.com/magento/magento2/issues/35649)

<!-- ACP2E-1744 -->

* GraphQL交易名稱現在僅包含在New Relic記錄檔中的最上層查詢名稱。 以前，交易名稱還包括次要查詢名稱。

<!-- AC-8623 -->

* GraphQL程式庫元件的位址錯誤處理現在可如預期運作。

<!-- AC-7430 -->

* 當產品的「可見性」設定設為 `Catalog`， `products` 對該產品的查詢現在可以正確解析設定。 之前，提供的任何篩選器都會切換至 `Visibility: Catalog` 設定。 [GitHub-36591](https://github.com/magento/magento2/issues/36591)

<!-- ACP2E-1769 -->

* 此 `customer` 查詢現在會傳回 `product_sale_price` 當產品價格已設定為包含稅捐時，包含訂單稅捐的欄位。 [GitHub-36946](https://github.com/magento/magento2/issues/36946)

<!-- ACP2E-1584 -->

* 型別的產品屬性 `DateTime` 現在將對應至 `FilterRangeTypeInput` 在產品查詢中篩選。 以前，這些屬性對應至 `FilterMatchTypeInput`. 由於此變更，查詢將篩選於 `DateTime` 屬性需要 `from` 和 `to` 值而非相符的值。

<!-- ACP2E-1552 -->

* 此 `customer` query現在會依商店ID篩選時，如預期，只傳回與特定商店檢視相關的客戶評論。

<!-- AC-7544 -->

* 此 `categories` 查詢不再傳回錯誤，當 `items.redirect_code` 回應值包含null值。 [GitHub-36675](https://github.com/magento/magento2/issues/36675)

<!-- ACP2E-1465 -->

* 在完全清除快取後，規則型相關產品現在會在GraphQL回應中如預期般載入。 先前，負責規則型比對的產品EAV屬性不會為請求的實體載入，不過這些屬性會在重新載入店面產品頁面後載入。

<!-- ACP2E-1486 -->

* 此 `changeCustomerPassword` 在成功重設密碼後，突變現在會如預期觸發電子郵件。

<!-- ACP2E-1494 -->

* `urlResolver` 和 `route` 現在，當以下情況時，查詢會傳回結果： `Target Path` 的URL重寫是絕對URL。 先前， `urlResolver` 當您使用查詢來擷取重新導向資料時，查詢傳回NULL。

<!-- AC-7979 -->

* 此 `products` 當存在多個商店檢視時，query現在會傳回正確的標籤。 [GitHub-29635](https://github.com/magento/magento2/issues/29635)

<!-- ACP2E-1315 -->

* 此 `categoryList` 查詢現在會傳回已填入的 `product` 的區段 `options` 如預期封鎖捆綁產品的子產品。  之前，系統不會傳回任何有關套件組合產品子產品的資訊。

<!-- AC-7114 -->

* 此 `route` query現在會如預期傳回類別和產品的路由，而不會發生內部伺服器錯誤。 [GitHub-36544](https://github.com/magento/magento2/issues/36544)

<!-- ACP2E-1652 -->

* 此 `products` 查詢現在已擷取 `url_key` 選取多個類別時的值。

<!-- LYNX-17  16-->

* `product` 查詢現在只會傳回指派給指定共用目錄之產品的彙總。 以前，未指派給共用目錄之產品的彙總資料會出現在分層導覽中。

<!-- AC-6680 -->

* 此 `OptionValueProvider` 類別 `get()` 方法現在會根據指定的傳回屬性選項值 `option_id` 如預期。 之前，它會傳回錯誤。 [GitHub-35910](https://github.com/magento/magento2/issues/35910)

<!-- AC-6745 -->

* 此 `products` 查詢現在會傳回所有可用的彙總（篩選器）及其正確轉譯的標籤。 之前，價格和類別彙總標籤並未如預期般轉譯。 [GitHub-36140](https://github.com/magento/magento2/issues/36140)

<!-- AC-6666 -->

* 您現在可以使用片段 `ProductCard` 查詢時 `related_products`， `upsell_products`、和  `crosssell_products` 於 `ProductInterface`. [GitHub-29769](https://github.com/magento/magento2/issues/29769)

<!-- AC-7014 -->

* 此 `products` query現在會依照儲存順序，傳回相關的、向上銷售和交叉銷售產品。 [GitHub-36461](https://github.com/magento/magento2/issues/36461)

<!-- AC-8573 -->

* GraphQL查詢現在會傳回依位置排序的相關產品資料。 [GitHub-33010](https://github.com/magento/magento2/issues/33010)

<!-- AC-8542 -->

* `category_url_path` 已新增至 `ProductAttributeFilterInput`，可支援在單一查詢中要求某個類別的所有產品。 [GitHub-32460](https://github.com/magento/magento2/issues/32460)

<!-- AC-821 -->

* 修正了以下錯誤：設定GraphQL突變中目前存放區的方法在執行處理驗證的方法之前執行。 [GitHub-31336](https://github.com/magento/magento2/issues/31336)

### 影像

<!-- ACP2E-1353 -->

* 「管理員Favicon」圖示上傳表單現在支援 `.ico` 檔案型別。 [GitHub-34858](https://github.com/magento/magento2/issues/34858)

### 匯入/匯出

<!-- ACP2E-1930 -->

* 由於記憶體不足，產品匯入不再失敗。 先前，將任意數量的產品匯入已包含約一千萬個產品的資料庫時，會因為記憶體不足而失敗。

<!-- AC-9116 -->

* 當沒有有效的資料可匯入時，驗證檢查現在會如預期停止匯入程式，而Commerce現在會顯示此錯誤： `There are no valid rows to import`. 之前，驗證在這些條件下通過，但匯入程式失敗，並顯示以下訊息： `entity values are mixed`. [GitHub-32905](https://github.com/magento/magento2/issues/32905)

<!-- ACP2E-1754 -->

* 使用相同產品匯入URL金鑰不再覆寫或刪除現有的預設存放區檢視金鑰。 現在，只有當沒有覆寫時，才會為存放區檢視重新產生URL覆寫 `url_key` 值。 先前，使用相同URL金鑰匯入URL會覆寫現有的預設存放區檢視URL金鑰。 (    `key_store` URL重寫已刪除，但產品預設存放區檢視層級上的URL重寫仍設為 `key_store`.)

<!-- ACP2E-1875 -->

* 匯入期間，產品計數不再意外變更。 快取排清現在會延後，直到匯入程式之後。

<!-- ACP2E-1813 -->

* 已排程匯入動作的狀態現在能正確代表匯入作業的成敗。 過去，所有動作都會記錄為成功。

<!-- AC-7039 -->

* Commerce現在會考慮 **[!UICONTROL Disable Automatic Group Change Based on VAT ID]** 在匯入客戶記錄期間設定。 先前， `disable_auto_group_change` 已忽略匯入檔案中的值。 [GitHub-36409](https://github.com/magento/magento2/issues/36409)

<!-- AC-965 -->

* `Magento\Framework\Convert\Excel` 現在已成功處理前面有空格的數字。 Excel XML現在會將欄位編碼為 `String`. 之前，Excel編寫器會將這些值編碼為 `number`，導致檔案無效。 [GitHub-33422](https://github.com/magento/magento2/issues/33422)

<!-- ACP2E-1641 -->

* 商戶現在可以指定顯示匯入資料的區域設定，以及資料驗證器剖析此資料的方式。 如果未指定地區設定值，Adobe Commerce會使用預設設定地區設定（而非預設存放區檢視）來剖析資料。 在管理員中，匯入和匯出程式會繼續使用管理員使用者介面地區設定來分別匯入、剖析和格式化資料。

<!-- ACP2E-1847 -->

* 使用匯入產品 `country_of_manufacture` 由語言環境設定與匯入產品的管理員使用者不同的管理員使用者建立的屬性不會再擲回驗證錯誤。 以前，此匯入操作可能會導致 `country_of_manufacture` 屬性。

<!-- ACP2E-1981 -->

* 庫存來源資料現在由商店匯入程式成功匯入，Commerce現在會在匯入程式完成時顯示完整的通知訊息。 以前，缺少通知訊息。

<!-- ACP2E-1889 -->

* 當索引器處於排程模式時，已移除多餘的索引器失效。

<!-- ACP2E-1994 -->

* 匯出的產品現在具有正確的值 `manage_stock` 值，當 `use_config_manage_stock` 值等於 `1`. 之前，此預設值不正確。

<!-- ACP2E-1620 -->

* 在排定的匯入作業期間，如果影像未成功匯入，Adobe Commerce現在會在排定的匯入格線中顯示資訊性錯誤訊息。 以前不顯示錯誤訊息。

<!-- ACP2E-1565 -->

* 產品影像遺失時，產品匯入程式不再中斷。 先前，在使用CSV檔案匯入協力廠商服務期間遺失產品影像時，Adobe Commerce會顯示此錯誤： `Maximum error count has been reached or a system error is occurred!`.

<!-- ACP2E-1476 -->

* 啟用B2B的部署中，已改善從客戶網格匯出客戶的效能。

<!-- ACP2E-1391 -->

* 當中的屬性值時，產品匯入程式不再擲回驗證錯誤 `configurable_variations` 欄包含逗號。

<!-- ACP2E-1377 -->

* 已從匯出程式中排除解碼。 匯入後，CSV匯出檔案文字保持不變。 因此，重新匯入後，說明不會變更。 先前，產品匯出和匯入後，頁面產生器編輯器中的HTML標籤會遭到移除。

<!-- ACP2E-1451 -->

* 新增為環境變數的非預設設定（網站或存放區範圍）不再中斷 `app:config:import` 處理序發生遞回錯誤。

<!-- ACP2E-1569 -->

* 在匯入後，「儲存時更新」模式中的目錄搜尋和價格索引子不再失效。 先前，Elasticsearch索引器檔案版本會在新產品和現有產品匯入時變更版本。

<!-- ACP2E-1482 -->

* 產品報告現在會匯出至 `var` 目錄。  之前，這些報告會匯出至檔案根目錄，在雲端例項中為唯讀目錄。

<!-- ACP2E-1736 -->

* 清空的多重選取客戶位址列位不再中斷或停止匯出程式。

### 索引

<!-- AC-9223 -->

* 現在，所有索引器都使用相同的顏色來表示索引器狀態。 [GitHub-34648](https://github.com/magento/magento2/issues/34648)

<!-- ACP2E-1697 -->

* 在未將規則指派給所有網站的部署中，已改善目錄規則產品索引器的效能。

<!-- ACP2E-1401 -->

* 當索引子設定為時建立自訂產品型別 **[!UICONTROL Update on schedule]** 不再導致索引更新 `cron` 任務失敗。 [GitHub-36471](https://github.com/magento/magento2/issues/36471)

<!-- ACP2E-1574 -->

* 由於目錄許可權索引而導致的Storefront產品詳細資訊頁面上的顯示問題已解決。 之前，Adobe Commerce會先清除索引表格，然後在完整期間重新編列索引 `catalogpermissions_product` 或 `catalogpermissions_category` 索引過程。 在完成重新索引之前，目錄許可權在店面中無法如預期運作。

<!-- AC-6816 -->

* `bin/magento indexer:reindex customer_grid` 當客戶格線包含新建立的自訂客戶屬性時，不再因MySQL錯誤而失敗。 [GitHub-36233](https://github.com/magento/magento2/issues/36233)

<!-- AC-8076 -->

* 變更多個索引器的索引器模式（亦即，大量動作索引器模式變更）現在只會在目前模式與正在套用的模式不同時，變更索引器的模式。 這可防止不必要地前往資料庫，進而改善效能。 [GitHub-36823](https://github.com/magento/magento2/issues/36823)

### 基礎架構

<!-- AC-9390 -->

* 已取代MySQL `CREATE TEMPORARY TABLE ... LIKE` 已重構 `CREATE TEMPORARY TABLE` 以符合MySQL 8.x。 [GitHub-37926](https://github.com/magento/magento2/issues/37926)

<!-- ACP2E-1462 -->

* 當格式錯誤的HTTP請求傳送至伺服器時，Adobe Commerce不再於錯誤訊息中包含伺服器根目錄的完整路徑。 現在只有字串會傳遞至 `explode` 作為第二個引數的方法。

<!-- AC-8384 -->

* `restricted_classes.php` 已取代 `Zend_Validate_File_Upload`. 之前，在上傳大於中設定的值的匯入檔案時，驗證器會當機 `php.ini `. [GitHub-37281](https://github.com/magento/magento2/issues/37281)

<!-- ACP2E-1146 -->

* 由資料來源模型提供，並使用安裝資料修補程式（通常來自協力廠商模組）安裝的屬性選項，現在可用於客戶區段規則。 之前，此組合不會傳回符合設定區段的客戶清單。

<!-- AC-7093 -->

* 電子郵件範本引擎現在可以正確處理某些巢狀指令(例如 `{{if}}{{depend}}...{{/depend}}{{/if}}`)。 [GitHub-36438](https://github.com/magento/magento2/issues/36438)

<!-- AC-7920 -->

* `product` 具有彙總資料的查詢現在會傳回布林型別產品屬性的正確標籤值。 [GitHub-29123](https://github.com/magento/magento2/issues/29123)

<!-- https://github.com/magento/magento2/pull/29173 -->

* 合併時CSS檔案不再損毀， `var/tmp` 和 `pub/static` 位於不同的檔案系統和 **[!UICONTROL CSS Merging Enabled]** 已啟用。 暫存檔已經建立在與目標檔案相同的靜態目錄中，以確保兩個檔案都在相同的檔案系統上。 因此，將其重新命名的呼叫是原子性的。 [GitHub-29172](https://github.com/magento/magento2/issues/29172)

<!-- https://github.com/magento/magento2/pull/36769 -->

* 呼叫成員函式 `getId()` 不再觸發例外狀況。

<!-- https://github.com/magento/magento2/pull/34092 -->

* 設計主題設定處理器中的陣列型別現在會強制進行型別檢查。  [GitHub-34440](https://github.com/magento/magento2/issues/34440)

### 記錄

<!-- ACP2E-1788 -->

* 更新系統報告功能中的日期 — 時間格式，在報告中包含記錄檔的記錄。

<!-- ACP2E-1385 -->

* 管理員使用者現在可以在管理員的大量動作記錄區段中，檢視整合所建立的大量動作的記錄。

### 登入

<!-- ACP2E-1521 -->

* 在單一瀏覽器中重設密碼，接著透過不同瀏覽器登入時，不會再產生例外狀況。 [GitHub-36447](https://github.com/magento/magento2/issues/36447)

<!-- ACP2E-1332 -->

* 客戶現在會在如預期般啟動帳戶後，重新導向至登入頁面。 客戶之前會自動登入。

### 訂購

<!-- ACP2E-1918 -->

* 商戶現在可以針對包含部份料號且總計為零的訂單，產生銷退折讓單，而其他訂單料號可以退款。 以前，當客戶對訂單中的某些料號有100%折扣時，商家無法執行多重退款。

<!-- AC-8254 -->

* 從「管理員」重新排序子產品時，子產品與父產品之間的連結現在會顯示在訂購頁面上。 [GitHub-37028](https://github.com/magento/magento2/issues/37028)

<!-- AC-1756 -->

* 訂單頁面的表頭區段現在包含已傳送商業發票、銷退折讓單及出貨的預期資訊。 [GitHub-27474](https://github.com/magento/magento2/issues/27474)

<!-- AC-7632 -->

* 只包含一個可設定產品之訂單的銷退折讓單，現在可正確產生。 先前， `isLast()` 函式未傳回 `true` 如預期。 [GitHub-36722](https://github.com/magento/magento2/issues/36722)

<!-- ACP2E-1962 -->

* 當管理員使用者沒有客戶網站的許可權時，Adobe Commerce在建立含客戶餘額離線退款的銷退折讓單時，不再擲回錯誤。 之前，Adobe Commerce擲回此錯誤： `More permissions are needed to view this item`，且管理員使用者無法建立商店退款。

<!-- ACP2E-1714 -->

* 當針對包含搭售產品的訂單進行部分退款時，訂單狀態現在為正確。 以前，即使剩餘的訂單尚未完成，訂單狀態在發出部分退款後仍會列為完成。 [GitHub-37377](https://github.com/magento/magento2/issues/37377)

<!-- ACP2E-1514 -->

* 首次從管理員使用一次性自訂價格產生訂單時，購物者無法再使用自訂價格訂購產品。 以前，如果訂單包含具有自訂價格的專案，則此自訂價格會套用至具有再訂購功能的其他訂單。

<!-- ACP2E-1421 -->

* 購物者無法再於訂購頁面上儲存不正確的訂購狀態。 當料號出貨時，訂單狀態不再從「完成」變更為「處理」。 之前，Adobe Commerce在購物者輸入評論後，儲存訂單狀態之前不會檢查目前的訂單狀態。 [GitHub-36562](https://github.com/magento/magento2/issues/36562)

<!-- ACP2E-1387 -->

* 當傳回的可設定產品被刪除時，Adobe Commerce不會再在店面訂單退貨頁面上擲回錯誤。 Adobe Commerce先前曾記錄此錯誤： `report.CRITICAL: Error: Call to a member function getShipmentType() on null in magento2ee/app/code/Magento/Rma/view/frontend/templates/return/create.phtml:52`.

<!-- ACP2E-1367 -->

* 銷售訂單網格現在會如預期以非同步方式與所有訂單同步。 [GitHub-36562](https://github.com/magento/magento2/issues/36562)

<!-- ACP2E-1197 -->

* 訂單頁面的客戶訂單區段中的依購買日期篩選功能現在可如預期運作。 先前，當向方法提供相同時區時，時區轉換邏輯擲回錯誤，便會發生JavaScript錯誤。

<!-- ACP2E-1294 -->

* Adobe Commerce儀表板現在會在首次載入時顯示正確的訂單統計資料。 以前，儀表板顯示不正確的訂單資訊，但一旦更新時段，就會顯示正確的資訊。

<!-- ACP2E-1762 -->

* 管理員使用者在從管理員建立新訂單期間選取商店檢視後，現在會依預期重新導向至訂單頁面。

<!-- ACP2E-1418 -->

* 此 `GET V1/orders/<OrderID>` 端點現在會依順序傳回可設定和簡單產品的資訊，無論簡單產品的庫存狀態為何。 只有當選取的專案（產品）有庫存或可供銷售時，管理員使用者現在才能下訂單。 以前，此API只傳回已有產品的相關資訊。

<!-- AC-7901 -->

* 當出貨價格包含稅捐，且稅捐計算是在折扣後套用時，啟用免運費時，銷退折讓單頁面不再損毀。 之前，Adobe Commerce擲回 `Division by zero` 例外。 [GitHub-36800](https://github.com/magento/magento2/issues/36800)

<!-- AC-1342 -->

* 使用 `rest/V1/orders/{id}/comments` 端點在不提供訂單狀態的情況下張貼訂單相關註解，不再影響訂單的顯示。 之前，訂單狀態在 `sales_order` 和 `sales_order_grid` 表格，且「我的訂單」頁面或「管理訂單」格線皆未顯示訂單。 [GitHub-34180](https://github.com/magento/magento2/issues/34180)

<!-- ACP2E-1597 -->

* 現在，當商業發票、出貨及銷退折讓單所包含的識別碼與訂單識別碼不同時，就可以將商業發票、出貨及銷退折讓單連同其相關訂單一起成功移回封存。 先前，如果將訂單移至封存並還原，則若識別碼編號不符，則該訂單會遺漏商業發票、出貨、銷退折讓單記錄。 [GitHub-36847](https://github.com/magento/magento2/issues/36847)

### 頁面產生器

<!-- AC-9128 -->

* Chrome瀏覽器中頁面產生器儲存操作的效能已改善。

<!-- ACP2E-1954 -->

* 您現在可以在「管理員>」中使用頁面產生器選項 **[!UICONTROL Content]** > **[!UICONTROL Pages]** 若要在所有樣式中插入複製的文字，請使用 `text` 元素。  以前，頁面產生器只會顯示純文字，不會儲存樣式。

<!-- ACP2E-1646 -->

* 當管理員使用者具有特定ACL時，使用頁面產生器編輯產品內容期間不再出現CORS錯誤。 管理員使用者現在可以儲存產品。 以前，頁面產生器不會儲存產品，而且儲存程式會凍結。

<!-- ACP2E-1852 -->

* 在PageBuilder中，已上傳影像的影像預覽現在會包含精確的檔案大小資訊。

<!-- ACP2E-2016 -->

* 頁面產生器頁面元素現在在Chrome瀏覽器(v112)中以可接受的速度轉譯。 以前，在Chrome瀏覽器中執行PageBuilder來儲存內容的速度很慢，Commerce會在瀏覽器主控台中記錄此錯誤： `[ERROR] Page Builder was rendering for 5 seconds without releasing locks`.

<!-- ACP2E-1654 -->

* 頁面產生器視訊元素自動播放現在可在iOS上的行動Safari瀏覽器上如預期般運作，只要元素直接連結至遠端視訊檔案。 以前不顯示預覽影像。

<!-- ACP2E-1974 -->

* 頁面產生器現在可在Chrome瀏覽器中正常運作。 先前，在該瀏覽器中進行的內容變更並不一定都會儲存。

<!-- ACP2E-2086 -->

* 載入管理員產品編輯頁面時，產品不再會產生間歇性 `Uncaught TypeError` JavaScript錯誤。

<!-- ACP2E-1886 -->

* 透過Page Builder編輯器上傳的影像，現在會標籤為使用 **[!UICONTROL Content]** > **[!UICONTROL Media Gallery]**. 之前，這些影像標示為 **未在任何地方使用** 在「媒體集」中。

<!-- ACP2E-1564 -->

* 從「頁面產生器」轉盤新增產品至購物車時，不再重複來自頁面的專案數量，因為有兩個不同的Widget顯示相同的產品。

<!-- ACP2E-1542 -->

* 頁面產生器不再新增 `tabindex` 將屬性HTML至超連結標籤 `a` 當您編輯超連結時，請儲存範本。

<!-- ACP2E-1444 -->

* 產品Widget和頁面產生器預覽現在可正確處理HTML特殊字元。 之前，產品Widget無法正確顯示包含 `&` 字元。

<!-- ACP2E-1441 -->

* 當您在預覽模式中選取並更新完整內容區塊時，頁面產生器文字元素內容現在會如預期更新。

<!-- ACP2E-1362 -->

* 現在，從一個Page Builder文字編輯器複製文字並貼上文字到另一個編輯器可以如預期運作。 之前，您嘗試貼上文字的頁面無法儲存，且Adobe Commerce顯示此主控台錯誤： `[ERROR] Page Builder was rendering for 5 seconds without releasing locks.`.

<!-- ACP2E-1568 -->

* 頁面產生器 `column-block` 在舊版Page Builder中建立的內容型別現在可以正確顯示。

<!-- ACP2E-1234 -->

* 改善從管理員建立產品期間篩選產品中繼資料說明的功能。 以往，如果啟用「頁面產生器」，系統會根據預設值產生產品中繼資料說明` {{name}} {{description}}` 遮色片。 預設的產品中繼說明遮罩現在由以下專案組成 `{{name}}`. [GitHub-36107](https://github.com/magento/magento2/issues/36107)

<!-- ACP2E-1758 -->

* 新增不含內容的動態區塊不再觸發錯誤。

### 付款

<!-- AC-9142 -->

* PayPal Express結帳交易現在包含子產品SKU和完整產品標題。 此 `Magento/Paypal/Model/Cart.php` 檔案現在會收集具有父產品標題的子產品SKU，以識別具有子SKU的產品標題。 [GitHub-36808](https://github.com/magento/magento2/issues/36808)

<!-- ACP2E-1964 -->

* 此 **[!UICONTROL Card Security Code Does Not Match]** 組態設定現在會在Payflow Pro付款處理期間依預期處理。 以前，此評估流程永遠不會完成，這會阻止簽出。

<!-- ACP2E-1215 -->

* 當購物者沒有儲存庫權杖時，管理簽出工作流程中不再顯示儲存庫付款方法選項。 [GitHub-36273](https://github.com/magento/magento2/issues/36273)

<!-- ACP2E-1303 -->

* 此 **[!UICONTROL Venmo]** 啟用PayPal按鈕後，按鈕現在可以隱藏。 先前， **[!UICONTROL Venmo]** 按鈕無法從購物車、迷你購物車、產品詳細資料或結帳頁面中移除。

#### Braintree

<!-- BUNDLE-3273 -->

* 解決當本機付款啟用時，Ideal payments所支付訂單的遞補URL問題。

<!-- AC-2901 -->

* 現在，每個商店都會儲存Braintree付款資訊，而購物者現在只會看到儲存在商店中的卡片資訊。 過去，購物者在結帳時可以看到所有商店儲存的卡片資訊。 [GitHub-34253](https://github.com/magento/magento2/issues/34253)

<!-- BUNDLE-3304 -->

* 當卡付款的儲存庫停用時，購物者現在可以使用Braintree付款方式，將訂單出貨至多個地址。 [GitHub-37615](https://github.com/magento/magento2/issues/37615)

<!-- BUNDLE-3253 -->

* 購物者無法再建立PayPal訂單而不新增姓氏。

<!-- ACP2E-1229 -->

* 當購物者更新其帳單地址時，結帳工作流程中不再自動取消選取「Braintree儲存庫付款方式」選項。 以前，當購物者取消選取 **[!UICONTROL My billing and shipping address are the same]** 按鈕。

<!-- BUNDLE-3248 -->

* 解決從Adobe Commerce 2.4.5-p2升級後，透過Braintree與PayPal結帳的問題。 [GitHub-37242](https://github.com/magento/magento2/issues/37242)

<!-- BUNDLE-3257 -->

* 電話號碼現在會如預期般轉譯，並包含Google付款模式快顯送貨位址列位中的地址。 過去，您會遺漏電話號碼。

<!-- BUNDLE-3228 -->

* 現在，當Braintree回應包含空白值時，訂單可透過Braintree成功下達 `threeDSecureInfo/eciFlag`. 以前，當此值為空時，在簽出期間發生PHP錯誤。

<!-- BUNDLE-3243 -->

* 當購物者從迷你購物車結帳Adobe Commerce Pay時在訂單稽核頁面上套用優惠券時，Google不再擲回錯誤。 之前，購物者被重新導向至404頁。

<!-- BUNDLE-3245 -->

* 購物者現在可以使用Braintree支付和Adobe Commerce 2.4.6 （具有隱藏的ReCAPTCHA v2或v3）完成結帳。 [GitHub-37241](https://github.com/magento/magento2/issues/37241)

<!-- BUNDLE-3241 -->

* 購物者無法再按一下 **[!UICONTROL PayPal]** 按鈕來購買可設定的產品，而不需先選取必要的選項。 過去，購物者可按一下 **[!UICONTROL PayPal]** 按鈕，之後被重新導向回產品頁面，出現錯誤：

<!-- BUNDLE-3148 -->

* 此 **[!UICONTROL PayPal]** 按鈕現在會如預期顯示在購物車和迷你購物車頁面上。 之前，此按鈕不會顯示在購物車頁面上，且會在迷你購物車頁面上複製。

<!-- BUNDLE-3244 -->

* 部分開立商業發票的訂單現在會如預期擷取部署中正確帳戶的訂單，其中商戶在其Braintree帳戶中具有兩個相同貨幣的不同商戶帳戶ID。

<!-- BUNDLE-3250 -->

* 針對依Braintree支付的訂單建立第二張部份發票時，Adobe Commerce不再擲回錯誤，因為 **[!UICONTROL Enable Vault for Card Payments]** 已啟用。 先前，當商家嘗試建立第二張發票時，Adobe Commerce擲回此錯誤： `Your payment could not be taken. Please try again or use a different payment method. Payment method token is invalid`.

### 效能

<!-- ACP2E-2098 -->

* 的效能 `addProductToCart` 使用許多自訂產品屬性執行時的變異已有所改善。 先前，當此突變使用許多產品屬性（約1000）執行時，Commerce會嘗試載入所有產品屬性。

<!-- ACP2E-1965 -->

* 載入購物車規則使用的產品屬性時的效能問題已解決。 現在只會載入作用中購物車規則的產品屬性。

<!-- ACP2E-1864 -->

* 此 `bin/magento setup:perf:generate-fixtures setup/performance-toolkit/profiles/ee/small.xml` 現在，命令會在多次執行時成功執行。 之前，它會在執行多次時擲回此錯誤： `Coupon with the same code already exists`.

### 促銷活動

<!-- ACP2E-1290 -->

* 的影響 **[!UICONTROL Fixed amount discount for whole cart]** 價格規則，套用時 **[!UICONTROL Apply to shipping amount]** 規則，現在會依預期在產品與運費金額之間按比例分配。 過去，折扣計算方式不正確。

<!-- ACP2E-1300 -->

* 此 **[!UICONTROL Discard Subsequent Rules]** 設定現在會如預期套用。 啟用此設定時，其他低優先順序的規則只能套用至不同的產品。 [GitHub-35707](https://github.com/magento/magento2/issues/35707)

### 報表

<!-- ACP2E-1541 -->

* 訂單報表(**[!UICONTROL REPORTS]** > **[!UICONTROL Sales]** > **[!UICONTROL Orders]**)現在包含正確的訂單值，前提是使用非預設貨幣的商店產生訂單。 之前，此報表包含不正確的值。 [GitHub-36742](https://github.com/magento/magento2/issues/36742)

<!-- ACP2E-1477 -->

* 為了清楚起見，已修訂銷售訂單報表表單中的誤導性資訊。

<!-- ACP2E-1435 -->

* 管理員使用者現在可以搜尋含有以下內容的電子郵件記錄  `+` （加） 「放棄的購物車報告」頁面的符號。 [GitHub-36560](https://github.com/magento/magento2/issues/36560)

<!-- AC-7394 -->

* 從Commerce Admin停用GraphQL後，New Relic交易名稱現在會正確顯示。 [GitHub-36112](https://github.com/magento/magento2/issues/36112)

### 獎勵

<!-- ACP2E-1473 -->

* 獎勵點數餘額更新電子郵件通知現在會考量目前的商店內容。 以前，獎勵點數平衡更新電子郵件使用預設商店的組態設定。

<!-- ACP2E-1329 -->

* 現在建立銷退折讓單後，即可退還獎勵積分。 以前，商家無法在建立銷退折讓單後退款點數，且訂單狀態仍會保留 `Completed`，非 `Closed`.

### RMA

<!-- ACP2E-1230 -->

* 此 **[!UICONTROL Enable RMA]** 個別產品層級的屬性現在會遵循商店RMA設定組態。 以往，無論市集組態設定為何，當您新增產品時，這項設定都會預設為關閉。

### 搜尋 {#search-heading}

<!-- ACP2E-1870 -->

* 進階搜尋價格和SKU篩選器現在可在進階搜尋中一起套用時正常運作。 [GitHub-37581](https://github.com/magento/magento2/issues/37581)

<!-- ACP2E-1787 -->

* 不再對空白搜尋欄位執行搜尋。 這樣會縮減 `search_query` 表格。 以前，不正確的查詢或查詢空白的搜尋欄位會傳回巨大的資料集，這會增加 `search_query` 表格導致下列專案發生問題： `/tmp`.

<!-- ACP2E-1916 -->

* 現在，使用下拉式自訂屬性排序目錄專案時，店面篩選器可如預期運作。

<!-- ACP2E-1499 -->

* 搜尋結果現在會依預期的屬性搜尋權重來顯示相關結果。

<!-- AC-7505 -->

* 底下的資訊文字 `Search Weight` 屬性的 `Storefront Properties` 管理員的輸入欄位 **[!UICONTROL Stores]** > **[!UICONTROL Attributes]** > **[!UICONTROL Product]** 現在會說明可能的值。 [GitHub-36646](https://github.com/magento/magento2/issues/36675)

### 送貨

<!-- ACP2E-2044 -->

* 此 `cart` 查詢現在會傳回分散式出貨折扣，作為具有唯一折扣標籤的個別出貨折扣。 新的 `applied_to` 折扣屬性支援套用至購物車專案的折扣差異。 以前，所有運費折扣都會合併為一個硬式編碼 **[!UICONTROL Shipping Discount]** 值。

<!-- ACP2E-1826 -->

* 當管理員使用者建立重新訂購時，當管理員使用者按一下 **[!UICONTROL Reorder]** 按鈕（管理員） **[!UICONTROL Sales]** > **[!UICONTROL Orders]** > **[!UICONTROL View]** )。 如果購物者的通訊錄中儲存了相同的地址，則重新排序將一律納入這些地址的更新版本。 之前，送貨位址列位會預先填入更新的資料，但帳單位址列位則不會。

<!-- AC-7003 -->

* 此 **[!UICONTROL Shipping Policy]** 出現下列情況時，文字方塊現在會顯示在「管理商店檢視」範圍內  **[!UICONTROL Apply custom Shipping Policy]** 已啟用，並且有自訂送貨原則可用。 [GitHub-36425](https://github.com/magento/magento2/issues/36425)

<!-- AC-7550 -->

* 此 `cart` 查詢現在會傳回 `selected_shipping_method` 符合下列任一專案的值： `available_shipping_methods` 電信業者和方法代碼。 先前，當其中一個選取的送貨方法包含底線時，這些電信業者/方法代碼會不相符。 [GitHub-36606](https://github.com/magento/magento2/issues/36606)

<!-- AC-2556 -->

* 此 `setShippingAddressesOnCart` 當street陣列中的第二個值為null時，突變不會再擲回錯誤。 之前，系統擲回此例外狀況： `The address failed to save. Verify the address and try again`. [GitHub-35160](https://github.com/magento/magento2/issues/35160)


### Sitemap

<!-- AC-2465 -->

* XML Sitemap現在在多層部署中可如預期般運作。 先前，網站地圖不包含每個存放區指派的預設頁面。 [GitHub-35001](https://github.com/magento/magento2/issues/35001)

<!-- AC-2267 -->

* 商戶現在可以在網站建立並儲存產品 `id != 1` 且已啟用單一存放區模式。 之前，儲存動作失敗並顯示以下訊息： `SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails`. [GitHub-35009](https://github.com/magento/magento2/issues/35009)

### 分段

<!-- ACP2E-1923 -->

* 在排程更新購物車價格規則後，商店檢視標籤值不再清除。以前，即使未在更新中指定這些標籤，也會清除這些標籤。

<!-- ACP2E-1803 -->

* 內容分段預覽現在可正確用於連結的頁面。 之前，您無法導覽至測試版預覽中的連結頁面，而是錯誤地導向到店面頁面。

<!-- ACP2E-1876 -->

* 暫с停測試更新不會再導致移除指派在稍後日期的已排程更新。

<!-- ACP2E-1501 -->

* 當您在啟用Google Analytics內容實驗時新增或編輯類別的已排程更新時，不再發生JavaScript錯誤。

<!-- ACP2E-1344 -->

* 商戶現在可以在檢視或編輯類別後，成功儲存現有的排程更新。 之前，Adobe Commerce擲回錯誤 `system.log`.

<!-- ACP2E-1596 -->

* 當先前新增的產品加入購物車並套用排定的更新時，可下載的連結現在會如預期保留。 之前，可下載的連結會從客戶的「我的帳戶（我的可下載產品）」頁面和「管理員訂單檢視」頁面消失。

<!-- ACP2E-1458 -->

* 在啟用產品的測試版更新套用後，產品現在會如預期顯示在店面上。 之前，產品會在「管理員」中啟用，但目錄目錄的索引器模式設為「依排程更新」時，產品不會顯示在「店面」類別中。 重新編列完整索引已修正問題。

<!-- ACP2E-1647 -->

* 此 `staging.synchronize_entity_period` 中的消費者佇列 `magento_bulk` 當沒有要處理的中繼更新時，表格不再增加。 先前，當 `cron` 設定為每分鐘執行一次，新記錄會與 `staging.synchronize_entity_period` 每分鐘都會將消費者新增至此表格。

<!-- ACP2E-1415 -->

* 儲存其他產品時，當您為產品建立排程變更時，Adobe Commerce不再擲回SQL錯誤。  Adobe Commerce之前會顯示此錯誤：  `The product with the SKU "%1" couldn't be added to the current update`.

### Target規則

<!-- ACP2E-1438 -->

* Target規則現在可搭配不同的存放區檢視正常運作。 以前，相關產品規則快取問題會導致無法在多存放區部署中顯示建議產品。

### 稅金

<!-- ACP2E-1527 -->

* 您現在可以依照預期，從「稅捐規則」編輯頁面編輯「稅率國家/地區」的值。 之前，不會儲存從該頁面所進行的編輯。

<!-- ACP2E-1143 -->

* 更新送貨方法時，購物車預估區域中的稅捐金額現在會如預期般重新整理。 以前，購物者在結帳期間變更國家/地區後，不會更新稅率。

<!-- AC-8227 -->

* 此 `tax class` 在「商店檢視」範圍中建立現有可設定產品的新變體時，新建立的簡單產品值現在會設定為父產品的值。 此值以前設為none。 因此，購物車中的這些產品未加稅，且客戶的稅金不足。 [GitHub-37180](https://github.com/magento/magento2/issues/37180)

### 測試

<!-- ACP2E-2202 -->

* 已重構 `Magento\GraphQl\Catalog\ProductSearchTest::testFilterProductsBySingleCategoryId` 測試以處理中的隨機類別順序 `products` 查詢回應。

<!-- AC-7098 -->

* 中大型陣列的效能問題 `TableNameSniff` 已解決。

<!-- ACP2E-1690 -->

* 編輯贈品登入功能的整合測試不再依賴現有的實體ID。 所有必要資料現在都透過夾具取得。 先前， `\Magento\GiftRegistry\Controller\Index\EditPostTest` 失敗。

<!-- ACP2E-1748 -->

* `CollectionTest::testGetDateRangeFirstPart()` 現在計入日光節約時間。

<!-- ACP2E-1824 -->

* 修正的過時通知 `StorefrontDeleteItemFromRequisitionListPrintView`.

### UI

<!-- AC-8823 -->

* 密碼現在會如預期顯示，當 **[!UICONTROL Show Password]** 「登入」頁面上的核取方塊為作用中。 這是2.4.7-beta1的已知問題。

<!-- ACP2E-2034 -->

* Adobe Commerce現在會顯示具有特殊價格的固定套件組合產品的正確價格。 這是2.4.7-beta1的已知問題。

<!-- AC-8285 -->

* 更新店面頁尾範本檔案中GitHub問題清單頁面的連結。 [GitHub-37214](https://github.com/magento/magento2/issues/37214)

<!-- AC-6282 -->

* 「最近檢視的Widget」現在會在已分組的產品價格中顯示正確的稅捐金額。 [GitHub-35881](https://github.com/magento/magento2/issues/35881)

<!-- AC-6636 -->

* 管理員使用者現在可以如預期拖放針對簡單產品建立的可自訂選項。 [GitHub-36051](https://github.com/magento/magento2/issues/36051)

<!-- AC-8345 -->

* 產品下拉式清單屬性型別的順序現在與可設定產品頁面上的影像順序相符。 [GitHub-37285](https://github.com/magento/magento2/issues/37285)

<!-- ACP2E-1969 -->

* 系統訊息現在載入得更快。 只會載入正在顯示的訊息。 以前，所有訊息都是從資料庫載入，非常耗時。

<!-- ACP2E-1804 -->

* 透過設定移除階層連結節點 `remove=true` 透過版面XML不再導致類別頁面上的頁面標題移除。 之前，以這種方式移除階層連結會從類別頁面中移除頁面標題。

<!-- ACP2E-1717 -->

* 現在，當客戶登錄檔單包含多選客戶屬性時，會如預期載入。 之前，Adobe Commerce擲回此例外狀況： `[2023-03-05T05:57:40.032602+00:00] report.CRITICAL: Exception: Deprecated Functionality: explode(): Passing null to parameter #2 ($string) of type string is deprecated in /magento2ee/app/code/Magento/CustomAttributeManagement/Block/Form/Renderer/Multiselect.php on line 53 in /lib/internal/Magento/Framework/App/ErrorHandler.php:62`. [GitHub-37189](https://github.com/magento/magento2/issues/37189)

<!-- ACP2E-1602 -->

* 包含單引號的歡迎訊息現在會在店面上正確轉譯，不會出現主控台錯誤。 先前，如果歡迎訊息包含單引號，則在店面呈現期間不會載入歡迎訊息。 Adobe Commerce也顯示主控台錯誤。

<!-- ACP2E-1369 -->

* 當您嘗試在「管理員順序」頁面中的評論歷程記錄與傳回之間快速變更檢視時，Adobe Commerce不再擲回錯誤。 之前，Adobe Commerce會顯示此一般錯誤： `A technical problem with the server created an error`.

<!-- ACP2E-1374 -->

* 管理員使用者如果只有一個網站的許可權，現在可以將特定網站的產品屬性集更新為 `all stores view` 範圍。

<!-- ACP2E-1648 -->

* 放大鏡Widget現在會在產品頁面上如預期般載入。

<!-- ACP2E-1216 -->

* 多明細行可自訂選項現在會在商業發票、出貨及銷退折讓單PDF檔案中正確呈現。 以前，多行文字前面會出現非預期的分頁符號，如果文字超出頁面，文字會被截斷。

<!-- AC-7402 -->

* 現在，當為其他網站（其商店ID與網站ID不符）建立該客戶時，管理員使用者可以從管理員新增客戶地址。 Adobe Commerce先前會顯示此快顯訊息： `Something went wrong`. [GitHub-36582](https://github.com/magento/magento2/issues/36582)

<!-- ACP2E-1529 -->

* 現在會如預期儲存公司管理員詳細資料，而且當指派公司管理員電子郵件包含 `CMS Block URL` 變數中。

<!-- ACP2E-1775 -->

* 與在訂單詳細資訊頁面上提交評論相關的錯誤訊息，現在可提供更多資訊。 先前，當購物者按一下 **[!UICONTROL Submit comment]** 在未變更訂單狀態或在註解區輸入文字的情況下，Adobe Commerce會顯示以下訊息： `The comment is missing. Enter and try again`.

<!-- ACP2E-1659 -->

* 行事曆圖示現在按預期顯示在管理員的日期範圍欄位中 **[!UICONTROL Marketing]** > **[!UICONTROL Cart Price Rules]** 為一個欄位選取日期之後。 先前，您為一個欄位選取日期後，其他欄位不再顯示行事曆圖示，而Adobe Commerce會顯示預留位置文字。 [GitHub-36499](https://github.com/magento/magento2/issues/36499)

<!-- ACP2E-1717 -->

* 包含多選欄位的客戶登錄檔單現在已成功載入。 以前，此表單包含多選欄位時未載入，並觸發以下錯誤：  `report.CRITICAL: Exception: Deprecated Functionality: explode(): Passing null to parameter #2 ($string) of type string is deprecated in /magento2ee/app/code/Magento/CustomAttributeManagement/Block/Form/Renderer/Multiselect.php on line 53 in /lib/internal/Magento/Framework/App/ErrorHandler.php:62`. [GitHub-37189](https://github.com/magento/magento2/issues/37189)

<!-- AC-7092 -->

* 在產品庫全熒幕模式中按一下視訊縮圖，現在會如預期顯示視訊。 以前不顯示視訊，且瀏覽器主控台顯示JavaScript錯誤。 [GitHub-36456](https://github.com/magento/magento2/issues/36456)

<!-- AC-7806 -->

* 在每年自動更新的版權行中新增變數。 [GitHub-36776](https://github.com/magento/magento2/issues/36776)

<!-- AC-8441 -->

* 產品頁面上的影像滑桿現在可在行動檢視中正常運作。 以前，只成功顯示第一個影像。 [GitHub-37232](https://github.com/magento/magento2/issues/37232)

### URL重新寫入

<!-- AC-6728 -->

* 當產品新增到類別時，類別產品URL重寫現在會如預期產生所有商店檢視。 [GitHub-32910](https://github.com/magento/magento2/issues/32910)

<!-- ACP2E-1783 -->

* 當您嘗試在下列情況下為產品URL建立301/302重新導向，Commerce不再擲回錯誤 **產生類別/產品URL重寫** 已啟用。 建立產品並指派給類別時，就會建立自動化URL重新寫入：一個用於直接URL，另一個用於透過類別路徑傳送的產品。 建立新產品URL重寫時，會檢查產品、類別和商店之間的關聯。 此檢查現在以關聯的實體屬性（類別和產品）為基礎。 之前，這項檢查是在預先存在的URL重寫時執行的。

<!-- ACP2E-1737 -->

* 現在從CSV檔案匯入新類別時，會為所有存放區檢視產生類別URL重寫。

<!-- ACP2E-1700 -->

* 產品URL尾碼和類別URL尾碼設定現在符合 `url_rewrite` 表格。 先前，更新URL尾碼設定時發生競爭條件，且已設定的URL尾碼和 `url_rewrite` 資料表不符。

<!-- ACP2E-1703 -->

* 現在，在建立類別URL重寫時，Adobe Commerce會在所有層級轉譯類別樹。 以前，只顯示類別的前三個層級。 [GitHub-36973](https://github.com/magento/magento2/issues/36973)

<!-- ACP2E-1644 -->

* 新建立的具有一個子節點的CMS頁面現在包含在行銷篩選格線中(**[!UICONTROL Marketing]** > **[!UICONTROL URL rewrites]**)。 之前，系統不會為這些CMS頁面建立URL重新寫入。

<!-- ACP2E-1737 -->

* 匯入新類別期間，CSV檔案中現在會出現類別URL重新寫入。

<!-- ACP2E-1668 -->

* 沒有URL重寫的多重儲存CMS頁面現在會如預期般轉送。 先前，系統會將要求的多存放區CMS頁面（不含URL重新寫入）重新導向至存放區首頁，但不會導向原始CMS頁面。

### Visual Merchandiser

<!-- ACP2E-1363 -->

* 您現在可以使用 `Categories` Visual Merchandiser規則的屬性。 之前，Adobe Commerce擲回此例外狀況：  `Something went wrong while saving the category`.

### Web API框架

<!-- ACP2E-2053 -->

* 非同步大量REST API作業，以更新具有層級價格和不同屬性集的產品，現已順利完成。 以前，無法以這種方式更新具有不同屬性集的產品，並且Commerce會顯示此錯誤： `The product was unable to be saved. Please try again`.

<!-- AC-7002 -->

* 此 `POST /V1/products/tier-prices` 端點現在會在層級價格建立期間使用無效的客戶群組名稱時，傳回資訊更豐富的錯誤訊息。 之前，Adobe Commerce傳回的錯誤如下： `Notice: Undefined index: XXXXX in ~/public_html/vendor/magento/module-catalog/Model/Product/Price/Validation/TierPriceValidator.php on line 474"`. [GitHub-36431](https://github.com/magento/magento2/issues/36431)

<!-- ACP2E-1776 -->

* 您現在可以執行授權的非同步大量API請求，以使用非預設群組ID建立客戶。 以前，這些請求會將群組ID重設為預設值。

<!-- ACP2E-1543 -->

* 使用大量API建立的客戶現在會收到在其指派的網站中設定的語言的客戶註冊電子郵件。  以前，所有電子郵件都會傳送到預設地區設定，而不是客戶被指派的網站的地區設定。

<!-- ACP2E-1339 AC-7577-->

* 此 `POST V1/guest-carts` 以下情況時，呼叫不再提交訪客訂單： **[!UICONTROL Allow Guest Checkout]** 已停用。

<!-- ACP2E-1336 -->

* 您現在可以從管理員開啟狀態為的訂單 `Received` 當 `AsyncOrder` 未啟用。 之前，當訂單狀態被變更時，您無法從Admin開啟訂單詳細資訊頁面 `POST V1/orders`.

<!-- ACP2E-1526 -->

* Adobe Commerce現在已成功傳回 `content` 中的屬性（base64影像代碼） `GET V1/products/sku/media` 產品媒體API回應。 此 `content` 屬性先前未出現在回應中。

### 希望清單

<!-- ACP2E-1784 -->

* 當購物者嘗試多次將相同專案新增至願望清單時，Commerce現在會顯示訊息，指出該專案已新增至願望清單。 以前，在這些條件下，Commerce會增加願望清單中的產品數量。

<!-- AC-8610 -->

* Adobe Commerce現在已成功將具有所需上傳之可自訂選項檔案的產品新增至願望清單。 之前，Commerce在願望清單中新增了兩個產品，而不是一個。 [GitHub-37437](https://github.com/magento/magento2/issues/37437)

## 已知問題

下列已知問題將在Adobe Commerce 2.4.7-beta3中修正：

**問題**：將指派給產品的共用目錄從產品中移除後，產品不會如預期從迷你購物車中移除。 此問題為2.4.7-beta1的已知問題，並排定在2.4.7-beta3中解決。 <!-- AC-8935 -->

## 系統需求

我們的技術棧疊是以PHP和MySQL為基礎所建置。 如需詳細資訊，請參閱 [系統需求](https://experienceleague.adobe.com/docs/commerce-operations/installation-guide/system-requirements.html).

## 安裝和升級指示

您可使用以下程式碼安裝Adobe Commerce 2.4.7-beta2： [作曲者](https://experienceleague.adobe.com/docs/commerce-operations/installation-guide/composer.html).
