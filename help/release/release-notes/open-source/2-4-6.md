---
title: Magento Open Source2.4.6發行說明
description: 瞭解2.4.6Magento Open Source版中的新功能、增強功能、錯誤修復和已知問題。
exl-id: bf25d53e-dfb1-4ff9-89fe-f26bc99f3f01
source-git-commit: 95ffff39d82cc9027fa633dffedf15193040802d
workflow-type: tm+mt
source-wordcount: '8525'
ht-degree: 0%

---

# Magento Open Source2.4.6發行說明

Magento Open Source2.4.6引入對PHP 8.2的支援。仍完全支援PHP 8.1，但已取消對PHP 7.4的支援。 它包括顯著的效能和可擴充性增強。 已優化了用於批量購物車操作和類別樹呈現響應的GraphQL操作。

此版本包括質量修復和增強。 Core Composer依賴項和第三方庫已升級到與PHP 8.2相容的最新版本。

{{bics}}

## 其他發佈資訊

儘管這些功能的代碼與Magento Open Source核心代碼的版本捆綁在一起，但其中幾個項目也是獨立發佈的。 這些項目的錯誤修復程式都記錄在每個項目文檔中提供的獨立、特定於項目的發行資訊中。

## Magento Open Source2.4.6亮點

在此版本中查找以下亮點。

### 安全增強

此版本包括八項安全修復和平台安全改進。

迄今未發生與這些問題相關的已確認攻擊。 但是，某些漏洞可能被利用來訪問客戶資訊或接管管理員會話。 大多數這些問題都要求攻擊者首先獲得對管理員的訪問權限。 因此，我們提醒您採取一切必要步驟保護您的管理員，包括但不限於以下工作：

* IP允許
* [雙因素認證](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)
* 使用VPN
* 使用唯一位置，而不是 `/admin`
* 密碼衛生

請參閱 [Adobe安全公告](https://helpx.adobe.com/security/products/magento/apsb23-17.html) 來討論這些固定問題。

#### 其他安全增強功能

此版本的安全改進改進了對最新安全最佳做法的遵守，包括：

* 已通過對網格視圖、成批操作和導出中的操作進行更具體的審核來彌補管理操作日誌中的漏洞。 <!-- AC-1553 -->

* 在付款處理期間發生意外錯誤時，reCAPTCHA驗證不再在結帳期間失敗。 [GitHub-35093](https://github.com/magento/magento2/issues/35093) <!-- AC-2642 -->

* **管理員用戶更改其電子郵件時要求確認電子郵件的新系統配置**。 為減少站點漏洞，添加了新的系統配置設定（預設為禁用），以便在管理員用戶更改其電子郵件時要求確認電子郵件： **[!UICONTROL Stores]** > **[!UICONTROL Settings:Configuration]** > **[!UICONTROL Customers]** > **[!UICONTROL Customer Configuration]** > **[!UICONTROL Account Information Options]** > **[!UICONTROL Require email confirmation if an email has been changed]**。 啟用此選項後，應用程式將在每次管理員用戶更改其電子郵件地址時請求電子郵件確認。 以下模組受此更改的影響： `Magento_Customer`。 <!-- AC-3064 -->

### 平台增強

Magento Open Source2.4.6引入對PHP 8.2的支援。仍完全支援PHP 8.1。 <!-- AC-6598 -->

已從此版本中刪除PHP 7.4支援。 無法在PHP 7.4上運行Magento Open Source2.4.6。

Magento Open Source現在支援：

* 作曲家2.2.x已刪除作曲家1.x。 <!-- AC-2839 -->

* 雷迪斯7.0.x儘管與Redis 6.2的相容性仍然存在，但我們建議將此版本與Redis 7.0.x一起部署，因為Redis 6.2預計將於2024年壽終正寢。 <!-- AC-6606 -->

* 現在支援OpenSearch作為預設搜索引擎，用於Magento Open Source本地和雲部署。 它支援作為獨立的搜索引擎進行Magento Open Source。 此版本支援OpenSearch v2.x，並已通過OpenSearch 2.5測試。儘管仍與OpenSearch 1.x相容，但建議將此版本與OpenSearch 2.x一起使用。您可以在雲和內部部署上安裝並運行帶OpenSearch 2.x的Magento Open Source和Magento Open Source2.4.6 [搜索引擎先決條件](https://experienceleague.adobe.com/docs/commerce-operations/installation-guide/prerequisites/search-engine/overview.html)。 <!-- AC-449 3555 -->

* Elasticsearch8.x請參閱 [升級Elasticsearch](../../../upgrade/prepare/prerequisites.md#upgrade-elasticsearch)。 <!-- AC-6597 -->

* MariaDB 10.6（LTS版本）。 此版本仍與MariaDB 10.4相容，但我們建議升級到MariaDB 10.6。 <!-- AC-6921 -->

#### 其他升級和更換

* DHL架構已從v6.2遷移到v10.0。 <!-- AC-3023-->

* 過時的JavaScript庫已更新為其最新版本，並且已刪除過時的依賴項。 這些更改向後相容。 <!-- AC-2036-->

* PHP 7.4相容性已從Commerce和Magento Open Source代碼庫中刪除。 <!-- AC-2841-->

* Symfony依賴項已升級到新的LTS版本。 依賴項包括：<!-- AC-2656-->

   * `friendsofphp/php-cs-fixer`
   * `symfony/console`
   * `symfony/event-dispatcher`
   * `symfony/finder`
   * `symfony/process`
   * `web-token/jwt-framework`

* `jquery-migrate` 已從商業和Magento Open Source代碼庫中刪除。 [GitHub-21406](https://github.com/magento/magento2/issues/21406) <!-- AC-1199 -->

* 已升級 `jQuery/fileUpload` 庫到v10.32。 <!-- AC-2658-->

* 已到達壽命終了的Zend框架(ZF1)元件已被從基底中去除。 請參閱 [向後不相容的更改突出顯示](https://developer-stage.adobe.com/commerce/php/development/backward-incompatible-changes/highlights/)。<!-- AC-1512 -->

* 已更新Laminas依賴項以支援PHP 8.2。 <!-- AC-7019-->

* 的 `laminas/laminas-dependency-plugin` 已刪除作曲家插件。 [GitHub-36515](https://github.com/magento/magento2/issues/36515) <!-- AC-7100-->

* 已更換 `Zend_Filter` 與 `laminas/laminas-filter`。 <!-- AC-5922-->

* 已升級 `web-token/jwt-framework` 到v3.0.5。 （最新版本） <!-- AC-3772-->

* 已升級 `allure-framework/allure-phpunit` 到v2.x。 <!-- AC-2660-->

* 已升級 `Chart-js` 庫到v3.9.1 <!-- AC-2661-->

### 輔助功能更新

本新聞稿的重點是在Venia(PWA)上建立一種更易感知，可操作，可理解和強健的店面體驗。 這些增強包括：

<!-- AC-2479-->

* 的可視文本標籤 **[!UICONTROL Sign in]** 按鈕現在與其可訪問的名稱匹配。 （最佳實踐建議UI元素的可訪問名稱以可見標籤文本開頭。）

<!-- AC-2481 2492-->

* 整個店面的按鈕中都添加了描述性的可訪問名稱。

<!-- AC-2488-->

* 已將語言描述性標籤添加到 **[!UICONTROL Has Video]** 複選框。

<!-- AC-2787-->

* 只使用鍵盤的用戶現在可以訪問店面上的所有頁面功能。 以前，購物者無法僅使用擊鍵訪問子導航連結。


### Adobe Commerce與Adobe IMS整合

以下Adobe IMS模組已與Adobe Commerce和Magento Open Source核心代碼分離，現在打包成單獨的元包：

* `adobe-ims`
* `adobe-ims-api`
* `admin-adobe-ims`

新 `adobe-ims-metapackage` v2.2.0與Adobe Commerce2.4.6和Magento Open Source2.4.6捆綁。此版本中沒有更改任何功能。<!-- CABPI-505-->

### Braintree

<!-- BUNDLE-3107-->

* 的 **[!UICONTROL Pay Later]** 已為義大利和西班牙啟用按鈕和橫幅（消息）以進行Braintree。

<!-- BUNDLE-3109-->

* 已啟用PayPal Vault的PayLater消息傳遞。

<!-- BUNDLE-3140-->

* 已添加欺詐保護和ACH Web掛接。 當在Braintree中作出風險決定時，將觸發欺詐保護網鈎。 當ACH付款的狀態更新為 `settled` 或 `settlement decline`。

<!-- BUNDLE-3141-->

* 已添加LPM（本地付款方法）Web掛接。

### GraphQL

GraphQL的效能增強包括：

**查詢啟用了類別權限的類別時的響應時間縮短**。 在類別中查詢啟用了類別權限且包含許多客戶組或共用目錄的產品時，響應時間已有所改善。 支援此效能改進的代碼更改包括： <!-- B2B-2179 2404 2329-->

* GraphQL解析程式操作已優化。
* 資料提供器不再為每個正在處理的新產品重新設定運行時快取資料，這提高了效能。 <!-- B2B-2452-->
* 已在GraphQL解析程式中優化了產品權限處理。 現在，產品權限應用於產品集合，而現在則應用於每個產品。  <!-- B2B-2404-->
* 在中的共用目錄中讀取的優化權限 `addProductsToCart` 變異。 <!-- B2B-2424-->
* 產品權限已使用產品內聯片段優化。 <!-- B2B-2459-->

**類別樹繪製的優化效能**。 的 `categoryList` 查詢已優化為支援具有大量類別的客戶。 使用此查詢搜索1500多個類別（最多包含五個嵌套子類別）的商家將注意到效能提高。 通過刪除不必要的方法調用、改進類樹快取、遞歸地載入類資料，改進了重構代碼對類子的載入。  支援此效能改進的代碼更改包括： <!-- B2B-2484 2469 2472-->

* 類別模型的自定義屬性元資料提取已得到改進。 <!-- B2B-2463-->
* 類別ID提取已改進， `getChildren` 呼叫已減少。 <!-- B2B-2464-->
* 類別子代載入已改進。<!-- B2B-2469-->

**減少批量購物車操作查詢響應時間**。 添加產品突變已經過優化，以在添加多達500個簡單且可配置的產品時提高查詢效能。 捆綁產品不受影響。 優化的突變包括 `addProductsToCart`。 `addConfigurableProductsToCart`。 `addDownloadableProductsToCart`。 `addSimpleProductsToCart`。 `addVirtualProductsToCart`。`addWishlistItemsToCart`, `updateCartItems`。 <!-- B2B-2331 2423-->

**客戶查詢現在支援訂單排序**。 的 `orders` 輸出對象 `customer` 查詢現在包含一個排序欄位。 您現在可以按訂單編號或建立日期以及升序或降序對訂單進行排序。 <!-- AC-6903-->

新突變：

`deleteCustomer` <!-- AC-2879-->


### 頁面生成器

Page Builder v.1.7.3與Magento Open Source2.4.6相容。

### PWA Studio

PWA Studiov.13.0.x與Magento Open Source2.4.6相容。它包括多種增強功能，以改進可訪問性。 有關錯誤修復的資訊，請參見 [PWA Studio版本](https://github.com/magento/pwa-studio/releases)。 請參閱 [版本相容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 清單中的「PWA Studio」版本及其相容的Adobe Commerce核心版本。


### 已知問題

**問題**:New Relic目前與八點二菲律賓比索不相容。運行New Relic的部署可以在PHP 8.1上運2.4.6Adobe Commerce，但不能在PHP 8.2上運行。 **解決方法**:在PHP 8.1上運行Adobe Commerce2.4.6，直到發佈支援PHP 8.2的新版New Relic。本新聞稿預計在2023年夏季發佈。 <!-- AC-7769-->

## 已修復問題

我們已解決了Magento Open Source核心代2.4.6中的數百個問題。

### 安裝、升級、部署

<!-- ACP2E-1168-->

* 在具有多個語言環境和網站的標準或緊湊部署期間，靜態內容部署不再超時或失敗。

<!-- ACP2E-923-->

* 壓縮策略在運行靜態內容部署時不再導致對外部域的無效引用(`bin/magento set:static-content:deploy -f --strategy compact`)。

<!-- AC-5994-->

* 正在執行 `bin/magento setup:di:compile -vvv` (或 `-v` 或 `-vv` 選項)現在返回失敗時的資訊性消息。 [GitHub-35391](https://github.com/magento/magento2/issues/35391)

<!-- AC-5973-->

* Magento Open Source在運行 `bin/magento setup:upgrade` 已運行資料遷移工具的部署中的命令： `PHP Fatal error:  Declaration of Migration\Logger\Logger::addRecord(int $level, string $message, array $context = []): bool must be compatible with Monolog\Logger::addRecord(int $level, string $message, array $context = [], ?Monolog\DateTimeImmutable $datetime = null): bool in /var/www/html/vendor/magento/data-migration-tool/src/Migration/Logger/Logger.php on line 34`。 [GitHub-35604](https://github.com/magento/magento2/issues/35604)

<!-- AC-5970-->

* 的 `bin/magento setup:db:status` 命令在運行MySQL 8.0.29的環境中不再失敗。以前，命令輸出錯誤地指出聲明性模式已過時。 [GitHub-35671](https://github.com/magento/magento2/issues/35671)

<!-- AC-1377-->

* 的 `composer install` 不再覆蓋 `.gitignore` 的子菜單。 [GitHub-32888](https://github.com/magento/magento2/issues/32888)

<!-- AC-6671-->

* 正在運行 `bin/magento sampledata:remove` 要在Alpine Linux上升級後刪除示例資料，將不再失敗，出現以下錯誤： `Undefined constant "MagentoHackathon\Composer\Magento\Deploystrategy\GLOB_BRACE`。 [GitHub-36062](https://github.com/magento/magento2/issues/36062)


<!-- AC-6933-->

* `bin/magento setup:upgrade` 在第一次執行後 `composer install --no-dev`。 [GitHub-36351](https://github.com/magento/magento2/issues/36351)

<!-- AC-6796-->

* 異常和異常堆棧跟蹤條目現在包含在 `var/log/exception.log`。 [GitHub-36054](https://github.com/magento/magento2/issues/36054)

<!-- AC-2681-->
Magento Open Source現在在使用命令行設定不帶密碼的Redis連接時引發參數驗證錯誤。


### 輔助功能

<!-- AC-6678 6679 6677-->

* 的 **[!UICONTROL Proceed to Checkout]**。 **[!UICONTROL Review Order]**, **[!UICONTROL Place Order]** 簽出工作流中的按鈕現在可以按鍵盤輸入的要求工作。

<!-- AC-2485-->

* 使用時按鈕焦點的視覺指示 **[!UICONTROL TAB]** 或 **[!UICONTROL SHIFT + TAB]** 瀏覽頁面控制項時，現在可以按預期工作。


#### 螢幕閱讀器

<!-- AC-2498-->

* 訂單歷史記錄頁面的螢幕閱讀器現在讀取正確的影像說明。

螢幕閱讀器現在宣佈：

* 在搜索結果中找到的項目總數（如預期） <!--- AC-3522-->
* 用戶成功使用鍵盤控制項登錄時登錄的用戶名 <!--- AC-6477-->
* 現在，產品搜索結果頁眉會讀取 `<title>` 元素 <!--- AC-2489-->
* 是否需要輸入欄位 <!--- AC-2494-->
* 正確折疊元素的當前狀態（折疊和展開） <!--- AC-2487-->
* 在用戶按一下 **[!UICONTROL Create an account]** 按鈕 <!---AC-6676-->


### 捆綁產品

<!-- ACP2E-906-->

* 現在，通過API為特定儲存視圖更新捆綁產品不會覆蓋同一捆綁產品的其他儲存視圖資料。 以前，捆綁產品選項標題被覆蓋為其他商店視圖的第一個選項標題。

<!-- AC-3769-->

* 現在，可以從管理員成功篩選捆綁產品 **[!UICONTROL Catalog]** > **[!UICONTROL Products]** 使用荷蘭語區域設定時。 以前，Magento Open Source在您嘗試篩選時顯示此錯誤 `Type: Bundle Product`: `Something went wrong with processing the default view and we have restored the filter to its original state`。 [GitHub-35704](https://github.com/magento/magento2/issues/35704)

<!-- ACP2E-1038-->

* 當捆綁產品的特殊價格超過1000時，產品網格不再引發異常。 以前，當您按SKU搜索產品或導航到 **[!UICONTROL Catalog]** > **[!UICONTROL Products]**,Magento Open Source拋出此錯誤： `Non Numeric value encountered`。 [GitHub-36284](https://github.com/magento/magento2/issues/36284))

<!-- ACP2E-1220-->

* 包含捆綁和簡單產品組合的訂單的貸項通知單和發票PDF中的列現在將正確呈現。 以前，列失真或未對齊。

<!-- ACP2E-1315-->

* 在GraphQL中包含 `BundleProduct` 碎片， `items.options.product` 對象包含預期的資料。 以前，對象在某些情況下可能為null。

<!-- AC-6548-->

* 現在，當捆綁包選項的小數量 **[!UICONTROL Quantity uses decimals]** 的子菜單。 以前，只渲染量的整數部分，而不是分數分量。 例如，將1.5的數量渲染為1.0。 [GitHub-35964](https://github.com/magento/magento2/issues/35964)

<!-- B2B-2453-->

* GraphQL產品查詢現在只返回要查詢的商店範圍內的捆綁產品選項。

<!-- B2B-2455-->

* 未分配給類別但是屬於捆綁或分組產品的產品選項的產品，現在在 **[!UICONTROL Allow Category Browsing]** 已為發送查詢的客戶啟用配置設定。

### 快取

<!-- ACP2E-134-->

* 訂單完成後，除非訂購的產品已出庫，否則不再刷新全頁快取。 以前，每次建立發運時都會清除類別的快取。

<!-- ACP2E-1321-->

* 現在，當配置了L2快取並部分逐出遠程資料時，資料將成功快取。 以前，在只刷新資料快取而不對這些資料進行散列後，新快取在存在資料散列時不會保存。

<!-- B2B-2471-->

* 已更正的缺陷 `CatalogUrlResolverIdentity` 和 `CmsUrlResolverIdentity` 阻止了快取。 這影響了多個請求的路由查詢快取。

### 購物車和結帳


<!-- ACP2E-965-->

* 購物者現在可以在購物車包含簡單產品的最小數量時，向購物車添加附加項目。

<!-- ACP2E-964-->

* 檢索購物車資料的REST API調用現在返回相同 `grand_total` 和 `base_grand_total` 當儲存貨幣和基本貨幣相同時的值。 [GitHub-34649](https://github.com/magento/magento2/issues/34649)

<!-- ACP2E-962-->

* 導出的值 **[!UICONTROL Maximum Qty Allowed in Shopping Cart]** 現在與「管理」配置設定中設定的預設值匹配。

<!-- ACP2E-889-->

* Magento Open Source現在正確計算具有發運折扣的訂單退款總計。

<!-- ACP2E-876-->

* Google反碼頭現在能如預期那樣運作。 以前，當在購物者首次嘗試下訂單之前未首次選擇GoogleReCAPTCHA時，Magento Open Source會顯示以下錯誤： `ReCaptcha validation failed, please try again` 和 `No such cart with id = ID`。

<!-- AC-2338-->

* 現在，驗證碼映像刷新將遵守「管理」配置設定，並且在禁用該設定時不會觸發。 以前，無論設定是啟用還是禁用，只要付款方法發生更改，就會觸發刷新。 [GitHub-34855](https://github.com/magento/magento2/issues/34855)

<!-- ACP2E-479-->

* Magento Open Source現在會像預期的那樣顯示確認彈出窗口，當購物者在不更新購物車的情況下更改購物車頁面上的產品數量，然後嘗試導航到下一頁時，將購物者重定向到下一頁。

<!-- AC-5987-->

* 購物者現在可以在管理員中減少購物車的數量。 以前，當購物者嘗試減少產品數量時，Magento Open Source拋出以下錯誤： `The requested qty is not available`。 [GitHub-35780](https://github.com/magento/magento2/issues/35780)

<!-- AC-6744-->

* 當產品數量超過多次發運簽出期間配置的最大值時，Magento Open Source不再在JavaScript控制台中引發錯誤。 現在，Magento Open Source會顯示一條資訊性錯誤消息。 [GitHub-36184](https://github.com/magento/magento2/issues/36184)

<!-- ACP2E-1276-->

* 當購物者使用鍵盤上的向下箭頭鍵更改產品數量時，購物車頁面上的物料數量不再表示為負數。 [GitHub-36299](https://github.com/magento/magento2/issues/36299)

<!-- ACP2E-1232-->

* 購物者無法再將產品從更改購物者所屬的客戶組後禁止的類別添加到購物車。 Magento Open Source現在在權限配置設定已更改時檢查特定類別的客戶組權限訪問。

<!-- ACP2E-926-->

* 在建立管理訂單之前，不再清空客戶購物車，如果訂單被取消或放棄，則現在將恢復購物車內容。 現在，只有在建立訂單後，才會從購物車中刪除物料。 以前，每當管理員用戶嘗試在「管理員管理購物車」頁上建立訂單時，購物車就會被清空。

<!-- AC-6939-->

* 運行後，Mini Cart現在顯示正確的產品映像 `bin/magento catalog:image:resize`。 以前，所有影像都被預設的產品佔位符影像替換。 [GitHub-35535](https://github.com/magento/magento2/issues/35535)

<!-- AC-2376-->

* 當發運地址包含擴展屬性時，現在可以成功完成簽出。 以前，Magento Open Source拋出了以下錯誤： `Object of class Magento\Quote\Api\Data\AddressExtension could not be converted to string`。 [GitHub-34202](https://github.com/magento/magento2/issues/34202)

<!-- AC-2793-->

* 的 `addBundleProductsToCart` 如果所需的產品選項沒有值，則突變不再將產品添加到報價。 [GitHub-25676](https://github.com/magento/magento2/issues/25676)

<!-- B2B-2458-->

* Magento Open Source現在在 `addProductsToCart` 在將產品添加到手推車時，如果權限不足，則變異失敗。

<!-- ACP2E-1242-->

* Magento Open Source在使用快速訂單以超出可用庫存的數量添加產品時，不再在購物車頁上引發錯誤。


### 購物車價格規則

<!-- AC-2242-->

* 在建立規則期間設定的購物車價格規則免費發運選項現在按預期應用於訂單。 以前，在建立規則期間應用的免費發運選項在簽出期間被忽略，在應用規則時不允許免費發運。 [GitHub-35013](https://github.com/magento/magento2/issues/35013)

<!-- ACP2E-1074-->

* 的 `discount_percent` 列 `sales_order_item` 當未設定物料折扣數量或該數量大於或等於訂單物料數量時，產品的表現在按預期填充，並使用折扣百分比。 以前，在將購物車價格規則應用於此產品時未填充此列。

### 目錄

<!-- ACP2E-1181-->

* 產品清單構件不再顯示登錄購物者的不正確或快取價格。 首頁小部件中顯示的價格現在與購物者的地址匹配，並在購物者更新地址時更新。 以前，瀏覽器快取未根據客戶組稅則更新首頁上的產品價格。

<!-- ACP2E-1007-->

* 「比較產品」清單功能現在可以在多網站部署中正常工作，並且取決於網站。

<!-- ACP2E-900-->

* Magento Open Source在重新載入產品詳細資訊頁面時不再顯示上一頁的資料。 以前，當重新載入產品詳細資訊頁面時，第一個頁籤中的資料與新載入的資料合併一秒。

<!-- ACP2E-816-->

* 現在，可以按照預期在移動設備的主菜單中展開具有子類別的類別。 以前，購物者無法在移動部署中開啟或擴展具有子類別的類別。 [GitHub-35329](https://github.com/magento/magento2/issues/35329)

<!-- ACP2E-789-->

* 現在，在將產品分配到新網站或商店時，將按照預期更新類別清單。 以前，產品價格索引器未標籤為無效，隨後在 `cron` 按預期運行。 因此，價格指數表中缺少產品的價格條目，而且沒有顯示在新商店或網站上。

<!-- AC-6395-->

* 庫面庫存計數現在在 **[!UICONTROL Display Out of Stock Products]** 配置設定已啟用。 [GitHub-35899](https://github.com/magento/magento2/issues/35899)

<!-- AC-6384-->

* 在 **[!UICONTROL Allow All Products Per Page]** 設定已啟用。 [GitHub-35900](https://github.com/magento/magento2/issues/35900)

<!-- AC-6330-->

* 的 **[!UICONTROL Display Out of Stock Products]** 配置選項現在在啟用時按預期方式工作。 以前，在管理員上啟用此選項時，所有產品都顯示為庫存不足。 [GitHub-35898](https://github.com/magento/magento2/issues/35898)

<!-- ACP2E-1306-->

* 按布爾屬性排序的產品現在可以按預期工作。 [GitHub-36390](https://github.com/magento/magento2/issues/36390)

<!-- ACP2E-1206-->

* 目錄價格規則折扣不再應用於固定價格的定製產品選項，而僅應用於產品的原始價格。

<!-- AC-6810-->

* 目錄價格規則現在考慮選定範圍，並僅應用於屬性具有與規則匹配的選項值的網站的產品。 以前，該規則未考慮多站點部署中的選定範圍。 [GitHub-36049](https://github.com/magento/magento2/issues/36049)

<!-- ACP2E-891-->

* 當購物者從「我的購物車」頁修改可配置產品時，色板選項的顏色和大小屬性現在將在產品詳細資訊頁中預先選定。 (jQuery 3.x版本現在支援 `swatchRenderer` 小部件名稱，現在是駝峰案例。) 以前，未預選色板選項。

<!-- ACP2E-1361-->

* 現在，當客戶訂閱價格下降警報時，客戶將收到產品價格下降的通知。 以前，由於應用程式級快取，不總是發送降價通知。

<!-- ACP2E-1348-->

* 基於SKU的目錄規則 **[!UICONTROL is not one of]** 現在條件按預期工作。

<!-- AC-729-->

* Magento Open Source不再錯誤地假定一個類別是基於類別路徑的另一個類別的父類別。 以前，當兩個類別相鄰且一個類別ID以另一個類別的類別ID開頭時，Adobe Commerce假定這些類別具有相同的父類別。 [GitHub-32464](https://github.com/magento/magento2/issues/32464)

### 可配置產品


<!-- ACP2E-1083-->

* 當管理員用戶將產品手動添加到已分配了許多簡單產品的可配置產品時，Magento Open Source不再引發錯誤。 以前，Magento Open Source顯示以下錯誤： `Something went wrong with processing the default view and we have restored the filter to its original state`。

<!-- AC-2877-->

* 在禁用背訂單的部署中，購物者不能再將可售數量為0的可配置產品添加到購物車中。 Magento Open Source現在表示產品庫存不足。 [GitHub-35319](https://github.com/magento/magento2/issues/35319)

<!-- AC-2678-->

* 通過從不同的商店視圖中導入具有多種選項的可配置產品來建立新產品，現在會按照預期生成第一個產品的精確副本。 以前，新產品的可配置選項的排序順序不正確，在具有多個儲存視圖和區域設定的部署中，標題未翻譯為新儲存視圖的區域設定。 [GitHub-35200](https://github.com/magento/magento2/issues/35200)

<!-- AC-535-->

* 具有所有庫存不足子產品的可配置產品現在在店面顯示為庫存不足。

<!-- AC-6852-->

* 可配置產品SKU和產品名稱現在可準確顯示。 以前，在將屬性組移到產品詳細資訊組上方後，名稱和SKU顯示為未定義 **[!UICONTROL Stores]** > **[!UICONTROL Attribute set]**。 [GitHub-36309](https://github.com/magento/magento2/issues/36309)


### 優惠券

<!-- ACP2E-1053-->

* 驗證邏輯已添加到「管理優惠券代碼」工作流中，以在生成優惠券時強制實施優惠券代碼設定。 以前，優惠券代碼生成忽略 **[!UICONTROL Code Length]** 設定 **贈券數量** 值大於2500。

<!-- ACP2E-1029-->

* 現在，當在使用PayPal Express付款方法結帳期間應用獎勵優惠券時，獎勵積分將按預期方式添加到客戶帳戶中。

<!-- ACP2E-1225-->

* 現在，當購物車價格規則具有權重作為條件時，您可以在建立管理訂單期間應用優惠券代碼。 以前，如果未為產品選擇其他欄位，則未設定優惠券代碼。 [GitHub-36271](https://github.com/magento/magento2/issues/36271)

<!-- ACP2E-1223-->

* 您現在可以按多個購物車價格規則篩選優惠券報告。 [GitHub-36272](https://github.com/magento/magento2/issues/36272)

<!-- AC-2812-->

* 當管理員用戶按下時，現在應用並保存自定義選項 **[!UICONTROL Enter]** 使用自定義選項配置產品時。 以前，您可以選擇選項並將產品添加到訂單中，但是這些選項未保存，並且管理員用戶會被提示重新選擇產品選項。 [GitHub-35284](https://github.com/magento/magento2/issues/35284)

<!-- AC-6688-->

* 現在，優惠券代碼可以成功導出到Excel XML。 以前，生成的檔案不包含所有選定的優惠券代碼，而只包含每個頁面選擇器中選擇的項目數。[GitHub-36073](https://github.com/magento/magento2/issues/36073)


### 克隆

<!-- ACP2E-1243-->

* 的 `catalog_index_refresh_price` cron作業現在成功執行。 以前，Magento Open Source在克隆執行期間記錄了此錯誤： `report.ERROR: Cron Job catalog_index_refresh_price has an error: SQLSTATE[HY093]: Invalid parameter number: number of bound variables does not match number of tokens`。

### 貨幣

<!-- ACP2E-1012-->

* 在店面和管理產品價格中都添加了自定義貨幣符號和價格之間缺少的空間。 添加了適當的條件和regex表達式，以允許在貨幣符號中自定義NBSP。 例如，IDRx 105.00先前顯示為IDRx105.00。


### 電子郵件


<!-- ACP2E-1063-->

* Magento Open Source在從管理員建立訂單後不再發送客戶重複的電子郵件。

<!-- ACP2E-1200-->

* 管理員訂單電子郵件在 **[!UICONTROL Email order confirmation]** 設定已禁用。 [GitHub-36256](https://github.com/magento/magento2/issues/36256)

<!-- ACP2E-1151-->

* 對於具有自定義選項的產品，影像選項不再顯示為貸項通知單、訂單確認和發票客戶電子郵件（預設模板）中的HTML標籤。

### 框架


<!-- AC-6385-->

* 管理員用戶現在可以成功開啟管理員 **[!UICONTROL Store]** > **[!UICONTROL Configuration]** 頁中沒有國家/地區 **歐盟國家** 設定&#x200B;**[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL General]** > **[!UICONTROL Country options]** > **[!UICONTROL European Union Countries]**)。 以前，當管理員用戶嘗試開啟此頁時，Magento Open Source拋出了以下錯誤： `TypeError: explode(): Argument #2 ($string) must be of type string, null given in /var/www/php/folder/vendor/magento/module-config/ViewModel/CountryFilter.php:46`。 [GitHub-35901](https://github.com/magento/magento2/issues/35901)

<!-- AC-6361-->

* `jquery.cookie` 依賴項現在可以按預期方式與JavaScript依賴項一起工作。 以前，您不能使用別名 `jquery/jquery.cookie`。 [GitHub-35913](https://github.com/magento/magento2/issues/35913)

<!-- AC-3226-->

* 的 `bin/magento i18n:collect-phrases` 現在包含 `<title>` 的子菜單。 [GitHub-35462](https://github.com/magento/magento2/issues/35462)

<!-- AC-6841-->

* `Magento\Framework\Code\Reader\ArgumentsReader::getParentCall()` 現在支援命名建構子參數。 現在，可以通過按參數名稱設定參數來調用函式。

<!-- ACP2E-1287-->

* 錯誤現在按預期記錄在 `exception.log` 的子菜單。 以前，雖然錯誤已記錄在 `system.log` 檔案，未登錄錯誤 `var/log/exception.log`。

<!-- AC-3758-->

* 商家現在可以指定自定義外部SMTP提供程式。 [GitHub-26104](https://github.com/magento/magento2/issues/26104)

<!-- AC-3752-->

* 現在，在運行2.4.3-p2Magento Open Source的部署中，可以按照預期重新授權OAuth整合。 以前，重新授權失敗，錯誤為： `The attempt to post data to consumer failed due to an unexpected error. Please try again later`。 Magento Open Source還嘗試解密未加密的值。 [GitHub-35313](https://github.com/magento/magento2/issues/35313)

<!-- ACP2E-1201-->

* 正確 `rowId` 現在，在類別 `urlKey` 保存為具有子類別的類別。 以前，錯誤 `categoryId` 保存類別時傳遞 `URLKey`。

<!-- ACP2E-981-->

* 產品屬性代碼 `event` 已添加到保留產品屬性代碼清單中，這消除了與在儲存面上使用此名稱的屬性相關的錯誤。 以前，應用程式在以下情況下將此錯誤引入產品詳細資訊和搜索/產品清單頁 `event` 已使用：  `report.CRITICAL: Error: Call to a member function getStatus() on string in /home/mer33515/public_html/ee24develop/magento2ee/app/code/Magento/CatalogEvent/Observer/ApplyIsSalableToProduct.php:23`。

<!-- AC-5985-->

* 現在，訂單放置期間出現的店面驗證錯誤消息將始終顯示。 以前，資訊出現、折疊，然後重新出現。 [GitHub-35651](https://github.com/magento/magento2/issues/35651)

<!-- AC-2943-->

* AMQP使用者不再因已棄用而失敗 `trim()` 運行PHP 8.1的部署上的函式。以前，當AMQP使用者在安裝後啟動時，Magento Open Source拋出了以下錯誤： `Deprecated Functionality: trim(): Passing null to parameter #1 ($string) of type string is deprecated in .../vendor/magento/framework-amqp/Config.php on line 143`。 [GitHub-35380](https://github.com/magento/magento2/issues/35380)

<!-- AC-2882-->

* 的 `getFilteredTimerIds` 方法現在按預期工作。  類 `Magento\Framework\Profiler\Driver\Standard\Stat` 現在相容於PHP 8.1。以前，Magento Open Source調用此方法時引發異常。 [GitHub-35307](https://github.com/magento/magento2/issues/35307)

<!-- AC-2784-->

* 已刪除對 `imagemin-svgo` 的下界。

<!-- AC-2058-->

* 當第一個注釋以開始時，精簡模板進程現在已成功處理連續的注釋 `//`。 [GitHub-34880](https://github.com/magento/magento2/issues/34880)

<!-- AC-2241-->

* 已更正由 `BundleGraphQl` 返回此錯誤的模組： `"debugMessage": "Notice: Undefined offset: 16 in vendor/magento/module-bundle-graph-ql/Model/Resolver/Options/Collection.php on line 130"`。[GitHub-34991](https://github.com/magento/magento2/issues/34991)


### 常規修復


<!-- ACP2E-1068-->

* Magento Open Source現在顯示管理員用戶選擇 **[!UICONTROL Last 24 Hours]** 選項。 以前，Magento Open Source顯示的時間範圍不正確。 發生此情況是因為資料庫的時區保持不變。

<!-- ACP2E-1066-->

* 現在可以為整數和小數數量生成貸項通知單。 以前，僅支援整數量。

<!-- ACP2E-1001-->

* 類型的客戶郵遞區號輸入驗證規則 **僅限數字** 現在按預期工作 **[!UICONTROL Edit Customer Address]** 欄位(D)**[!UICONTROL Store]** > **[!UICONTROL Attribute]** > **[!UICONTROL Customer Address]**)。 以前，客戶地址資訊是在沒有郵遞區號驗證的情況下保存的。

<!-- ACP2E-873-->

* 全局共用的客戶帳戶現在具有根據當前網站允許的國家/地區清單進行驗證並成功保存的地址。 以前，這些帳戶與註冊客戶的網站允許的國家/地區的驗證不正確。

<!-- AC-3167-->

* 當CMS頁層次結構中的Breadcrumb不再顯示 **[!UICONTROL Enable Hierarchy Functionality]** 已禁用。 以前，會顯示麵包屑，當購物者點擊它們時，會顯示404頁。 [GitHub-35513](https://github.com/magento/magento2/issues/35513)

<!-- AC-2567-->

* 通過管理員從所有網站中刪除產品不再導致以下錯誤： `SQLSTATE[42000]: Syntax error or access violation`。 [GitHub-35133](https://github.com/magento/magento2/issues/35133)

<!-- AC-2235-->

* 超過最大登錄失敗次數的客戶現在可以在密碼重置後登錄。 [GitHub-34981](https://github.com/magento/magento2/issues/34981)

<!-- AC-2020-->

* 當管理員用戶添加新元素時，動態行元件現在的行為與預期一致。 以前，將新的簡單產品添加到分組產品時，行元件的行為不正確。 [GitHub-34850](https://github.com/magento/magento2/issues/34850)

<!-- magento/magento2/pull/35598-->

* 中已更正的字母和錯誤語法 `app/code/Magento/Backend/etc/menu.xsd` 的子菜單。

<!-- magento/magento2/pull/35818-->

* 的 `app/code/Magento/Authorization/README.md` 已更新檔案以準確描述表建立。

<!-- magento/magento2/pull/35940-->

* 的 `recordLogin` 方法已更新，以在用戶模型上設定登錄值並在 `logdate` 和 `lognum` 的 `admin_user` 的子菜單。 以前，未記錄更新的管理員用戶的登錄嘗試。

<!-- magento/magento2/pull/35990-->

* GitHub發佈模板已轉換為發佈表單，以便獲得開發人員體驗問題和功能請求。

<!-- ACP2E-961-->

* 的 `Is required` 現在，根據管理客戶編輯表單的網站範圍正確實施customer屬性。

<!-- ACP2E-895-->

* 的 **[!UICONTROL Grid Filter Condition Type]** 當屬性編輯頁中的「客戶」和「客戶地址」屬性的欄位 **[!UICONTROL Use in Filter Option]s** 設定已禁用。

<!-- AC-6020-->

* Magento Open Source現在顯示一條資訊性錯誤消息，如果商家在建立產品時未能輸入可選的SKU屬性值。 以前，當屬性為可選時，應用程式引發此異常： `Deprecated Functionality: trim(): Passing null to parameter #1 ($string) of type string is deprecated in /var/www/html/mg244/project-community-edition/vendor/magento/module-eav/Model/Entity/AbstractEntity.php on line 932`。 [GitHub-35810](https://github.com/magento/magento2/issues/35810)

<!-- ACP2E-716-->

* 的 **[!UICONTROL Show my quotes]** 篩選 **[!UICONTROL My Quotes]** 頁面現在按預期工作。 以前，篩選結果包括其他管理員用戶的引號。


### GraphQL


<!-- AC-1730-->

* `Types` 在GraphQL代碼中實現多個介面時， `&` 還有 `,` 根據GraphQL `@doc`規範。

<!-- ACP2E-885-->

* 的 `setShippingAddressesOnCart` 變異現在支援將數字區域代碼設定為 `region`。 以前，此變異對數字區域代碼值工作不正確。

<!-- ACP2E-1237-->

* 的 `products` 查詢現在只返回與指定範圍關聯的審閱。 以前，查詢會從所有商店返回評論。

<!-- ACP2E-882-->

* 目前，在GraphQL請求期間，類別權限受到尊重。

<!-- AC-1805-->

* 的 `customer` 查詢現在篩選具有指定的訂單 `from` 和 `to` 範圍正確。 [GitHub-31537](https://github.com/magento/magento2/issues/31537)

<!-- AC-5984-->

* 的 `product` 查詢現在將返回聚合中正確的類別資料。 以前， `attribute_code.category_uid` 返回的值 `category_id` 而不是 `category_uid`。

<!-- AC-6084-->

* 的 `customerOrders` 查詢不再引發 `\"model\" value should be specified`錯誤。 [GitHub-35852](https://github.com/magento/magento2/issues/35852)

<!-- ACP2E-894-->

* 的 `customer` 查詢現在根據範圍篩選訂單。 現在，您可以指定查詢應按商店、網站還是全局篩選訂單。

<!-- ACP2E-1172-->

* 的 `categoryList` 查詢現在會為已定位和未定位父類別返回準確的產品計數。 新 `is_anchor` 屬性已添加到類別集合選定列清單中。 以前，請求返回0個產品計數。 [GitHub-36300](https://github.com/magento/magento2/issues/36300)

<!-- AC-2500-->

* 的 `generateCustomerTokenAsAdmin` 現在，在建立令牌以登錄到多儲存部署中的非預設儲存時，變異會按預期工作。 [GitHub-35084](https://github.com/magento/magento2/issues/35084)

<!-- AC-1731-->

* 的 `createEmptyCart` 現在，當使用到期的令牌時，突變會引發異常。 [GitHub-26112](https://github.com/magento/magento2/issues/26112)

<!-- AC-1965-->

* 購物車查詢錯誤消息已變得更具說明性。 [GitHub-34546](https://github.com/magento/magento2/issues/34546)

<!-- AC-2798-->

* 響應中的聚合資料 `products` 查詢現在包括價格類型屬性的正確值 `attribute_code` 和 `label`。 [GitHub-28878](https://github.com/magento/magento2/issues/28878)

<!-- AC-6685-->

* 的 `products` 查詢返回資料庫前置詞具有非null值時預期的類別資訊。 以前，它返回 `Internal server error`。 [GitHub-36117](https://github.com/magento/magento2/issues/36117)

<!-- AC-1003-->

* 已更正 `getCustomerIsGuest` 的雙曲餘切值。 [GitHub-29529](https://github.com/magento/magento2/issues/29529)

<!-- B2B-2221-->

* 的 `Magento\CatalogGraphQl\Plugin\DesignLoader` 插件。

<!-- B2B-2379-->

* 現在，只有當由GraphQL突變初始化購物車時，才按預期觸發一次購物車重裝。 以前，購物車裝載觸發了對庫存庫存的不必要的購物車重新驗證，每次裝載購物車時庫存消耗了大量資源。

<!-- AC-1726-->

* 已添加 `gift_message` 鍵入 `OrderItemInterface`。 [GitHub-29418](https://github.com/magento/magento2/issues/29418)

<!-- AC-2454-->

* 現在，在GraphQL響應中返回的產品選項只包括用戶所屬目錄內的產品。 如果用戶屬於共用目錄，則只返回共用目錄中的產品。 如果用戶是來賓或不是自定義共用目錄的一部分，則只返回公共目錄中的產品。


### GoogleReCAPTCHA

<!-- AC-3179-->

* 中的reCAPTCHA錯誤 `var/log/exception.log` 已解析GoogleV3 reCAPTCHA管理員登錄的檔案，並且未記錄錯誤消息。 以前，管理員用戶配置以下錯誤時每隔幾秒鐘就會引發一次 **[!UICONTROL Configuration]** > **[!UICONTROL Security]** > **[!UICONTROL Google reCAPTCHA Admin Panel]** 設定： `main.ERROR: Can not resolve reCAPTCHA parameter. {"exception":"[object] (Magento\Framework\Exception\InputException(code: 0): Can not resolve reCAPTCHA parameter. at /home/xxxxxxx/public_html/vendor/magento/module-re-captcha-ui/Model/CaptchaResponseResolver.php:25)"} []`。 [GitHub-34975](https://github.com/magento/magento2/issues/34975)


### 影像

<!-- ACP2E-905-->

* 已更新PDF發票單的徽標大小的建議。


### 導入/導出


<!-- ACP2E-957-->

* 導入與現有產品具有相同數字URL鍵但沒有其終端字母字元的產品時，不再導致驗證錯誤 **[!UICONTROL Product URL Suffix]** 在Admin中設定為空。

<!-- AC-6588-->

* 的 `bin/magento app:config:import`命令現在已成功導入 `config.php` 包含特定 `cron` 表達式。 以前，導入失敗，出現以下錯誤： `Import failed: Notice: Trying to access array offset on value of type null in [..]/vendor/magento/module-config/Model/Config/Backend/Currency/Cron.php on line 66`。 [GitHub-31428](https://github.com/magento/magento2/issues/31428)

<!-- ACP2E-1289-->

* 當將AWSS3用作遠程儲存時，完全導出現在正常工作。 以前，由於上載的檔案大小，導出失敗。

<!-- ACP2E-982-->

* 當CSV檔案中的清單資料列丟失時，產品狀態現在正確導入。 以前，在產品導入後，預設來源會自動分配給產品，其數量設定為零，並且當CSV檔案中的庫存資料列丟失時，其狀態將列為缺貨。

<!-- ACP2E-841-->

* 現在，導入預付定價值可在導入包含100條以上記錄時為新記錄和更新記錄提供正確的計數。 以前，導入成功消息提供了錯誤計數。

<!-- ACP2E-984-->

* 導出的CSV檔案現在包含以多種語言保存的類別名稱的正確路徑。 已為類別集合添加儲存ID。 以前，導出的檔案包含具有不同語言的混合路徑，而不是從預設儲存視圖派生的類別路徑。

<!-- ACP2E-1319-->

* 通過導入在特定商店視圖中更新產品的自定義選項現在成功完成。 以前，如果將與產品相關的行拆分為多個批，則會引發內部伺服器錯誤。

<!-- AC-6926-->

* 的 `Fixer.io` 導入服務現在按預期工作。 現在已成功導入匯率。 [GitHub-36010](https://github.com/magento/partners-magento2ee/issues/36010)

### 索引

<!-- ACP2E-1296-->

* 當目錄包含捆綁產品未分配給任何網站時，價格重新索引現在可以成功運行。 以前，在運行產品價格指數時發生以下錯誤： `Warning: Undefined array key <bundel product id > in vendor/magento/module-bundle/Model/ResourceModel/Indexer/Price/DisabledProductOptionPriceModifier.php on line 117`。 [GitHub-35796](https://github.com/magento/magento2/issues/35796)

### 基礎設施

<!-- AC-5972-->

* 與第三方的問題 `colinmollenhour/php-redis-session-abstract` 模組和PHP 8.1已解決。 [GitHub-35634](https://github.com/magento/magento2/issues/35634)


### 訂單

<!-- ACP2E-998-->

* 現在，在安裝指令碼中傳遞的順序前置詞已正確添加到順序ID中。

<!-- ACP2E-790-->

* 當訂單包含具有長自定義文本值的產品時，訂單詳細資訊頁面現在已成功載入。 以前，未載入訂單詳細資訊頁面，並且 `sales_order_item.product_options` 如果產品包含文本自定義選項的長值，則列未正確儲存。

<!-- AC-3178-->

* 現在，部分退貨訂單的店面訂單狀態準確。 以前，在應用部分退款時，訂單仍處於裝運後處理狀態。 [GitHub-35528](https://github.com/magento/magento2/issues/35528)

<!-- AC-3031-->

* 客戶組現在準確表示為 **未登錄** 來賓用戶建立的訂單。 以前，客戶組在來賓訂單摘要中為空，這影響了確認電子郵件和訂單導出。 [GitHub-35440](https://github.com/magento/magento2/issues/35440)

<!-- AC-2811-->

* 狀態 **[!UICONTROL Closed]** 在發出貸項通知單並退回客戶後，現在按預期分配給虛擬訂單。 以前，虛擬產品顯示為 **[!UICONTROL Complete]** 的子菜單。 **[!UICONTROL Closed]** 從管理員添加註釋時，在訂單注釋的頁腳中。 [GitHub-35283](https://github.com/magento/magento2/issues/35283)

<!-- AC-6641-->

* 現在，客人可以訂購數量少於一的產品，產品數量現在嚴格按 `float`。 以前，因為產品數量嚴格鍵入為 `int`，產品數量少於一個的訂單失敗，消息為： `Some of the products are disabled`。 [GitHub-36060](https://github.com/magento/magento2/issues/36060)

<!-- ACP2E-1313-->

* 現在，在 **[!UICONTROL Apply discount on prices]** 配置選項設定為 **[!UICONTROL including taxes]**。

<!-- ACP2E-1199-->

* 在存檔訂單後，發票、發運和貸項通知單網格現在非同步更新。

<!-- ACP2E-1194-->

* 重複的訂單不再由同時、相同的GraphQL請求產生。 現在，為防止重複建立訂單，報價鎖定時間長達10秒，第二個請求失敗，出現以下錯誤： `The cart isn't active` 或 `The order has already been placed and is currently processing`。 此鎖定值可通過di為 `Magento\Quote\Model\PlaceOrderMutex` 類 `lockWaitTimeout` 的下界。 [GitHub-36274](https://github.com/magento/magento2/issues/36274)

<!-- ACP2E-860-->

* 現在，在結帳工作流的開單地址和發運地址部分中，公司屬性值將按預期顯示。 以前，公司屬性未正確顯示在訂單詳細資訊頁上，因為在建立訂單期間未正確設定商店。 僅當 **顯示公司** 屬性設定為 **[!UICONTROL optional]** 為 **主網站** 在多儲存部署中。

<!-- ACP2E-1117-->

* 的 `customer_address_id` 值現在設定為新開單地址的預期值 **[!UICONTROL My billing and shipping address are the same]** 複選框。 在為發運地址設定客戶地址ID之前，已引入附加條件以確定開單地址是否與發運地址相同。

<!-- AC-6057-->

* 已解決訂單放置的併發問題。 以前，如果兩個訂單來自不同瀏覽器的同一時間或幾乎相同時間，則這兩個訂單的訂單ID相同。 [GitHub-35833](https://github.com/magento/magento2/issues/35833)

<!-- AC-6908-->

* 啟用非同步索引時為免費產品自動開票訂單現在可以按預期方式工作。 未向 `sales_order_grid or sales_invoice_grid` 表格。 以前，Magento Open Source引發異常，因為應用程式嘗試在放置訂單期間對網格進行索引，而不是依賴 `cron`。 [GitHub-36334](https://github.com/magento/magento2/issues/36334)


### 付款方法


<!-- ACP2E-862-->

* 當對發運和開單地址中指定的國家/地區豁免COD時，COD付款方法不再在店面結帳工作流中提供。 以前未實現此功能的管理配置設定。

<!-- AC-1119-->

* 如果購物者未保存令牌，則電子倉庫付款資訊將不再顯示在管理訂單建立工作流的「付款」部分。 [GitHub-33954](https://github.com/magento/magento2/issues/33954)

<!-- AC-2688-->

* 按購物車價格規則應用折扣後，自定義價格不再翻倍。 [GitHub-35154](https://github.com/magento/magento2/issues/35154)

<!-- ACP2E-1120-->

* 當使用零小計結帳付款方法下達訂單時，新訂單的待定狀態將按照預期執行。

<!-- ACP2E-1121-->

* 在通過GraphQL為PayPal Express的客購者建立訂單期間，客郵設定現在受到尊重。 以前，電子郵件地址集被PayPal帳戶中的電子郵件地址集所覆蓋。


#### Braintree


<!-- BUNDLE-3186-->

* 現在，訂單ID將添加到付款交易記錄的結算請求中。

<!-- AC-3030-->

* Magento Open Source在商家按一下時不再引發以下錯誤 **[!UICONTROL Reports]** > **[!UICONTROL Braintree Settlement]**: `Error: Undefined constant Braintree\PaymentInstrumentType::ANDROID_PAY_CARD in /var/www/html/vendor/paypal/module-braintree-core/Ui/Component/Report/Listing/Column/PaymentType.php:49`。 [GitHub-35434](https://github.com/magento/magento2/issues/35434)

<!-- BUNDLE-3043-->

* 的 `customerPaymentTokens` 當管理員關閉保管庫時，query不再返回Braintree令牌。

<!-- BUNDLE-3107-->

* 的 **[!UICONTROL Pay Later]** 為義大利和西班牙啟用了按鈕和橫幅。

<!-- BUNDLE-3137-->

* 管理員用戶現在可以在啟用Braintree付款方法時建立訂單或重新排序。 以前，Magento Open Source拋出了以下錯誤： `report.CRITICAL: Error: Call to a member function getMethodInstance() on null in /app/vendor/paypal/module-braintree-core/Block/Form.php:174`。

<!-- BUNDLE-3139-->

* 啟用BraintreePayPal並成功完成使用Braintree付款方法的結帳 **[!UICONTROL Enable Card Payments]** 已禁用。 以前，進度欄從未解析，Magento Open Source顯示以下控制台錯誤： `adapter.js:66 Uncaught TypeError: Cannot read properties of undefined (reading 'clientToken')at Object.getClientToken (adapter.js:66:66)`。 [GitHub-35961](https://github.com/magento/magento2/issues/35961)

<!-- BUNDLE-3140 3141-->

* 實現了欺詐防護、ACH支付和本地支付方式網路掛接。 僅當在Braintree中作出風險決定時才觸發欺詐保護網鈎。 僅當ACH付款更新為 `settled` 或 `settlement decline`。

<!-- BUNDLE-3143-->

* 的 **[!UICONTROL Tagline]** 和 **[!UICONTROL Layout]** 已從所有配置欄位中刪除 **[!UICONTROL PayPal]** 按鈕。

<!-- ACP2E-1229-->

* 當購物者更新其付費地址時，Braintree保管庫付款方法選項仍在結賬工作流中處於選中狀態。 以前，當購物者取消選擇付款方式時， **[!UICONTROL My billing and shipping address are the same]** 按鈕

<!-- BUNDLE-3184-->

* 現在，在PayPal交易記錄 **[!UICONTROL Send Line Items]** 已從管理中啟用配置設定。

<!-- BUNDLE-3187-->

* ACH付款方法的驗證邏輯 **[!UICONTROL Account Number]** 欄位現在支援4到17位文本。

<!-- BUNDLE-3043-->

* 的 `customerPaymentTokens` 當從管理員關閉保管庫時，query不再返回Braintree令牌。

<!-- BUNDLE-3137-->

* 管理員用戶現在可以在啟用Braintree付款方法時為客戶建立訂單或重新排序。 以前，Magento Open Source拋出了以下錯誤： `report.CRITICAL: Error: Call to a member function getMethodInstance() on null in /app/vendor/paypal/module-braintree-core/Block/Form.php:174`

<!-- BUNDLE-3139-->

* 購物者現在可以在店面使用Braintree支付方式 **[!UICONTROL Enable Card Payments]** 已禁用。 以前，Magento Open Source拋出了此JavaScript錯誤： `_adapter.js:66 Uncaught TypeError: Cannot read properties of undefined (reading 'clientToken')at Object.getClientToken (adapter.js:66:66).`


#### 效能

<!-- ACP2E-1028-->

* 現在，價格索引器在對大型目錄進行部分重新索引期間替換記錄後，按預期刪除過時的資料。 以前，重新編製索引的過程在替換過時記錄之前刪除了這些記錄，這導致產品偶爾會從店面暫時消失。 [GitHub-35616](https://github.com/magento/magento2/issues/35616)

<!-- ACP2E-963-->

* 的效能 `bin/magento/setup:upgrade` 指令已得到改進。 以前，此命令重新建立了資料庫觸發器，這在命令執行過程中造成了嚴重的停機時間。 此外，索引器未恢復為計畫模式，並且仍處於保存模式。 [GitHub-33386](https://github.com/magento/magento2/issues/33386)

<!-- ACP2E-1016-->

* 現在，通過API更新層價格的執行速度更快。 以前，更新層價格產生了不必要的 `SELECT` 查詢，當將多個客戶組分配給產品時，該查詢會延遲執行。

<!-- ACP2E-1307-->

* 已優化包含目錄構件產品清單的頁面的載入。 以前，非全局屬性是直接從資料庫載入的。

### 報告

<!-- ACP2E-1104-->

* 訂單合計報表 **從** 和 **至** 從日期選取器中選擇後，現在將正確顯示日期。

<!-- BUNDLE-3147-->

* 的 `ANDROID_PAY_CARD` 常數 `Braintree/Ui/Component/Report/Listing/Column/PaymentType.php` 已更換 `GOOGLE_PAY_CARD`。 這解決了Braintree報告的問題。

### 評論

<!-- ACP2E-1214-->

* 對特定範圍具有限制訪問權限的管理員用戶現在可以按預期刪除產品評論。

### 角色

<!-- ACP2E-1277-->

* 已添加缺少的ACL **[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL Services]** > **[!UICONTROL OAuth]**。 以前，在設定角色權限時，您無法定義對此OAuth配置設定的訪問權限。


### 搜索

<!-- ACP2E-989-->

* 搜索引號內的字串時，現在可以按預期工作 **[!UICONTROL Minimum Terms to Match]** 配置設定已啟用。 以前，Magento Open Source拋出了以下錯誤： `{"error":{"root_cause":[{"type":"parsing_exception","reason":"[match_phrase] query does not support [minimum_should_match]' ...`。

<!-- ACP2E-877-->

* 的 **註冊點** 在銷售訂單客戶網格上搜索客戶記錄的篩選器現在可以在建立訂單期間按預期工作。

<!-- ACP2E-783-->

* 對多詞查詢的搜索建議質量得到了提高。

<!-- AC-6768-->

* 搜索結果現在包括所有可用產品的非庫存選項輸出 **[!UICONTROL Display Out Of Stock Products]** 已啟用 [GitHub-36055](https://github.com/magento/magento2/issues/36055)


### 裝運

<!-- ACP2E-670-->

* 當「免費發運購物車」規則設定為僅匹配購物車中的一部分物料時，可正確計算FedEx、USPS和UPS的發運費率。

<!-- AC-937-->

* 當訂單總額小於符合免費發運條件的指定最小訂單金額時，「管理」發運頁將不再顯示免費發運選項。 [GitHub-33697](https://github.com/magento/magento2/issues/33697)

<!-- AC-838-->

* Magento Open Source現在尊重管理員客戶 **[!UICONTROL Show Company]** 顯示發運或客戶地址時的配置設定。 禁用此設定後，發運公司將不再包括在發運、客戶地址或資料庫訂單記錄中。 以前，儘管設定了禁用，但仍顯示該資訊。 [GitHub-33729](https://github.com/magento/magento2/issues/33729)

<!-- magento/magento2/pull/35631-->

* 在估計發運時，已刪除報價上的多餘保存操作。

<!-- magento/magento2/pull/35817-->

* `storeId` 範圍現在直接從 `$request->getStoreId()` 以確保在管理員用戶建立報價時作用域不會丟失。 以前，在使用第三方模組從管理員建立報價時，發運方法偶爾會出現問題。

<!-- ACP2E-1304-->

* 現在為其 `url_key` 在儲存視圖級別上覆蓋設定。 以前，類別產品URL未重定向到SEO友好URL。

<!-- ACP2E-1196-->

* Magento Open Source在將折扣應用於發運成本時不再拋出最小訂單金額錯誤。

<!-- ACP2E-1190-->

* 現在，在對發運應用折扣後應用稅時，將正確計算發運退款。

<!-- ACP2E-910 AC-3182-->

* 通過GraphQL申請購物車的所有適用促銷 `cart` 查詢一起返回。 促銷包括行項目折扣、購物車規則/折扣、優惠券、禮品卡和商店信用。 [GitHub-35545](https://github.com/magento/magento2/issues/35545)

<!-- AC-2363-->

* 已添加 `price_excl_tax` 和 `price_excl_tax` 類型到輸出 `setShippingMethodsOnCart` 變異。 [GitHub-31206](https://github.com/magento/magento2/issues/31206)

<!-- AC-1096-->

* 現在，在GraphQL響應中，將按照預期傳遞唯一發運ID，並將訂單發運詳細資訊傳送至多個地址以進行GraphQL查詢。

### 稅


<!-- AC-3201-->

* 的 **[!UICONTROL Display Zero Tax Subtotal]** 配置設定現在按預期應用於提供多種發運方法的部署中的訂單。 以前，在選擇發運方法之前，零稅欄位在簽出期間在購物車頁上可見，即使禁用了此設定也是如此。 [GitHub-35561](https://github.com/magento/magento2/issues/35561)

<!-- AC-3157-->

* Magento Open Source現在可以在運行PHP 8.1的部署中在店麵類別頁上顯示帶稅的分組產品。以前，Magento Open Source未顯示產品清單並拋出此異常： `main.CRITICAL: Exception: Deprecated Functionality: ucfirst(): Passing null to parameter #1 ($string) of type string is deprecated in /var/www/m24/vendor/magento/module-tax/Pricing/Render/Adjustment.php on line 188 in /var/www/m24/vendor/magento/framework/App/ErrorHandler.php:61`。 [GitHub-35500](https://github.com/magento/magento2/issues/35500)

<!-- ACP2E-1258-->

* 商家無法再將計畫更新移到包含相同規則ID的其他更新。 以前，將更新移至包含相同規則ID的其他更新時，購物車價格規則的計畫更新會建立重複的計畫。

<!-- ACP2E-1295-->

* 當沒有與客戶地址關聯的增值稅標識時，自動客戶組分配現在有效。 如果地址不包含增值稅ID，則該地址被視為屬於非增值稅註冊客戶，而Magento Open Source會將客戶組更改為非增值稅組。 以前， **[!UICONTROL Enable Automatic Assignment to Customer Group]** 已啟用，未自動將客戶帳戶分配給 `customerGroup` VAT ID從客戶帳戶中刪除時。

<!-- ACP2E-493-->

* 現在，在轉移預覽模式下，已轉移的目錄規則顯示了正確的動態塊。 以前，顯示了不相關的動態塊。

<!-- ACP2E-1080-->

* 在結帳期間應用多發運時，發票和貸項通知單的「稅匯總」部分現在可以正確顯示多個稅。

<!-- ACP2E-1076-->

* 如果訂單小計（包括稅和固定產品稅額）超過購物車頁上的購物車規則條件，則不再應用折扣。 以前，即使總折扣超過購物車規則條件，也會應用折扣。

<!-- ACP2E-913-->

* 現在可以指定 `vat_id` 使用GraphQL添加或更新顧客地址時。


### Test

<!-- ACP2E-1171-->

* 不同版本的固定設備test錯誤 `ICU` 和 `libxml` 庫。

<!-- ACP2E-1134-->

* 開發人員現在可以指示系統在特定儲存視圖中執行資料夾具。 新的可選參數 `scope` 接受 `string` 與儲存夾具別名相對應。

<!-- ACP2E-1133-->

* 已添加使用可選夾具生成多個實例的能力 `count` 的下界。

<!-- AC-6860-->

* 已刪除非本機 `array_first` 函式。

### 翻譯和區域設定

<!-- ACP2E-912-->

* 現在，內聯翻譯在SCRIPT標籤中的短語中包含擴展Unicode字元的特殊字元時正常工作。 以前，在使用內聯翻譯時，在編輯的指令碼中日文字元呈現不正確。

<!-- ACP2E-844-->

* 的 `ñ` 產品名稱中的字元現在轉換為 `n` 在生成URL密鑰期間。

<!-- AC-3499-->

* 運行的輸出 `bin/magento i18n:collect-phrases` 現在包括郵件模板翻譯 `depend` 構造。 [GitHub-35449](https://github.com/magento/magento2/issues/35449)

<!-- ACP2E-1135-->

* 現在，可以將日文字元直接輸入到產品頁屬性集（組合框）中。 以前，在MacOS上運行Firefox瀏覽器時，直接在此組合框中輸入日文字元會導致更改或刪除字元。 的 `textInput` HTML屬性已替換 `Value` 和 `valueUpdate` 屬性。

<!-- ACP2E-1238-->

* 的 `getOptions` 現在正確讀取 `price` 屬性標籤值基於儲存視圖。 以前， `price` 屬性在GraphQL操作期間被轉換為不正確的儲存視圖。


### UI


<!-- ACP2E-1018-->

* 現在，Admin產品網格中的「特殊價格」、「成本」和MSRP列使用網站特定的貨幣。 以前，當按商店視圖按特定價格篩選時，正確的貨幣符號不會顯示在管理目錄產品網格中。

<!-- ACP2E-980-->

* 產品定制選項的拖放功能現在可以按預期工作。 現在，當可自定義選項網格中有多個頁面可用時，您可以將可自定義選項從一個頁面移到另一個頁面。

<!-- ACP2E-866-->

* 管理員儀表板圖表現在按預期顯示從當前日曆年開始到當前日期的YTD時間間隔。 以前，日期範圍包括超過12個月。

<!-- AC-3088-->

* 已添加店面首頁上缺少的預設表徵圖。 [GitHub-35493](https://github.com/magento/magento2/issues/35493)

<!-- ACP2E-1025-->

* 管理員現在成功顯示每個管理員用戶的最新登錄日期。 以前，當管理員用戶首次登錄到管理員時，管理員用戶網格上會顯示一個空登錄日期值。


<!-- AC-3762-->

* 預覽電子郵件模板功能(**[!UICONTROL Marketing]** > **[!UICONTROL Communications]** > **[!UICONTROL Email Templates]**)現在正確顯示模板。 以前，預覽影像被截斷。 [GitHub-35697](https://github.com/magento/magento2/issues/35697)

<!-- magento/magento2/pull/35656-->

* 已添加 `new-shipping-address-modal` 類以支援新發運地址模式的樣式。

<!-- magento/magento2/pull/35738-->

* 在 `Search Weight` 屬性 `Storefront Properties` 管理員上的輸入欄位 **[!UICONTROL Stores]**  > [!UICONTROL Attributes] > **[!UICONTROL Product]**。

<!-- ACP2E-1323-->

* 現在，電子郵件預覽在單獨的頁籤中開啟，而不是彈出窗口，該窗口提供了電子郵件內容的更廣視圖。 以前，電子郵件內容被截斷。

<!-- ACP2E-1299-->

* 用戶角色網格的篩選器功能(管理 **[!UICONTROL System]** > **[!UICONTROL Permissions]** > **[!UICONTROL User roles]** > **[!UICONTROL Administrators]**)現在按預期工作。 陣列值現在單獨處理。 以前，當您嘗試在此網格中輸入查詢時，Magento Open Source引發了此控制台錯誤，並且該頁未載入： `Uncaught TypeError: Cannot read properties of null`。 [GitHub-35993](https://github.com/magento/magento2/issues/35993)

<!-- ACP2E-328-->

* 通過REST API建立客戶時，已添加了屬性值驗證。 如果提供了無效的屬性值，則建立過程將失敗。 以前沒有對性別進行確認，這不是必填領域。 在建立客戶期間，為性別傳遞的值保存在 `customer_entity` 的子菜單。

<!-- ACP2E-1105-->

* 簽出過程中添加的地址現在保留其預期格式。 以前忽略了空行。

<!-- ACP2E-897-->

* 更改產品網格的列網格視圖和為自定義視圖選擇新列不再觸發「選擇所有網格列」操作。 以前，列框消失，網格中的產品被選中或取消選中。 [GitHub-36302](https://github.com/magento/magento2/issues/36302)

<!-- ACP2E-1245 1405-->

* 管理員用戶現在可以成功清除管理員已完成的任務日誌。 以前，管理員顯示以下錯誤： `Something went wrong`。 [GitHub-36255](https://github.com/magento/magento2/issues/36255)

<!-- AC-7525-->

* 主題標題設定 `Welcome Text` 現在可以包含單引號字元。 以前，Magento Open Source拋出了此JavaScript錯誤： `Uncaught SyntaxError: Unable to process binding "ifnot: function(){return customer().fullname }"`。

### URL重寫

<!-- ACP2E-808-->

* 將產品可見性更改為 **[!UICONTROL Not Visible Individually]** 現在，在全局「所有儲存視圖」作用域中，只刪除未覆蓋可見性屬性的儲存視圖的URL重寫。 以這種方式更改產品可見性還會為所有儲存視圖(包括那些已覆蓋URL鍵屬性（但不是可見性設定）的視圖生成URL重寫。 以前，當可見性設定更改時未應用URL重寫規則。

### Web API框架

<!-- ACP2E-1207-->

* REST API `DELETE /rest/V1/products/:sku/media/:entryId` 現在，如果映像未從產品中刪除，則返回一條錯誤消息，因為該映像已分配給其他儲存視圖中的角色。 以前，即使映像未成功刪除，API仍返回成功響應。

<!-- ACP2E-1155-->

* 商家現在可以使用REST API為總計為零的訂單建立貸項通知單。 以前，Magento Open Source顯示以下錯誤： `The order does not allow a credit memo to be created. The credit memo's total must be positive. We can't create a credit memo for the invoice/order`。

<!-- ACP2E-1136-->

* 使用REST API更改了產品的網站分配後，「管理產品」編輯頁現在可以準確反映產品的分配。 [GitHub-36281](https://github.com/magento/magento2/issues/36281)

<!-- ACP2E-863-->

* 在批量REST API請求更新產品期間，不能再為多選屬性包含重複的選項ID。 以前，在發送批量API請求以更新產品時，可以為多選屬性設定重複的選項ID。 當將該多選擇屬性配置為包含在分層導航中時，EAV索引失敗， `Duplicate entry` 錯誤。

<!-- ACP2E-778-->

* 購物車中的產品名稱現在使用指定商店視圖的值（如預期）。 以前，購物車中的產品名稱始終在REST API購物車響應中返回預設的商店視圖值。

<!-- AC-5986-->

* 現在，可以使用REST API更新購物車物料自定義選項值。 [GitHub-35768](https://github.com/magento/magento2/issues/35768)

<!-- AC-1330-->

* 超過20個的批量API請求 `sourceItems` 現在，在啟用清單的部署中成功完成。

<!-- ACP2E-1044-->

* 現在，Fulecher貨幣服務在通過ApiLayer生成的密鑰中可以按預期工作，並且貨幣匯率已正確導出。 以前，Magento Open Source嘗試通過管理員導入匯率時出錯。

<!-- ACP2E-726-->

* 現在可以使用REST API `/rest/V1/bulk?searchCriteria[filter_groups]` 請求按搜索條件查詢批量操作。 以前，返回了以下錯誤： `report.CRITICAL: Report ID: webapi-624bbb1db96c4; Message: Item (Magento\AsynchronousOperations\Model\Operation) with the same ID "0" already exists.`

<!-- magento/magento2/pull/36147-->

* 現在，使用「管理基本價格API」在「管理」和「店面目錄」搜索頁上都正確更新產品價格。 [GitHub-33767](https://github.com/magento/magento2/issues/33767)


### 願望清單


<!-- ACP2E-1013-->

* 購物者現在可以在登錄後將產品添加到其願望清單。 以前，由於登錄後表單密鑰驗證問題，隨附加到願望清單請求提交的表單密鑰已失效。

<!-- ACP2E-341-->

* 客戶通過確認電子郵件確認其帳戶後，產品現在會按預期從產品清單和查看頁面添加到希望清單中。 以前，在確認帳戶後，產品未添加到希望清單。

<!-- ACP2E-1175-->

* 的 `addProductsToWishlist` 當購物者試圖將項目添加到具有無效產品值的希望清單時，query現在會返回一條資訊性錯誤消息 `select` 自定義選項。 以前，缺少對下拉清單自定義選項值的伺服器驗證，這會導致資料庫中的值無效。 因此，終結點返回了以下內部伺服器錯誤： `GraphQL endpoint returns Internal server error with "Call`。

## 已知問題

**問題**:啟用免費發運時，您不能建立貸項通知單(**[!UICONTROL Stores]** > **[!UICONTROL Configuration]** > **[!UICONTROL Sales]** > **[!UICONTROL Delivery Methods]**)，顯示的發運價格包括稅。 當您嘗試建立貸項通知單時，Adobe Commerce會拋出此異常： `"Division by zero".vendor/magento/module-sales/Model/Order/Creditmemo/Total/Tax.phpLine 139`。 [GitHub-36800](https://github.com/magento/magento2/issues/36800)

**解決方法**:現在可以找到此問題的修補程式。 轉到 [質量修補程式工具：搜索修補程式](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html) 並搜索修補程式ACSD-50814。

## 社區捐款

我們感謝廣大Magento Open Source，並願承認他們對本新聞稿的貢獻。

社區工程團隊 [Magento撰稿人](https://magento.com/magento-contributors) 按月、季度和年度保存一份最佳貢獻個人和合作夥伴清單。 在該「參與者」頁中，您可以在GitHub上跟蹤到其合併公關的連結。

### 合作夥伴貢獻

下表重點介紹了合作夥伴的貢獻。 此表列出了提供拉請求的合作夥伴、外部拉請求編號以及與其關聯的GitHub發行編號（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-6-partner.md}}

### 個人捐款人

下表列出了社區成員的貢獻。 此表列出了提供拉請求的社區成員、外部拉請求編號和與其關聯的GitHub發行編號（如果可用）。

{{$include /help/_includes/release-notes/engcomm-2-4-6-issues.md}}

## 系統要求

我們的技術堆棧構建在PHP和MySQL上。 有關詳細資訊，請參見 [系統要求](../../../installation/system-requirements.md)。

## 安裝和升級說明

您可以使用 [作曲家](../../../installation/composer.md)。
