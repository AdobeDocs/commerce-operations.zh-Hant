---
title: Magento Open Source 2.4.2發行說明
description: 瞭解2.4.2Magento Open Source版本中的新功能、增強功能、錯誤修正和已知問題。
recommendations: noCatalog
exl-id: 01e90bcb-d43c-4daa-9669-44e3370102af
source-git-commit: 4bcc68890e16e51f0a84ed3d0d47b1f3dbbd52f0
workflow-type: tm+mt
source-wordcount: '12958'
ht-degree: 0%

---

# Magento Open Source 2.4.2發行說明

Magento Open Source2.4.2引進了效能與安全性的增強功能，以及重大的平台改良。 安全性增強功能包括擴大對 `SameSite` 所有Cookie的屬性。 現在支援Elasticsearch7.9.x和Redis 6.x。

此版本包含280多項核心程式碼的新修正及35項安全性增強功能。 其中包括由我們的社群成員解決近290個GitHub問題。 這些社群貢獻的內容包括核心程式碼的少量清理，以及GraphQL中的重大增強功能。

此版本已修正2.4.1中確認的所有已知問題。

{{bics}}

## 套用 `AC-3022.patch` 繼續提供DHL作為運送業者

DHL已匯入schema 6.2版，並將在不久的未來淘汰schema 6.0版。 支援DHL整合的Adobe Commerce 2.4.4及舊版僅支援6.0版。部署這些版本的商戶應適用 `AC-3022.patch` 儘早繼續提供DHL作為貨運業者。 請參閱 [套用修補程式以繼續提供DHL作為運送承運商](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) 知識庫文章，瞭解如何下載及安裝修補程式。

## 有可用的安全性修補程式

商戶現在可以安裝時效性強的安全性修正，而不需套用完整每季發行版本提供的數百個功能修正和增強功能（例如2.4.1-p1）。 修補程式2.4.0.12 （Composer套件2.4.1-p1）是安全性修補程式，針對先前季度發行版本2.4.1中發現的弱點提供修正。此安全性修補程式包含套用至2.4.1版的所有修補程式。 (A *Hot Fix* 提供已發行版本的修正，可解決特定問題或錯誤。)

如需安全性修正程式的一般資訊，請參閱 [推出新的安全性修補程式發行版本](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). 如需下載和套用安全性修補程式（包括修補程式2.4.1-p1）的說明，請參閱 [快速入門內部部署安裝](../../../installation/composer.md). 安全性修補程式僅包含安全性錯誤修正，不包含完整修補程式中包含的其他安全性增強功能。

## 其他發行資訊

雖然這些功能的程式碼隨季度發行捆綁，但其中幾個專案(例如Progressive Web Application (PWA) Studio)也獨立發行。 這些專案的錯誤修正記錄在每個專案檔案中提供的個別專案特定發行資訊中。

## 反白顯示

請檢視此版本中的下列重點專案。

### 大幅增強安全性

此版本包含超過35項安全性修正和平台安全性改善。 所有安全性修正已反向移植至2.4.1-p1和2.3.6-p1。

#### 超過35項安全性增強功能，有助於關閉遠端程式碼執行(RCE)和跨網站指令碼(XSS)漏洞

目前尚未發生與這些問題相關的已確認攻擊。 但是，某些漏洞可能會被用來存取客戶資訊或接管管理員工作階段。 這些問題大多需要攻擊者先取得Admin的存取權。 因此，我們提醒您採取一切必要步驟來保護您的管理員，包括但不限於以下工作：IP允許清單、 [雙因素驗證](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)，使用VPN，使用唯一位置而非 `/admin`和良好的密碼衛生。 另請參閱 [Adobe安全性公告](https://helpx.adobe.com/security/products/magento/apsb21-08.html) 以討論這些已修正的問題。

#### 其他安全性增強功能

此版本的安全性改善包括：

* 所有核心Cookie現在都支援 `SameSite` 屬性。

* 當使用者嘗試儲存產品和類別說明欄位中的值時，應用程式現在會顯示可識別潛在惡意內容的訊息。

* 跨元件的檔案系統作業已標準化並強化，以防止惡意上傳。

* 已修正核心內容安全性原則(CSP)違規。

{{cve-notice}}

### 基礎架構改良

此版本包含核心品質的增強功能，可改善「架構」的品質以及下列功能區域：客戶帳戶、目錄、CMS、OMS、匯入/匯出、促銷活動和鎖定目標，以及購物車和結帳。

### 平台增強功能

* [**現已支援Elasticsearch7.9.x**](../../../installation/system-requirements.md). 雖然我們建議您執行Elasticsearch7.9.x，但2.4.x版仍與Elasticsearch7.4.x相容。 <!-- MC-36867-->

* 2.4.2已透過進行測試 [亮漆6.4](../../../installation/system-requirements.md). 2.4.x版仍與Varnish 6.x相容。

* [**現在支援Redis 6.x**](../../../installation/system-requirements.md). 2.4.x版與Redis 5.x仍可相容。 <!-- MC-34853-->

* 2.4.2現在相容於 **Composer 2.x**. 我們建議商戶移轉至Composer 2.x。雖然您可以使用Composer 1.x安裝此版本，但Composer 1.x即將終止服務。 如需Composer 2.x功能的概述，請參閱 [Composer 2.0現已推出！](https://blog.packagist.com/composer-2-0-is-now-available/)

此版本已棄用設定安裝以使用分割資料庫的功能。 目前使用分割資料庫的商家，應開始計畫回覆或移轉至單一資料庫，或使用替代方法。 請參閱 [棄用Magento Open Source中的分割資料庫功能](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) DevBlog文章以概略瞭解此問題。  另請參閱 [從分割資料庫還原為單一資料庫](../../../configuration/storage/revert-split-database.md) 以取得移轉指示。

### 效能增強功能

此版本包含程式碼增強功能，可針對具有大型目錄的部署提升API效能以及管理員回應時間。 多重擴充性增強功能可讓2.4.2以原生方式支援複雜目錄，擴充幅度最高達先前版本的20倍。

### Adobe Stock整合

此版本包含Adobe Stock整合v2.1.1。

### GraphQL

此版本新增GraphQL涵蓋下列功能：

* 新增的支援 [比較清單](https://devdocs.magento.com/guides/v2.4/graphql/queries/compare-list.html). 購物者可以 [建立](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-compare-list.html) 和 [刪除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-compare-list.html) 比較清單，和 [新增](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-compare-list.html) 和 [移除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-compare-list.html) 比較清單的專案。 此外，以訪客身分建立比較清單的購物者可以客戶身分登入，並 [保留](https://devdocs.magento.com/guides/v2.4/graphql/mutations/assign-compare-list-to-customer.html) 它們的比較清單。

* 已新增 [`generateCustomerTokenAsAdmin`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/generate-customer-token-as-admin.html) 突變並更新 `Customer` 物件，支援遠端採購協助。

* 新增跨商店的本地化支援，以支援變更語言、購物車及貨幣等工作。 <!-- MC-37801-->

* 新增對GraphQL中聯合的支援。 [GitHub-29425](https://github.com/magento/magento2/issues/29425) <!-- ENGCOM-8291 -->

* GraphQL結構已增強，以最佳化具有許多變體的可設定產品的產品資料擷取。 <!-- MC-36138-->

* 整數型別物件ID已過時，改為 `uid` 型別ID的屬性。 <!-- MC-36346-->

* 已新增 `staging` 屬性至 [`ProductInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/product-interface.html) 和 [`CategoryInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/category-interface.html) 以判斷產品是否已分段，並檢視其相關的促銷活動資訊。 <!-- MC-33897-->

請參閱 [GraphQL開發人員指南](https://devdocs.magento.com/guides/v2.4/graphql/) 這些增強功能的詳細資訊。

### PWA Studio

此版本的PWA Studio包括：

* 國際化和本地化。 Venia現在支援多種語言和貨幣。

* 改善擴充功能框架，可透過擴充功能支援程式碼變更。

* 「我的帳戶」相關功能的初始元件，例如「願望清單」、「已儲存付款」、「通訊錄」及「訂單歷史記錄」。

* 各種效能最佳化和錯誤修正。

如需有關增強功能和錯誤修正的資訊，請參閱 [PWA Studio版本](https://github.com/magento/pwa-studio/releases). 另請參閱 [相容性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) 以取得PWA Studio版本及其相容版本的清單。

### 媒體集

**媒體集的新角色資源**. 此版本讓商家能夠限制管理員僅存取媒體集，並控制誰可以執行這些動作：

* 將媒體資產插入內容

* 上傳資產

* 編輯資產詳細資訊

* 從媒體集刪除資產

* 管理檔案夾結構。

**內容中的網頁最佳化影像**. 商家現在可以使用 [網頁最佳化的影像轉譯](https://docs.magento.com/user-guide/cms/media-gallery-image-optimization.html) 而不是高解析度的影像。 原始影像在「媒體集」中保持未修改狀態，且影像插入內容時會動態產生影像轉譯。

### 功能測試架構(MFTF)

MFTF 3.2.1現已推出。 此發行版本在測試和測試套裝產生過程中都引入錯誤容許度。 有關其他增強功能和錯誤修正的詳情，請參閱 [功能測試框架變更記錄檔](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### 廠商開發的擴充功能

請參閱下列文章，瞭解此版本功能和變更的更新：

* [Amazon Pay](https://marketplace.magento.com/amzn-amazon-pay-magento-2-module.html)

* [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)

* [dotdigital Engagement Cloud](https://marketplace.magento.com/dotdigital-dotdigital-magento2-os-package.html)

* [卡拉納](https://marketplace.magento.com/klarna-m2-klarna.html)

* [頂點雲](https://marketplace.magento.com/vertexinc-vertex-tax-module.html)

* [Yotpo產品評論](../../../upgrade/modules/upgrade.md)

### AWS S3支援增強功能

Amazon Simple Storage Service (AWS S3)支援已增強，包含對以下專案的支援：

* 物件儲存與未來擴充性

* [儲存媒體檔案](../../../configuration/remote-storage/remote-storage.md) 在AWS S3上

## 已修正的問題

我們已修正2.4.2核心程式碼中的數百個問題。

### 安裝、升級、部署

<!-- MC-38429-->

* 此版本已棄用設定安裝以使用分割資料庫的功能。 請參閱 [棄用Magento Open Source中的分割資料庫功能](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) DevBlog文章。

<!-- MC-36472-->

* 商戶現在可以成功地將執行MySQL 8.x的開放原始碼部署升級為Commerce部署。 之前，應用程式擲回例外狀況， `AUTO_INCREMENT` 值已恢復為所有表格的初始值，其中 `row_id` 已在升級期間新增。

<!-- ENGCOM-7280 -->

* 如果執行時發生錯誤，應用程式現在會顯示錯誤訊息，以識別用來建立修補程式的路徑 `bin/magento/setup:db:generate-patch`. [GitHub-27523](https://github.com/magento/magento2/issues/27523)

<!-- ENGCOM-8029 -->

* `block_html`， `full_page`、和 `layout` 快取功能現在會依預期停用，之後 `bin/magento/setup:upgrade` 執行。  [GitHub-28186](https://github.com/magento/magento2/issues/28186)

<!-- ENGCOM-8184 -->

* 中所需的最低PHP版本 `bootstrap.php` 已更新。 [GitHub-30004](https://github.com/magento/magento2/issues/30004)

<!-- MC-38788-->

* 您現在可以執行 `bin/magento/setup:upgrade` 安裝範例資料之後。 先前，當您嘗試執行 `bin/magento/setup:upgrade`，應用程式會顯示此錯誤： `unable to apply data patch magento\catalogrulesampledata\setup\patch\data\installcatalogrulesampledata for module magento_catalogrulesampledata`. 應用程式也會在系統記錄檔中顯示此錯誤： `main.ERROR: Sample Data error: Unable to unserialize value. Error: Syntax error`. [GitHub-30685](https://github.com/magento/magento2/issues/30685)

<!-- MC-36785-->

* 您現在可以從命令列如預期地設定YouTube API金鑰。 之前，當您嘗試執行時，應用程式會傳回此錯誤 `bin/magento config:sensitive:set catalog/product_video/youtube_api_key`： `There are no sensitive configurations to fill`.

<!-- ENGCOM-8163 -->

* 應用程式現在會遵循 `maxMessages` 在中定義的值 `queue_consumer.xml`. 以前，應用程式僅使用部署設定值。 [GitHub-29522](https://github.com/magento/magento2/issues/29522)

<!-- ENGCOM-8243 -->

* 使用建立存放區時，新存放區的URL產生現在可如預期運作 `bin/magento setup:config:import`. 之前，生產環境中不會產生URL重寫。 [GitHub-30025](https://github.com/magento/magento2/issues/30025)

<!-- ENGCOM-8230 -->

* 當您嘗試變更時，應用程式不會再擲回錯誤 `backend-frontname` 使用 `ssh` 安裝Magento Open Source後的容器。 [GitHub-26762](https://github.com/magento/magento2/issues/26762)

<!-- ENGCOM-8230 -->

* 當您執行時，應用程式不再顯示此問題 `bin/magento setup:install` 若要連線到現有的資料庫： `Overwrite the existing configuration for db-ssl-verify?[Y/n]`. [GitHub-29612](https://github.com/magento/magento2/issues/29612)

### Adobe Stock整合

<!-- ENGCOM-8020-->

* 新增閱讀支援 `exif_image.png` 或 `exif-image.jpeg` 中繼資料。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8194 8094 8147-->

* 按一下「媒體集」的「預設檢視」書籤時顯示的內容不再經過篩選。 以前，預設檢視包含套用的篩選器 `url-filter` 套用者。 [GitHub-1813](https://github.com/magento/adobe-stock-integration/issues/1813)， [GitHub-1789](https://github.com/magento/adobe-stock-integration/issues/1789)， [GitHub-1780](https://github.com/magento/adobe-stock-integration/issues/1780)

<!-- ENGCOM-8070 -->

* 已從WYSIWYG OnInsert控制器移除邏輯(`Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\OnInsert::execute()`)並新增至 `Model\Wysiwyg\Images\PrepareImage::execute()` 模型。 [GitHub-1504](https://github.com/magento/adobe-stock-integration/issues/1504)

<!-- ENGCOM-8081 -->

* 區域模擬已從 `media-content:sync` 命令(`\Magento\MediaContentSynchronization\Console\Command\Synchronize::execute`)。 [GitHub-1784](https://github.com/magento/adobe-stock-integration/issues/1784)

### Analytics

<!-- MC-37137-->

* 進階報告現在對相同網域中的多個環境按預期運作。 先前，進階報告產生的CSV檔案會失敗，因為雙引號會以CSV標準RFC4180要求的反斜線逸出，而不是以其他雙引號逸出。

<!-- MC-35996-->

* 此 `analytics_collect_data` 使用預設或非預設連線埠連線至MySQL時，工作現在會順利執行 `env.php`. 先前， `analytics_collect_data` 使用非預設連線埠時擲回錯誤。

<!-- MC-35407-->

* 產生的CSV檔案 `analytics_collect_data` 已適當逸出。 以前，這些檔案產生時沒有正確的逸出，這會阻止產生詳細目錄報表。

### Braintree

* 購物者現在可以使用Apple Pay成功訂購虛擬產品。 之前，應用程式擲回此錯誤： `There are no shipping methods available for you right now. Please try again or use an alternative payment method`.

* 預設PayPal Express結帳付款方式現在可與Braintree信用卡付款方式如期運作。 之前，應用程式不會顯示 **PayPal** 啟用「Braintree信用卡」付款方式時的按鈕。

### 套裝產品

<!-- MC-34063-->

* 應用程式不再為報價中的固定價格套裝產品子料號設定價格。

<!-- MC-38050-->

* 當套件組合產品包含無庫存產品時，價格排序現在會如預期運作。 先前，依降序排序的價格不會依降序顯示產品。

<!-- MC-38576-->

* 當存在許多選項時，應用程式現在會自動為套件組合產品選項套用預設數量1。 以前，商家必須手動指定預設數量給每個選項。

<!-- ENGCOM-8159 -->

* 訂單發票建立頁面現在會如預期顯示套件組合產品的子產品。 [GitHub-27350](https://github.com/magento/magento2/issues/27350)

<!-- MC-38460 -->

* 當您以自訂價格重新訂購屬於套裝產品的簡單產品時，應用程式現在會指定正確的產品價格。 先前，在套裝產品上設定自訂價格，導致在重新訂購時附加的簡單產品價格不正確。 [GitHub-30343](https://github.com/magento/magento2/issues/30343)

<!-- MC-30348 -->

* 呼叫POST `/V1/order/{orderId}/ship` 若要出貨包含搭售產品的訂單，現在會將訂單標示為如預期完成。 以前，應用程式會顯示此錯誤訊息： `You can't create a shipment without products`. [GitHub-9762](https://github.com/magento/magento2/issues/9762)

### 購物車與結帳

<!-- MC-34264-->

* 當自訂地址屬性出現在結帳工作流程的送貨步驟上時，送貨方法估算器現在會如預期運作。 以前，應用程式會顯示此錯誤訊息： `{"message":"Error occurred during \"custom_attributes\" processing. A custom attribute is specified with a missing attribute code. Verify the code and try again."}` [GitHub-27505](https://github.com/magento/magento2/issues/27505)

<!-- MC-35783-->

* 應用程式現在會顯示 `You have no items in your shopping cart` 當購物者移除購物車中的唯一專案時，迷你購物車中的訊息如預期顯示。 以前，不會更新購物車資料 `checkout/cart/removeFailed` 當購物者移除單一專案，且應用程式顯示此訊息時： `1 product requires your attention`.

<!-- MC-36088-->

* 應用模組不再針對不適用的出貨方式顯示訂單的出貨成本。 以前，對於結帳工作流程中不適用的送貨方法，應用程式顯示0價格。

<!-- MC-36598-->

* 客戶預設帳單地址現在於以下情況下選取： **我的帳單和送貨地址相同** 已取消選取簽出工作流程上的核取方塊。

<!-- MC-37351-->

* 當購物者在不同網域中從一家商店切換至另一家商店時，購物車內容不再遺失。

<!-- MC-38000-->

* 購物者現在可使用多種送貨方式，透過多個地址結帳成功完成訂單。 之前，應用程式會顯示此錯誤： `There has been an error processing your request`. [GitHub-30197](https://github.com/magento/magento2/issues/30197)

<!-- MC-38048-->

* 當購物者從購物車變更商店檢視時，應用程式現在會在結帳工作流程的送貨頁面上顯示正確的預設國家/地區。

<!-- MC-38309-->

* 當訪客購物者登入後，在登出後重設密碼後清除客戶工作階段時，應用程式現在會排除目前的工作階段。 以前，當購物者重設密碼時，應用程式會清空購物車。

<!-- MC-36884-->

* 當購物者變更購物車中的商店檢視時，應用程式現在會顯示商店檢視的正確預設國家/地區。 先前，當購物車中的商店檢視變更時，預設國家/地區不正確。

<!-- MC-38746-->

* 重複呼叫 `/rest/V1/guest-carts/cart_id/totals-information` 購物車上的端點已移除，進而改善購物車效能。 先前，當購物者新增產品至購物車，然後檢視購物車時，應用程式會呼叫 `collectAddressTotals` 方法多次。

<!-- MC-38833-->

* 應用程式不再顯示 **地區** 在下列情況下，適用於結帳工作流程中國家/地區的欄位： **若國家/地區選擇州，則允許選擇州** 設定已停用。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- MC-38813-->

* 從管理員重新訂購訂單時，應用程式不再重複店面結帳工作流程中的送貨地址。

<!-- MC-38814-->

* 修正設計的問題 `AdminMediaGalleryInsertLargeImageFileSizeTest`.

<!-- MC-37321-->

* 此目錄中的所有新記錄 `quote` 在中，來賓表現在會獲得值1 `customer_is_guest field`. 之前，新訪客在購物車中新增產品時，系統會在以下位置將記錄指派為0：`quote.customer_is_guest` 欄位。

<!-- ENGCOM-8091 -->

* 此 **提交** 結帳工作流程「檢閱與付款」區段上的按鈕已移至內部 `<form id="purchaseorder-form"...></form>`，這可在不變更任何JavaScript的情況下提交隱含表單。 [GitHub-27925](https://github.com/magento/magento2/issues/27925)

<!-- ENGCOM-8428 -->

* 應用程式不再顯示 **地區** 欄位(位於結帳工作流程中的 **若國家/地區選擇州，則允許選擇州** 設定已停用。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- ENGCOM-8442 -->

* 當購物者點按時，應用程式現在可以正確更新購物車的專案小計 **更新購物車** 使用多個地址結帳時。 [GitHub-30408](https://github.com/magento/magento2/issues/30408)

<!-- ENGCOM-8283 -->

* 發生下列情況時，應用程式不再擲回例外狀況： `config.xml` 節點適用於目前未安裝的付款方法。 之前，應用程式在結帳時擲回例外狀況。 [GitHub-29555](https://github.com/magento/magento2/issues/29555)

<!-- ENGCOM-8215 -->

* 應用程式現在會在迷你購物車中正確轉譯包含特殊字元的產品名稱。 [GitHub-29075](https://github.com/magento/magento2/issues/29075)

<!-- ENGCOM-8308 -->

* 應用模組現在會針對表格費率設定正確的折扣套件。 之前，應用程式在計算表格費率時，並未套用設定購物車折扣的購物車規則。 [GitHub-30169](https://github.com/magento/magento2/issues/30169)

### 購物車價格規則

* 現在會在計算訂單小計時如預期套用購物車價格規則，而不納入稅捐。 新的 `Subtotal (Incl. Tax)` 選項已新增為購物車價格規則條件。

<!-- MC-37884-->

* 使用GraphQL套用附有抵用券的價格規則時，現在會如預期運作，當 **整個購物車的固定金額折扣** 動作已使用。

### 目錄

<!-- MC-34100-->

* 應用程式現在會依預期在店面顯示所有重新啟用的產品。 先前，當產品停用然後重新啟用時，應用程式不會顯示產品，直到清除Varnish頁面快取或重新索引存放區，因為重新啟用產品後，頁面快取不會失效。

<!-- MC-37745-->

* 部分重新索引大型目錄現在可如預期運作。 先前，在使用重新索引時，產品會從店麵類別頁面隨機消失 `catalogsearch_fulltext` 部分索引器。

<!-- MC-35123-->

* 購物者現在可以重新訂購具有預期可自訂選項之產品的已開立商業發票訂單。 以前，當購物者嘗試重新排序時，應用程式擲回此錯誤： `{"0":"The product's required option(s) weren't entered. Make sure the options are entered and try again`.

<!-- MC-35212-->

* 您現在可以成功設定 **版面** 在「類別設計」頁面上將設定為 **無配置更新**. 之前，應用程式恢復為 **類別 — FullWidth** 當您指派 **無配置更新** 值。

<!-- MC-35490-->

* 已解決店面的產品排序順序問題。 以前，當應用程式將產品價格編列索引時，它偶爾會設定可設定產品的價格， `min_price` 和 `max_price` 至0 (在 `catalog_product_index_price` 影響店面價格排序順序的表格。

<!-- MC-35608-->

* 應用程式現在已成功更新標示的屬性 `Product Type`. 先前，因為 `product_type` 屬性已保留在程式碼中，當您嘗試更新時，應用程式會顯示此訊息 `Product Type` 屬性： `An attribute with the same code (product_type) already exists.`

<!-- MC-36214-->

* 當您儲存產品時，應用程式不會再變更已上傳視訊在產品詳細資料頁面之影像和視訊區段中的位置。 以前，新影像位置會指定索引值（清單中的位置），如果現有影像位置與其索引值不一致，則新影像會錯誤放置在清單中。

<!-- MC-36548-->

* 此 **加入購物車** 功能現在可在下列情況按預期運作： **加入購物車** 按鈕可供點選。 先前，如果您在等待產品頁面載入時按此按鈕多次，應用程式會擲回此錯誤： `Invalid Form Key. Please refresh the page`.

<!-- MC-37006 36835-->

* 當商家在類別中新增或移除已停用的產品時，應用程式不再刷新類別快取。 之前，應用程式會針對相關類別排清快取，無論產品狀態為何。 儲存類別時也會取消指派類別，導致清除類別快取。

<!-- MC-37347-->

* 目錄產品篩選 **所有商店檢視** 範圍現在可正常運作。 之前，具有下列任一狀態的產品 `Enabled` 或 `Disabled` 在格線中顯示，而僅篩選已啟用或停用的產品。

<!-- MC-38038-->

* 部分重新索引不再導致遺漏產品和空白類別。

<!-- MC-38315-->

* 重新排序現在可如預期運作，當 **使用JavaScript日曆** 已啟用(**商店** > **設定** > **目錄** > **日期與時間自訂選項**)。 先前，啟用此設定時，當您嘗試從管理員重新排序先前下單的訂單時，應用程式會顯示此錯誤： `Please specify date required option(s)`.

<!-- MC-38719-->

* 應用程式現在會在建立層級價格期間，在多網站部署中顯示正確的貨幣。

<!-- MC-38914-->

* 產品影像自訂屬性現已正確逸出。 此 `data-src` 屬性的值與相同 `src` 屬性（如預期）。 之前，URL特殊符號會逸出。

<!-- MC-37665-->

* 透過REST API更新類別時，不再停用 **使用預設值** 「啟用類別」、「包含在功能表中」和「URL索引鍵」屬性上的設定。

<!-- MC-35363-->

* 儲存類別現在只會排清與此類別相關的區塊快取。 之前，應用程式會排清所有類別區塊的快取。

<!-- MC-30626-->

* 具有百分比價格的自訂選項價格，現在會在多商店部署中，依預期轉換為作用中商店的基本貨幣。 以往，具有百分比價格的自訂選項的價格轉換不正確。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- MC-38890-->

* 應用程式現在可以成功重新建立影像，而且當商家使用POST傳送媒體集資料時，這些影像會如預期在「管理員」中顯示 `rest/all/V1/products`. 以前，應用程式會重新建立影像，但商業者透過POST傳送媒體集資料時即刪除影像 `rest/all/V1/products` 如果影像刪除於 `pub/media` 但是媒體中仍然有記錄包含這些影像的記錄。 因此，商家在「管理員」中只看到預留位置，因為影像是在更新過程中建立和刪除的。

<!-- MC-36903-->

* 現在當您從網站取消指派專案時，會如預期刪除記錄。 先前，POST時複製影像 `rest/all/V1/products` 「 」已執行。

<!-- MC-38413-->

* 此 `/V1/categories/{categoryId}/products` 呼叫現在會如預期傳回屬於上層類別的所有產品清單。 先前，如果產品屬於父類別的多個子類別，應用程式會擲回這種型別的錯誤： `Internal Error. Details are available in the application log file. Report ID: webapi-5f8579e37db54`.  [GitHub-30461](https://github.com/magento/magento2/issues/30461)

<!-- MC-32996-->

* 此 `/V1/products/attributes/:attributeCode/options` REST端點現在支援更新現有的屬性選項。

<!-- MC-30626 ENGCOM-8475-->

* 具有百分比價格的自訂選項價格，現在會在多商店部署中，依預期轉換為作用中商店的基本貨幣。 以往，具有百分比價格的自訂選項的價格轉換不正確。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- ENGCOM-8395 -->

* 商家現在可以在產品建立期間成功儲存新屬性。 以前，當商家嘗試儲存屬性時，應用程式不會儲存屬性，並將商家重新導向至商店檢視首頁。 [GitHub-30362](https://github.com/magento/magento2/issues/30362)

<!-- ENGCOM-7997 -->

* 上的產品格線 **銷售** > **訂購** 和 **目錄** > **產品** 頁面現在會列出所有相關商店，而不僅僅是最近建立的商店。 [GitHub-29267](https://github.com/magento/magento2/issues/29267)

<!-- ENGCOM-6698 -->

* 產品存放庫現在使用 `store_id` 可用時儲存現有產品的屬性值。  以前，產品存放庫類別會覆寫產品存放庫ID，並一律指派預設存放庫ID。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### 目錄規則

<!-- MC-35065-->

* 目錄價格規則現在與產品詳細資料頁面上的自訂選項搭配使用，可如預期運作。 之前，該頁面上的產品價格未反映適用的目錄價格規則。 [GitHub-22856](https://github.com/magento/magento2/issues/22856)

<!-- MC-34265-->

* 產品和目錄快取現在會依排程過期。 過去，快取每天過期是因為 `сron` 已執行 `catalogrule_apply_all` 每日執行一次作業，重新編制所有目錄規則和相依索引器的索引，並清除所有產品和類別的快取。

### Cleanup

#### 拼寫錯誤和文法清理

<!-- ENGCOM-7967 -->

* 已修訂「訂單失敗」頁面的標題以提高準確性。 此頁面的標題先前為： **我們已收到您的訂單！**.  [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-8101 -->

* 移除中不必要的空格 `app/code/Magento/Contact/view/frontend/templates/form.phtml`. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-7716 -->

* 修正說明訊息中的錯字 `bin/magento/setup:config:set` 子命令。  [GitHub-28802](https://github.com/magento/magento2/issues/28802)

<!-- ENGCOM-8058 -->

* 修正了PHPDoc中 `framework/Registry.php` 檔案。 [GitHub-29661](https://github.com/magento/magento2/issues/29661)

<!-- ENGCOM-8273 -->

* 已移除多餘的空白字元 `app/code/Magento/Catalog/Helper/Product/View.php`. [GitHub-30601](https://github.com/magento/magento2/issues/30601)

<!-- ENGCOM-8181 -->

* 修正中函式名稱的拼寫錯誤 `app/code/Magento/Ui/view/base/web/js/form/element/ui-select.js`. [GitHub-29987](https://github.com/magento/magento2/issues/29987)

<!-- ENGCOM-8478 -->

* 修正迷你購物車和結帳訂單摘要中「專案」的多元化問題。 [GitHub-29920](https://github.com/magento/magento2/issues/29920)

<!-- ENGCOM-8309 -->

* 已移除標籤圖層導覽篩選器內嵌元素中的空白字元。 [GitHub-30448](https://github.com/magento/magento2/issues/30448)

<!-- ENGCOM-8056 -->

* `rl` 已更正為 `url` 在  `\Magento\Framework\Filter\Template\Tokenizer\Parameter`. [GitHub-29185](https://github.com/magento/magento2/issues/29185)

#### 程式碼清理

<!-- MC-37922-->

* 無關的HTML `<br>` 標籤已從「 」的「檢查資料」訊息區域中移除  **系統**  >  **匯入** 頁面。

<!-- ENGCOM-8028 -->

* `ChangeQuoteControl` 已重構。 [GitHub-29673](https://github.com/magento/magento2/issues/29673)

<!-- ENGCOM-8027 -->

* `AccessChangeQuoteControl` 及其單元測試已重構。 [GitHub-29672](https://github.com/magento/magento2/issues/29672)

<!-- ENGCOM-8053 -->

* 修正中傳回型別宣告的程式碼樣式 `app/code/Magento/Captcha/CustomerData/Captcha.php`. [GitHub-29712](https://github.com/magento/magento2/issues/29712)

<!-- ENGCOM-8288 -->

* 修正「新增屬性」頁面上按鈕清單的位置。

<!-- ENGCOM-8315 -->

* 為前端新增了正確的區塊類別 `viewModel` 的參考範例 `\Magento\Framework\View\Element\Template` 類別。 [GitHub-30450](https://github.com/magento/magento2/issues/30450)

<!-- ENGCOM-8090 -->

* 已移除「銷售規則」表單中多餘的欄位集。 [GitHub-29599](https://github.com/magento/magento2/issues/29599)

<!-- ENGCOM-8448 -->

* 已從移除不必要的程式碼 `hierarchy/edit.phtml` 範本。

<!-- ENGCOM-8446 -->

* 已更正中的PHPdoc註解 `app/code/Magento/CatalogImportExport/Model/Export/Product.php`. [GitHub-30833](https://github.com/magento/magento2/issues/30833)

<!-- ENGCOM-8277 -->

* 的docblock註解 `PublisherInterface` 已更正訊息。 [GitHub-30190](https://github.com/magento/magento2/issues/30190)

<!-- ENGCOM-8264 -->

* 修正中的引數 `getStatusByState` 方法。 [GitHub-30173](https://github.com/magento/magento2/issues/30173)

<!-- ENGCOM-8235 -->

* 修正的方法說明，位於 `app/code/Magento/Quote/Model/Cart/Totals/ItemConverter.php`. [GitHub-30125](https://github.com/magento/magento2/issues/30125)

<!-- ENGCOM-8242 -->

* 在多個檔案的同一行移除多餘的變數指派。 [GitHub-30133](https://github.com/magento/magento2/issues/30133)

<!-- ENGCOM-8263 -->

* 已變更 `@param string $attribute` 至 `@param AbstractAttribute|string[]|string $attribute` 在 `EntityAbstract.php`. [GitHub-30191](https://github.com/magento/magento2/issues/30191)

<!-- ENGCOM-8142 -->

* 無效標籤(例如， `@package` 和 `@subpackage`)已從整個程式碼庫中的docblock中移除。 [GitHub-30061](https://github.com/magento/magento2/issues/30061)

<!-- ENGCOM-8117 -->

* 建構中未使用的引數 `AdvancedPricing` 類別已移除。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### 可設定的產品

<!-- MC-35016-->

* 依價格篩選沒有庫存的可設定產品現在會顯示正確價格範圍內的結果。

<!-- MC-38930-->

* 當虛擬產品的狀態從啟用變更為停用時（反之亦然），虛擬產品不再變更型別。 先前，應用程式會在產品狀態變更時，將產品型別從虛擬變更為簡單。

<!-- MC-38197-->

* 此 `getValue()` 更新購物車時，方法不再觸發嚴重錯誤。

<!-- MC-34444-->

* 可在多個網站上取得的可設定產品不再顯示未指派給特定網站的簡單子產品。 [GitHub-28291](https://github.com/magento/magento2/issues/28291)

<!-- ENGCOM-8202 -->

* Storefront產品頁面現在會如預期顯示層級價格（不含稅）。 [GitHub-12225](https://github.com/magento/magento2/issues/12225)

<!-- ENGCOM-8134 8174-->

* 可設定產品的MSRP價格現在可正確轉換為選擇的貨幣。 以前，應用程式以錯誤的貨幣顯示價格，並擲回此錯誤：  `Call to a member function setAppliedTaxes() on null`. [GitHub-26526](https://github.com/magento/magento2/issues/26526)， [GitHub-29603](https://github.com/magento/magento2/issues/29603)

<!-- ENGCOM-8234 -->

* 商戶現在可以儲存特定商店文字色票屬性選項標籤，其值為0 （零）。 之前，0值會由管理員標籤選項值取代。 [GitHub-30073](https://github.com/magento/magento2/issues/30073)

### cron

<!-- MC-37712-->

* 系統訊息清單現在會準確反映產品更新之後 `cron` 已執行，且應用程式已依排程更新產品。

<!-- ENGCOM-8164 -->

* 索引依據 `schedule_id` 和 `status` 已新增至 `cron_schedule` 表格。 [GitHub-29601](https://github.com/magento/magento2/issues/29601)

### 自訂客戶屬性

<!-- MC-23545-->

* 應用程式現在會顯示客戶屬性型別 `file` 建立後顯示在帳戶資訊頁面上。 先前，當您嘗試儲存此型別的新屬性時，應用程式會顯示下列錯誤： `The "newAttribute" attribute value is empty. Set the attribute and try again` 和 `Validation is failed`.

<!-- MC-23544-->

* 應用程式現在可以正確顯示多行自訂客戶屬性值。 以前並非所有資料都會顯示。

<!-- MC-36978-->

* 現在，當購物者在建立帳戶時輸入無效的出生日期時，應用程式會提醒他們。 之前，驗證器會忽略地區設定設定，而購物者會重新導向至建立新客戶帳戶頁面，且出現無效的日期錯誤。

<!-- MC-38846-->

* 自訂地址屬性現在已如預期包含在結帳工作流程的付款步驟中。

<!-- MC-38114-->

* 自訂地址多重選取屬性現在會在來賓結帳期間以及管理員和我的帳戶訂單詳細資訊頁面上正確顯示。

<!-- MC-37101-->

* 您現在可以在以下情況下刪除自訂客戶屬性中的前導零 `Input Type` 設為 `Text` 和 `Input Validation` 設為 `Numeric Only`.

<!-- MC-36721-->

* 應用程式現在已成功匯出包含自訂性別屬性值的客戶資料。

### 客戶

<!-- MC-35771-->

* 店面客戶帳戶頁面出生日期欄位的行事曆介面工具集現在會使用指定的店面地區設定。

<!-- MC-38498-->

* 從Admin為現有客戶重新訂購結帳時，應用程式不再儲存客戶地址的重複專案。

<!-- MC-37393-->

* 現在從「管理員」刪除多個客戶的所有地址，會從客戶地址清單刪除所有地址，並移除預設帳單和送貨地址。 以前，應用程式會從客戶地址清單中刪除該地址，但並未移除預設帳單和送貨地址。

<!-- MC-37377-->

* 在管理員執行大量刪除地址後，「管理員客戶地址」索引標籤現在可以正確顯示地址計數。 以前，應用程式會在計數中包含已刪除的地址。

<!-- MC-36718-->

* 的DateTime格式 **出生日期** 已更正客戶註冊頁面上的欄位。 先前，位數天的前導零會遺失。

<!-- MC-36024-->

* 的日期格式驗證 **出生日期** 欄位現在可在購物者按一下 **建立帳戶** 按鈕。 過去，購物者按一下「 」時，可能會以無效格式輸入值， **建立帳戶** 按鈕，購物者被重新導向至建立新客戶帳戶頁面，並出現無效的日期錯誤。

<!-- MC-33867-->

* 當管理員嘗試儲存包含屬性無效資料的新客戶帳戶時，應用程式不再擲回嚴重錯誤。

<!-- MC-36258-->

* 當客戶嘗試在先前已安裝Magento Shipping且目前已部署預設Luma主題的部署中存取其購物車時，應用程式不再擲回400錯誤。 以前，應用程式在將請求傳送到伺服器之前，不會篩選掉先前安裝/啟用的Admin不支援的模組所建立的區段名稱，這會導致錯誤。

<!-- MC-35812-->

* 當購物者建立訪客帳戶，且符合以下條件時，應用程式現在會依預期顯示訊息： **需要電子郵件確認** 設定已啟用，並且 `Magento\Customer\Controller\Account\CreatePost` 已覆寫。 以前，應用程式不允許這種型別的自訂使用者註冊程式，在這些條件下，使用者的電子郵件確認狀態會被視為完成，新使用者會自動登入，並且不會顯示錯誤訊息。

<!-- ENGCOM-8039 -->

* 現在，當購物者在商店內以非預設客戶群組下訂單時，應用程式會將購物者指派給正確的客戶群組，其中 **啟用自動指定至客戶群組** 已啟用。 [GitHub-26976](https://github.com/magento/magento2/issues/26976)

<!-- MC-39783-->

* 當索引設定為時，多網站部署中刪除非預設網站時，現在可如預期使用管理員客戶格線 **依排程更新**. 之前，應用程式未顯示格線，並擲回此錯誤：  `[2020-12-09 11:31:54] report.CRITICAL: The website with id 2 that was requested wasn't found. Verify the website and try again. \{"exception":"[object] (Magento\\Framework\\Exception\\NoSuchEntityException(code: 0): The website with id 2 that was requested wasn't found. Verify the website and try again. at /var/www/html/magento24ee/vendor/magento/module-store/Model/WebsiteRepository.php:110)"}`

### dotdigital

* 從dotdigital Engagement Cloud擷取程式清單時，已改善錯誤處理。

* 訪客同步處理期間在存放區名稱欄中同步處理的值，現在會如預期般成為存放區檢視名稱。 之前，此欄會包含網站名稱。

* 在儲存訂單後循環處理訂單狀態自動化之前新增陣列檢查。

* 由於dotdigital模組對的相依性，導致Composer升級的問題已解決 `magento/module-authorization`.

### 可下載

<!-- ENGCOM-7679 -->

* 當所屬訂單已部份退款後，應用程式不會再在「我的下載產品」標籤中列出可下載的產品。 [GitHub-28388](https://github.com/magento/magento2/issues/28388)

### EAV

<!-- MC-35934-->

* 使用的自訂屬性 `\Magento\Eav\Model\Entity\Attribute\Backend\ArrayBackend` 現在，如果API呼叫建立產品時裝載中未提供值，則使用預設值。

### 電子郵件

<!-- ENGCOM-7961 -->

* `\Magento\Config\Model\Config\Source\Email\Template::toOptionArray` 發生下列情況時不再擲回錯誤 `setPath()` 之前未呼叫 `toOptionArray()`. [GitHub-29315](https://github.com/magento/magento2/issues/29315)

<!-- MC-36777-->

* 應用程式現在會在您按一下時正確地將純文字轉換為HTML **傳回Html版本** 載入電子郵件範本時。

<!-- MC-34803-->

* 傳送給客戶的電子郵件若包含部份發票，現在會包含精確的專案小計。 先前，此電子郵件中的小計是訂購數量的總計，而不是已開立商業發票數量的總計。

<!-- MC-38337-->

* 應用程式現在會傳送電子郵件提醒給具有有效電子郵件地址的所有相關客戶。 之前，應用程式在遇到一個無效地址後停止向客戶傳送提醒電子郵件。

<!-- ENGCOM-7517 -->

* 從目錄移除產品後，以非同步模式傳送銷售電子郵件現在可如預期運作。 之前，非同步電子郵件傳送會被封鎖，且應用程式會顯示此錯誤：  `main.ERROR: Cron Job sales_send_order_invoice_emails has an error: Call to a member function getData() on null. Statistics: {"sum":0,"count":1,"realmem":0,"emalloc":0,"realmem_start":73400320,"emalloc_start":37177640} [] []main.CRITICAL: Error when running a cron job {"exception":"[object] (RuntimeException(code: 0): Error when running a cron job at /var/www/html/vendor/magento/module-cron/Observer/ProcessCronQueueObserver.php:327, Error(code: 0): Call to a member function getData() on null at /var/www/html/vendor/magento/module-catalog/Helper/Image.php:502)"} []`. [GitHub-26878](https://github.com/magento/magento2/issues/26878)

<!-- ENGCOM-8381 -->

* 當發生下列情況時，應用程式不會再復制訂單確認電子郵件上的客戶 `sales_email/order_comment/enabled` 已停用，並且 `sales_email/order_comment/copy_method` 設為 `bcc`. [GitHub-29915](https://github.com/magento/magento2/issues/29915)

### 框架

<!-- MC-24195-->

* 現在當在客戶上搜尋時，可正確套用自訂的篩選器群組。 先前， `afterSearch` 函式未如預期執行OR篩選。 [GitHub-24576](https://github.com/magento/magento2/issues/24576)

<!-- MC-36942-->

* 商店首頁上的影像現在已成功轉譯。 先前，頁面來源HTML已損毀，因為影像base64程式碼中的三個連續斜線會誤解為評論。

<!-- MC-37369-->

* 現在當使用阿拉伯語地區設定(`ar_SA - Saudi Arabia`)。

<!-- MC-38344-->

* 現在，商家在部署中儲存購物車價格規則後，DatePicker會顯示正確的日期。 [GitHub-30382](https://github.com/magento/magento2/issues/30382)

<!-- MC-31085-->

* 應用程式現在可正確代表阿拉伯千分位分組和阿拉伯小數分隔符號。 先前已修剪阿拉伯文符號。 [GitHub-26676](https://github.com/magento/magento2/issues/26676)

<!-- MC-30631-->

* 應用程式現在會從資料庫刪除過期的資料庫階段作業 `session` 資料表如預期。

### 一般修正

<!-- MC-38105-->

* 您現在可以設定與中定義之處理常式不同的原生階段作業處理常式 `php.ini`. 先前， `SessionManager` 未將成員快取設為 `save_handler`，但改用檔案的 `session_handler`. 應用程式擲回此錯誤： `main.CRITICAL: Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 {"exception":"[object] (Exception(code: 0): Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in ../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 at ../vendor/magento/framework/App/ErrorHandler.php:61)"}`. [GitHub-24717](https://github.com/magento/magento2/issues/24717)

<!-- ENGCOM-8052 -->

* 已對「 」進行下列改進 `LoginAsCustomer` 模組：

   * 已取代 `around` 外掛程式，具有 `after`

   * 已移除多餘的程式碼

   * 已取代 `(bool)->getValue()` 替換為 `isSetFlag`. [GitHub-29689](https://github.com/magento/magento2/issues/29689)

<!-- ENGCOM-8093 -->

* 以萬用字元(*)重新載入所有客戶資料區段不會再導致請求 `customer/section/load` 擲回400錯誤。 [GitHub-28154](https://github.com/magento/magento2/issues/28154)

<!-- ENGCOM-7994 -->

* 應用程式現在會傳遞在生產模式下將配置轉譯為時發生的例外狀況 `var/report`. [GitHub-29606](https://github.com/magento/magento2/issues/29606)

<!-- MC-35058-->

* 商家現在可以根據預期取消指派類別中的產品。 之前，應用程式擲回與此錯誤類似的錯誤： `Could not save product "4" with position 0 to category 3`.

<!-- ENGCOM-7527 -->

* 當不存在客戶請求重設密碼時，應用程式現在會擲回例外狀況。 [GitHub-26288](https://github.com/magento/magento2/issues/26288)

<!-- MC-33687 ENGCOM-8497-->

* 現在，當管理員嘗試在上傳具有此屬性值的檔案時儲存包含無效客戶屬性的客戶帳戶時，應用程式會顯示資訊性錯誤訊息。 之前，應用程式擲回嚴重錯誤。 [GitHub-30295](https://github.com/magento/magento2/issues/30295)

<!-- ENGCOM-8400 -->

* 應用程式現在會套用 **HTML列印檢視的標誌** 組態設定，可如預期將店面發票PDF儲存起來。 [GitHub-24730](https://github.com/magento/magento2/issues/24730)

<!-- ENGCOM-8425 -->

* `static::` 已取代為 `self::` 整個程式碼基底中，用來存取私有常數。 [GitHub-30781](https://github.com/magento/magento2/issues/30781)

<!-- ENGCOM-8395 -->

* 當商家按一下 **建立新屬性** 建立產品期間按鈕兩次。 之前，應用程式顯示空白頁面並擲回錯誤。 [GitHub-30361](https://github.com/magento/magento2/issues/30361)

<!-- ENGCOM-8426 -->

* 應用程式不再顯示 `The coupon code has been accepted` 抵用券移除後訊息。 [GitHub-30255](https://github.com/magento/magento2/issues/30255)

<!-- ENGCOM-8396 -->

* 管理員現在可以將Widget指派給特定類別。 [GitHub-30009](https://github.com/magento/magento2/issues/30009)

<!-- ENGCOM-8216 -->

* 屬性選擇器 `input[type=datetime]` 已取代為較不具體的輸入型別選取器。 [GitHub-30064](https://github.com/magento/magento2/issues/30064)

<!-- ENGCOM-8282 -->

* 應用程式現在會依預期顯示與自訂類別屬性相關聯的商店特定值。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-8287 -->

* 應用程式現在會顯示一個提示，詢問當您按一下 **驗證VAT編號** 當商店地址與運送目的地屬於不同歐盟國家時，在訂單建立頁面上的按鈕。 [GitHub-29652](https://github.com/magento/magento2/issues/29652)

<!-- ENGCOM-8031 -->

* 此 `\Magento\Catalog\Model\ImageUploader` 類別已重構為使用新的 `moveFileFromTmp` 方法。 [GitHub-29598](https://github.com/magento/magento2/issues/29598)

<!-- ENGCOM-8178 -->

* 現在，當商家嘗試使用建立產品屬性時，應用程式會顯示資訊更豐富的錯誤訊息 `product_type` 和 `type_id` 程式碼以提供更具描述性的資訊。 [GitHub-28479](https://github.com/magento/magento2/issues/28479)

<!-- ENGCOM-8135 -->

* 已更正的驗證邏輯 **客戶權杖存留期（小時）**  和 **管理Token期限（小時）** 管理員欄位 **商店**  >  **設定** >  **服務**  > **OAuth** 頁面。 [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-8132 -->

* 應用程式現在可正確剖析包含以下內容的文字 `}}` 在「Widget內容」欄位中。 [GitHub-12087](https://github.com/magento/magento2/issues/12087)

<!-- ENGCOM-8098 -->

* 您現在可以從產品類別頁面中移除篩選器。 之前，當您嘗試刪除篩選器時，應用程式不會讓您移除篩選器並顯示此錯誤：  `Something went wrong`. [GitHub-8538](https://github.com/magento/magento2/issues/8538)

<!-- ENGCOM-8050 -->

* `Magento\Framework\MessageQueue\ConfigInterface` 現在可以在選用模組時具現化 `Magento_MessageQueue` 已停用。 之前，應用程式擲回此錯誤： `PHP Fatal error:  Uncaught Error: Cannot instantiate interface Magento\Framework\MessageQueue\ConfigInterface in /var/www/magento2/magento2/lib/internal/Magento/Framework/ObjectManager/Factory/AbstractFactory.php:121`. [GitHub-26080](https://github.com/magento/magento2/issues/26080)

<!-- ENGCOM-7312 -->

* 已改善判斷應用程式何時可從永久儲存裝置擷取電子郵件值的邏輯。 先前，當未註冊的使用者在第一次完成電子郵件欄位後返回簽出頁面時，應用程式會在簽出頁面上顯示填入的密碼欄位。 [GitHub-26903](https://github.com/magento/magento2/issues/26903)

<!-- ENGCOM-7777 -->

* 遺失 `aclResource` 屬性已新增到Admin標頭 `AdminNotification` 工具列區塊。 以前，即使管理員使用者沒有檢視它的角色資源許可權，也可以看到管理員通知工具列專案。 [GitHub-29067](https://github.com/magento/magento2/issues/29067)

<!-- ENGCOM-8022 -->

* 此 `framework/database/select` `where` 函式現在處理 `type` 正確。 [GitHub-29590](https://github.com/magento/magento2/issues/29590)

<!-- ENGCOM-8260 -->

* 使用效率低下 `array_merge` 在整個程式碼基底中，in回圈已經過改良，這改善了好幾個位置的效能，包括靜態內容部署程式中的效能。 [GitHub-30183](https://github.com/magento/magento2/issues/30183)

<!-- ENGCOM-8445 -->

* 預設的管理員工作階段存留期已從加密模組移至安全性模組。 [GitHub-30859](https://github.com/magento/magento2/issues/30859)

<!-- ENGCOM-8425 -->

* 應用程式現在會檢查類別中的私用常數，如果有的話，會顯示警告 `static::` 呼叫他們。 之前，應用程式擲回此錯誤： `Undefined class constant`.

<!-- ENGCOM-8326 -->

* 新增符號連結支援 `root` 錯誤頁面和維護模式中。 先前，如果 `root` 或 `magento/pub` 已符號連結至不同的目錄，錯誤處理器(`Magento\Framework\Error\Processor`)未產生正確的檢視檔案URL。 [GitHub-30296](https://github.com/magento/magento2/issues/30296)

<!-- ENGCOM-8087 -->

* 新增的遺失 `order_data` 陣列至 `EmailSender` 類別。 這使得這些類別符合Magento的建議，即使用純量變數而不是電子郵件範本中的物件。 [GitHub-29604](https://github.com/magento/magento2/issues/29604)

### GraphQL

<!-- MC-37615-->

* GraphQL URL解析器現在可以正確處理查詢引數。 之前，它在處理包含SEO好記的引數的URL時會傳回NULL。

<!-- ENGCOM-8422 -->

* GraphQL URL解析器現在可以正確處理CMS頁面階層。 之前，它會傳回NULL。 [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209-->

* 產品查詢 `categories.breadcrumbs` 資料不再傳回父類別停用時之類別的階層連結資料。 [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* 現在當URL重寫停用時，會正確傳回類別影像的路徑。

<!-- MC-36648-->

* 現在，在GraphQL密碼重設作業期間發生錯誤時，應用程式會傳回資訊更豐富的訊息。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078-->

* 產品位置現在會依照預期在快取查詢結果時，在GraphQL查詢結果中更新。

<!-- MC-35355-->

* 此 `products` 現在，當滿足以下條件時，查詢會傳回預期結果： `category_id`  篩選器是以下列方式指定的 `in` 關鍵字。 [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8219 -->

* 將規則新增至 `editorconfig` 以支援縮排JSON和YAML檔案兩個空格。 [GitHub-30066](https://github.com/magento/magento2/issues/30066)， [GitHub-30063](https://github.com/magento/magento2/issues/30063)

<!-- ENGCOM-8079 -->

* 此 `FlushCacheByTags` 類別已更新，使用外掛程式而非外掛程式。 [GitHub-29558](https://github.com/magento/magento2/issues/29558)

<!-- ENGCOM-8370 -->

* 中的程式碼 `checkout_index_index.xml` 檔案已增強，因為移除了 `sortOrder` 從 `messages`， `authentication`， `progressBar`， `estimation`、和 `sidebar checkout` 元件。 [GitHub-30550](https://github.com/magento/magento2/issues/30550)

<!-- ENGCOM-8379 -->

* 中的內容 `calc` 現已逸出，因此正確無誤 `calc` CSS輸出檔案中的值。 之前，應用程式傳回的錯誤訊息 `calc` 值。 [GitHub-30542](https://github.com/magento/magento2/issues/30542)

<!-- ENGCOM-8030 -->

* URL重寫產生器現在會設定類別物件 `url_key`， `url_path`、和  `store_id` 以儲存全域範圍的類別URL重寫時預設儲存值。 之前已儲存 `url_key`， `url_path`、和 `store_id` ，並使用上次處理的存放區ID的值。 [GitHub-29585](https://github.com/magento/magento2/issues/29585)###群組產品

<!-- MC-35361-->

* 產品查詢現在會傳回分組產品的所有預期資料。 先前， `product_links` 是空陣列。

<!-- MC-37718-->

* 現在，當所有子簡單產品無庫存時，分組的產品會在產品編輯頁面上列為無庫存。

<!-- MC-37249-->

* 現在，當分組產品的子簡單產品的狀態變更為無庫存，其狀態會在產品編輯頁面上正確更新。 先前，已分組產品之父項的庫存料號在其子項變更庫存狀態後並未更新。

<!-- ENGCOM-8250 -->

* `\Magento\Widget\Controller\Adminhtml\Widget\Instance\Validate` 現在會將片語結果值辨識為錯誤訊息，並在Widget驗證期間輸出給使用者。 [GitHub-27397](https://github.com/magento/magento2/issues/27397)

<!-- ENGCOM-8311 -->

* 中的類別屬性硬式編碼清單  `Magento\Catalog\Model\Category\DataProvider::getFieldsMap()` 已取代為從快取產生的屬性清單。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-7759 -->

* 備援雜湊 `req.http.host/client.ip` 已經移除，雜湊是由Varnish內建的VCL處理。 [GitHub-29988](https://github.com/magento/magento2/issues/29988)

<!-- ENGCOM-8302 -->

* 已新增失敗回呼至 `Magento_Ui` 檔案上傳程式。 [GitHub-29557](https://github.com/magento/magento2/issues/29557)

<!-- ENGCOM-8405 -->

* 一個 `acl.xml` 發生的不一致，當 `Magento_LoginAsCustomerAssistance` 已啟用，但 `Magento_LoginAsCustomerAdminUi` 或 `Magento_LoginAsCustomerLog` 已更正「 」已停用。 先前，當具有這些憑證的管理員嘗試登入管理員時，應用程式顯示一個空白頁面，並在發生以下情況時擲回此錯誤：  `Exception #0 (LogicException): Could not create an acl object: Invalid Document Element 'resource': The attribute 'title' is required but missing. Line: 13`. [GitHub-30680](https://github.com/magento/magento2/issues/30680)

<!-- ENGCOM-8157 -->

* 應用程式不再擲回 `Undefined class constant` 發生下列情況時發生錯誤： `Interceptor` 是在外掛程式建立期間產生。 [GitHub-28981](https://github.com/magento/magento2/issues/28981)， [GitHub-29879](https://github.com/magento/magento2/issues/29879)

<!-- ENGCOM-8108 -->

* 應用程式現在可以正確處理非同步大量操作的傳訊和記錄。 先前，雖然產品已更新，但 `magento_operation` 和 `queue_message_status` 資料表未正確更新，系統訊息不正確。 [GitHub-29718](https://github.com/magento/magento2/issues/29718)

<!-- ENGCOM-8388 -->

* 購物者現在會在按一下時，如預期重新導向至「設定新密碼」頁面 **設定新密碼** 在重設密碼電子郵件中，當 **需要電子郵件確認** 已針對存放區啟用。 以前，購物者會被重新導向回 **忘記您的密碼** 按鈕。 [GitHub-27954](https://github.com/magento/magento2/issues/27954)

<!-- ENGCOM-8337 -->

* 以預設值儲存列系統組態時，更正陣列至字串轉換錯誤。 [GitHub-30314](https://github.com/magento/magento2/issues/30314)

<!-- ENGCOM-8440 -->

* 您現在可以設定訊息佇列的引數。 [GitHub-30216](https://github.com/magento/magento2/issues/30216)

<!-- ENGCOM-8384 -->

* 基礎檔案收集器現在會遵守 `AppState->emulateAreaCode()`. [GitHub-39656](https://github.com/magento/magento2/issues/29656)

<!-- ENGCOM-8441 -->

* 新的 `BlockByIdentifier` 類別支援根據CMS區塊識別碼擷取配置區塊。 因此，從快取中移除CMS區塊時，應用程式也會清除配置區塊快取。 [GitHub-28309](https://github.com/magento/magento2/issues/28309)

<!-- ENGCOM-8385 -->

* 修正佇列中數值引數轉換的問題。 先前，當您使用數值宣告佇列時 `type` 中的引數 `queue_topology.xml`，引數值會轉換為字串。 [GitHub-29615](https://github.com/magento/magento2/issues/29615)

### GraphQL

<!-- MC-37615-->

* 此 `urlResolver` 查詢現在可以正確處理查詢引數。

<!-- ENGCOM-8422 -->

* 此 `urlResolver` 將自訂CMS節點和頁面指定為輸入時，查詢不再傳回NULL。 [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209 ENGCOM-8386-->

* 此 `category` 查詢不再傳回已停用的父類別的子類別。 [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* 此 `category` 停用URL重寫時，查詢現在會傳回類別影像的正確路徑。

<!-- MC-36648 8321-->

* 此 `resetPassword` 突變現在會在錯誤發生時傳回資訊性更強的訊息。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078 ENGCOM-8504-->

* 的快取結果 `products` 產品位置變更時，查詢會如預期失效。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- MC-35355 ENGCOM-8404-->

* 此 `products` 現在，當滿足以下條件時，查詢會傳回預期結果： `category_id` 篩選器是以下列方式指定的 `in` 關鍵字。 [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8373 -->

* 此 `categories` 和 `categoryList` 查詢現在會根據類別許可權設定和父類別ID來考量類別可用性。 [GitHub-29880](https://github.com/magento/magento2/issues/29880)， [GitHub-30624](https://github.com/magento/magento2/issues/30624)

<!-- MC-37603-->

* 此 `updateProductsInWishList` 突變現在可正確驗證願望清單專案。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- ENGCOM-8430 PWA-1107-->

* 已棄用「 」中的 `ProductInterface` 和 `CategoryInterface` 以防止在店面中使用它們。 [GitHub-30625](https://github.com/magento/magento2/issues/30625)

* 現在，當類別許可權設定為隱藏價格時，產品查詢結果會隱藏價格。 [GitHub-29926](https://github.com/magento/magento2/issues/29926)

<!-- MC-36898 PWA-1299-->

* 您現在可以使用 `addProductsToWishList` 變異，將具有使用者定義數量的組合產品加入願望清單。

<!-- MC-36946 -->

* 新增至購物車操作的GraphQL回應時間已改善。

<!-- ENGCOM-8099 -->

* 此 `products` 查詢現在會如預期傳回層級價格值。 [GitHub-29168](https://github.com/magento/magento2/issues/29168)

<!-- ENGCOM-7528 -->

* 移除多餘的 `getMappedNums` 從中的回圈 `lib/internal/Magento/Framework/GraphQl/Query/EnumLookup.php`. [GitHub-30031](https://github.com/magento/magento2/issues/30031)

<!-- ENGCOM-8172 -->

* 此 `products` 查詢的產品具有停用的相關產品時，查詢不再傳回錯誤。 [GitHub-28892](https://github.com/magento/magento2/issues/28892)

<!-- MC-37395 -->

* 此 `cart` query現在會傳回已轉換為正確貨幣（預設顯示貨幣）的價格。 以前，查詢會傳回以基本貨幣表示的料號價格值，而貨幣代碼會傳回為預設顯示貨幣。

<!-- MC-37388-->

* GraphQL現在會遵循目錄許可權。 應用程式會限制要傳回的專案 `products` 根據購物者的客戶群組進行查詢。

<!-- MC-39690-->

* 已新增 `customizable_option` 屬性至實作下列專案的多種資料型別： `CartItemInterface`.

<!-- MC-39744-->

* 已新增以下專案的屬性： `storeConfig` 查詢以傳回商店、商店群組和網站資訊。

<!-- MC-37414-->

* 已恢復 `SelectedCustomizableOption.type` 屬性。 此外， `customizable_options` 的各種實施中的屬性 `CartItemInterface` 現在為非Null。

<!-- MC-23860-->

* 的搜尋功能 `products` 查詢不再傳回已啟用類別許可權的專案。

<!-- MC-37726-->

* 此 `products` query會針對擁有多種貨幣的存放區檢視傳回正確的貨幣。

<!-- MC-37727-->

* 標籤 `products` 查詢篩選器現在會傳迴轉譯的值（如果適用於非預設存放區檢視）。

<!-- MC-37728-->

* 固定購物車中禮品卡上的商店貨幣金額。

<!-- MC-38443-->

* 已新增 `ConfigurableProductOptionsSelection` 資料型別，包含與產品之可選取可設定選項對應的中繼資料。 在中使用這個物件 `products` 查詢，當購物者選取可設定的產品選項時，可將顯示的媒體收藏館專案數減到最少。

### 影像

<!-- MC-36942-->

* 商店首頁上的影像現在已成功轉譯。 先前，頁面來源HTML已損毀，因為影像base64程式碼中的三個連續斜線會誤解為評論。

<!-- ENGCOM-8116 -->

* 相依於 `fileinfo` 擴充功能已從CMS模組移除。 之前，當您嘗試使用影像上傳程式上傳影像時，應用程式會擲回錯誤，此影像上傳程式會在您按一下 **插入影像** 按鈕。 [GitHub-24332](https://github.com/magento/magento2/issues/24332)， [GitHub-16531](https://github.com/magento/magento2/issues/16531)， [GitHub-29852](https://github.com/magento/magento2/issues/29852)

<!-- ENGCOM-8020 -->

* 新增閱讀支援 `exif_image.png` 或 `exif-image.jpeg` 中繼資料。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8296 -->

* CMYK影像顏色現在可正確演算。 當Imagick介面現在偵測到開啟的影像有CMYK色域時，該色域會轉換為SRGB。 以前，這些影像會以反轉的顏色呈現。 [GitHub-22375](https://github.com/magento/magento2/issues/22375)

<!-- ENGCOM-8251 -->

* 不再為設定布林值 `image_with_border.phtml`. 備援 `max-width` 和 `height` 設定已從中移除 `.product-image-photo`. （這些值已透過重設樣式在影像上全域設定。） [GitHub-30186](https://github.com/magento/magento2/issues/30186)

### 匯入/匯出

<!-- MC-35081-->

* 客戶地址 `region_id` 不再指派 `NULL` 使用CSV檔案匯入客戶地址時的值(`entity type = "customer address"` 和 `import behavior = "add/update"`)，其中某些欄位值已刪除。

<!-- MC-35295-->

* 您現在可以在匯入期間隱藏店面上的產品影像。

<!-- MC-35836-->

* 當匯入的產品具有 `qty` 設為0但 `is_in_stock set` 若為CSV檔案中的1，則產品不會列在類別頁面上，而產品詳細資料頁面會將其識別為無庫存。 以前，具有這些值的產品在匯入後會顯示在店面上。

<!-- MC-38433-->

* CSV匯入不再忽略 `dropdown` 和 `textarea` 其他屬性的值。 以前，這些屬性值在匯入期間不會更新。

<!-- MC-37933-->

* 產品匯出CSV檔案現在會如預期顯示在匯出CSV檔案的「管理員」清單中。 之前，當您執行此命令時，應用程式會擲回錯誤： `bin/magento queue:consumers:start exportProcessor --single-thread --max-messages=10000`.

<!-- MC-37672-->

* 匯入包含孟加拉文（孟加拉文）字母字元的CSV資料時，應用程式不再擲回錯誤。

<!-- MC-36410-->

* 現在，當管理員按一下時，應用程式會顯示資訊性錯誤訊息 **檢查資料** 匯入檔案期間，該檔案自匯出後在Chrome中工作時已變更。 以前，應用程式顯示控制檯錯誤，但未告知使用者如何繼續。

<!-- ENGCOM-8252 -->

* 若您多次匯入相同的產品CSV資料，應用程式就不會再重複產品影像。 [GitHub-21885](https://github.com/magento/magento2/issues/21885)

<!-- ENGCOM-8262 -->

* 中的影像檔案名稱不能超過90個字元 `vendor/magento/framework/File/Uploader.php` 已移除。  以前，目錄和檔案名稱的長度不能超過255個字元。 應用程式已匯入其檔案名稱超過此限制的影像產品，但未匯入影像檔案。 [GitHub-29377](https://github.com/magento/magento2/issues/29377)

<!-- ENGCOM-8153 -->

* 優惠券代碼現在可以成功匯出為CSV或XML。 之前，應用程式在您按一下時顯示404錯誤 **匯出CSV** 或 **匯出XML** 當您嘗試匯出優惠券時。 [GitHub-29277](https://github.com/magento/magento2/issues/29277)

<!-- ENGCOM-8252 -->

* 現在匯入包含影像的CSV檔案後，會移除重複的產品影像。 [GitHub-14398](https://github.com/magento/magento2/issues/14398)， [GitHub-21885](https://github.com/magento/magento2/issues/21885)

### 索引

<!-- MC-38003-->

* 我們已改善部分索引器的效能。 應用程式現在會清除針對每個1000-ID批次反複專案變更的快取ID。 快取內容不再累積ID。 先前，快取內容累積快取ID用於每個1000-ID批次疊代，並清除每個疊代上的相同ID集。

<!-- ENGCOM-7929 -->

* 已修正部分重新索引系統與完整重新索引系統之間的不一致。 現在，兩個索引系統都使用相同的程式碼，這可以正常運作。 先前，兩個索引系統對共用索引器使用不同的邏輯，這可能會導致每次執行部分重新索引系統後索引器失效。 [GitHub-29478](https://github.com/magento/magento2/issues/29478)， [GitHub-29297](https://github.com/magento/magento2/issues/29297)

<!-- MC-38168-->

* 我們已解決導致空白類別頁面或類別頁面上的產品計數減少的手動索引器的問題。 發生下列情況時，發生不完整的類別頁面或產品計數問題：

   * 此 `catalogsearch_fulltext` 和 `catalog_product_price` 部分索引器會在大型目錄上執行，直到這些索引器完成執行為止。

   * 部分索引器是在 `catalog_category_product` 或 `catalog_product_category` 索引，同時對其中一個索引執行完整重新索引。 這兩個索引程式可能會發生衝突，導致類別頁面中遺失產品。

   * `bin/magento indexer:reindex inventory` 已在大型目錄上執行。 在「 」之前，「 」類別頁面中缺少產品， `catalogsearch_fulltext` 部分索引器已完成執行。

<!-- MC-39700-->

* 索引器已新增至 `Magento_Bulk` MySQL表格，已改善大量作業的效能。

<!-- MC-38806-->

* 資料庫表格中的註解現在會在重新索引後正確反映表格狀態(`bin/magento indexer:reindex`)。 以前，重新索引後的表格註解包含的值與全新安裝後註解包含的值相同。

<!-- ENGCOM-7542 -->

* 此 `SELECT entity_id IN` 在實作MariaDB v.10.3.18的部署中，已改善陳述式，這已改善目錄類別索引的效能。 [GitHub-25199](https://github.com/magento/magento2/issues/25199)

<!-- ENGCOM-8237 -->

* Magento Open Source已藉由消除每個索引器例項多次排清標籤的作業來改善快取效能。 [GitHub-29890](https://github.com/magento/magento2/issues/29890)

### 基礎架構

<!-- MC-34353-->

* 您現在可以使用 `app/etc/env.php` 將訊息代理程式從MYSQL變更為AMQP。

<!-- MC-38242-->

* 已在相關JavaScript程式庫中更正產品數量小數值的餘數計算問題。 應用程式先前錯誤地計算出超過兩位數的小數位數，隨後顯示不正確的訊息。

<!-- MC-38993 ENGCOM-8473-->

* 此 `\Magento\Authorization\Model\Rules::update` 方法已過時。  [GitHub-29128](https://github.com/magento/magento2/issues/29128)

<!-- ENGCOM-8000 -->

* 從UTC轉換日期物件時，應用程式不再擲回嚴重錯誤。 之前，在特定條件下， `convertConfigTimeToUtc` 方法擲回例外狀況。 [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7987 -->

* `DataObject` 已取代為中的產品型號 `\Magento\MediaGalleryCatalogUi\Ui\Component\Listing\Columns\Thumbnail::prepareDataSource`.[GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- ENGCOM-7914 -->

* 此 `RequireJS` 解析程式不再無法偵測封鎖的資源。 以前，解析程式無法正確偵測頁面上的所有資源是否已正確載入或處理，且頁面仍持續載入。 [GitHub-28116](https://github.com/magento/magento2/issues/28116)

<!-- ENGCOM-8229 -->

* 屬性存放庫代碼驗證現在會遵守 `Magento\Eav\Model\Entity\Attribute::ATTRIBUTE_CODE_MAX_LENGTH` 而不是硬式編碼值。 [GitHub-29017](https://github.com/magento/magento2/issues/29017)

<!-- MC-35699-->

* HTML縮制不再從PHTML檔案的HTML字串中移除三斜線(///)。 之前，在縮制期間，三重斜線會解譯為註解，而在部署時，會在產生的PHTML檔案中完全移除該行的其餘部分。

<!-- MC-38201-->

* 商戶現在可以在表格欄層級（而非表格層級）設定索引子訂閱。 新引數已新增至 `\Magento\Framework\Mview\View\Subscription` 允許針對特定檢視或表格組合忽略欄。 [GitHub-30243](https://github.com/magento/magento2/issues/30243)

<!-- MC-30171-->

* 按一下 **加入購物車** 產品頁面JavaScript完全初始化之前的按鈕不再導致重複 `form_key` 值。 之前，您可以將產品以快取方式新增至購物車 `form_key` 觸發例外狀況的值。 時間 **加入購物車** 在JavaScript完全初始化前按一下，然後 `form_key` 表單資料中傳送的值不符合使用者工作階段，且產品未新增至購物車。 [GitHub-13746](https://github.com/magento/magento2/issues/13746)

<!-- ENGCOM-8107 -->

* 目前的cURL使用者端現在會遵循不區分大小寫的標頭名稱。 先前， `Set-Cookie` 比較區分大小寫，這可能會造成某些HTTP伺服器發生問題。 [GitHub-29524](https://github.com/magento/magento2/issues/29524)

<!-- ENGCOM-8360 -->

* 更新中的XSD URN格式 `api-functional` 和測試案例XML檔案。 [GitHub-30552](https://github.com/magento/magento2/issues/30552)

<!-- ENGCOM-8295 -->

* 已將事件前置詞和事件物件新增至目錄產品選項值集合，以改善集合載入的自訂 `\Magento\Catalog\Model\ResourceModel\Product\Option\Value\Collection`. [GitHub-29621](https://github.com/magento/magento2/issues/29621)

<!-- ENGCOM-8261 -->

* 所有出現次數 `array_merge` 已重構為使用編碼標準中建議的格式。 [GitHub-30005](https://github.com/magento/magento2/issues/30005)

<!-- ENGCOM-7718 -->

* A `head.additional` 型別區塊 `\Magento\Framework\View\Element\Text\ListText` 已新增至 `adminhtml` `default` 版面(依據 `magento2/module-base`)。 [GitHub-29165](https://github.com/magento/magento2/issues/29165)

<!-- ENGCOM-8312 -->

* 將遺漏的URL方法新增至版面配置範本模組Widget。 [GitHub-30036](https://github.com/magento/magento2/issues/30036)

<!-- ENGCOM-8127 -->

* 此 `\Magento\Framework\Filesystem\Io\File::read()` 方法現在相容於 `\Magento\Framework\Filesystem\Io\IoInterface::read()`. [GitHub-27866](https://github.com/magento/magento2/issues/27866)

### 卡拉納

* 移除對PayPal模組的相依性。 [GitHub-29421](https://github.com/magento/magento2/issues/29421)

### 記錄

<!-- ENGCOM-8443 -->

* 此 `Magento_Logging` 模組現在已正確登入新值以及之前的值。 先前，「變更前的值」欄中的值會顯示N/A的值，無論這是第一次變更還是下一次變更，也無論何時傳回預設值。 [GitHub-26943](https://github.com/magento/magento2/issues/26943)

### 媒體集

<!-- ENGCOM-8014 -->

* 管理員 **商店**  >  **設定**  >  **進階**  >  **系統** 頁面已更新，以顯示正確的產品名稱（媒體庫）。 包括對使用者介面的次要重新設計。 [GitHub-1738](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-8019 -->

* Media Gallery影像說明的「使用位置」區段中的連結現在會顯示已如預期由選取的影像篩選的格線。 以前，顯示的網格標題不正確，清單專案不正確。 [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019 -->

* 您現在可以在「媒體集」中成功編輯多個影像。 之前，將標籤新增至一個影像後，無法再新增標籤至第二個影像。 [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015 -->

* 當您從「媒體集」中的影像移除標籤後，「標籤」下拉式功能表現在會如預期般呈現空白狀態。  [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

<!-- ENGCOM-8146 -->

* 現在支援批次處理Media Gallery同步佇列訊息。 [GitHub-1724](https://github.com/magento/adobe-stock-integration/issues/1724)

<!-- ENGCOM-8064 -->

* 當您嘗試在下列情況下開啟「媒體集」時，應用程式現在會依預期顯示404頁面 **增強型媒體集** 已停用。 [GitHub-1760](https://github.com/magento/adobe-stock-integration/issues/1760)

<!-- ENGCOM-8072 -->

* `MediaGalleryMetadata` 現在會在發生例外狀況時略過區段讀取器，而是如預期般剖析並顯示影像中繼資料。 以前，影像中繼資料是空的，因為 `exif_read_data` 區段讀取器。 [GitHub-1782](https://github.com/magento/adobe-stock-integration/issues/1782)

<!-- ENGCOM-8069 -->

* 資料夾名稱長度不再阻止影像上傳至「媒體集」。 媒體集現在將路徑欄設定為型別 `text`. [GitHub-1778](https://github.com/magento/adobe-stock-integration/issues/1778)

<!-- ENGCOM-8217 -->

* 現在當從「媒體集」插入轉譯時，影像上傳程式會顯示正確的影像大小。 [GitHub-1806](https://github.com/magento/adobe-stock-integration/issues/1806)

<!-- ENGCOM-8467 -->

* 路徑驗證已新增至 `Mediagallery` 上傳程式外掛程式。 先前，驗證失敗，且應用程式未匯入產品時 **啟用舊媒體集** 已停用。 [GitHub-30649](https://github.com/magento/magento2/issues/30649)

<!-- ENGCOM-8057 -->

* `Magento_Cms::media_gallery` 新媒體集已新增並強制執行ACL子資源，以支援下列分散式作業設定的許可權：

   * 上傳資產
   * 將資產插入內容
   * 刪除資產
   * 建立資料夾
   * 刪除資料夾。 [GitHub-1487](https://github.com/magento/adobe-stock-integration/issues/1487)

<!-- ENGCOM-8047 -->

* 不再裁切長Media Gallery文字字串和資料夾名稱。 以前，應用程式顯示裁切的文字和影像，並顯示以下訊息：  `We couldn't find any records`. [GitHub-1763](https://github.com/magento/adobe-stock-integration/issues/1763)， [GitHub-1758](https://github.com/magento/adobe-stock-integration/issues/1758)

<!-- ENGCOM-8042 -->

* 應用程式不再顯示 **新增選取專案** 編輯新頁面的內容時未選取任何影像時的按鈕。 [GitHub-1769](https://github.com/magento/adobe-stock-integration/issues/1769)

<!-- ENGCOM-8047 -->

* 篩選器現在已如預期套用於 **內容**  >  **媒體集** 類別格線。 [GitHub-1763](https://github.com/magento/adobe-stock-integration/issues/1763)

<!-- ENGCOM-8183 -->

* Gallery現在會依預期使用多個中斷點選項組態。 之前，中斷點選項設定無法正常運作，原因如下 `mediaCheck` 已在頁面載入時觸發退出媒體查詢函式。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### MFTF

<!-- ENGCOM-8359 -->

* 以中的動作群組取代重複式動作 `CheckStaticBlocksTest`. [GitHub-30561](https://github.com/magento/magento2/issues/30561)

<!-- ENGCOM-8267 -->

* `AdminUpdateCategoryAndMakeInactiveTest` 和 `VerifyChildCategoriesShouldNotIncludeInMenuTest` 已重構以符合MFTF最佳實務。 [GitHub-30058](https://github.com/magento/magento2/issues/30058)

<!-- ENGCOM-8458 -->

* 已移除重複專案 `AdminOpenCMSBlocksGridActionGroup`. [GitHub-30896](https://github.com/magento/magento2/issues/30896)

<!-- ENGCOM-8156 -->

* 已取代 `AdminOpentCmsBlockActionGroup` 與AdminOpenCmsBlockActionGroup一起使用。 [GitHub-29839](https://github.com/magento/magento2/issues/29839)

<!-- ENGCOM-8226 -->

* 已棄用 `GoToAttributeGridPageActionGroup`. [GitHub-30103](https://github.com/magento/magento2/issues/30103)

<!-- ENGCOM-8061 -->

* 將動作群組新增至 `Analytics` 模組。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-7334 -->

* 已更新 `CheckCheckoutSuccessPageAsRegisterCustomerTest` 和 `CheckCheckoutSuccessPageAsGuestTest` 以在執行測試後取消建立的訂單。 [GitHub-28324](https://github.com/magento/magento2/issues/28324)

<!-- ENGCOM-8214 -->

* 已移除 `AdminNavigateToPageGridActionGroup` 因為備援。 [GitHub-29838](https://github.com/magento/magento2/issues/29838)

<!-- ENGCOM-8122 -->

* 已實施 `ActionGroup` 以導覽至結帳頁面。 [GitHub-29843](https://github.com/magento/magento2/issues/29843)

<!-- ENGCOM-8124 -->

* 已實施 `AdminOpenCreateNewCMSPageActionGroup` 以瀏覽至建立新的CMS頁面。 [GitHub-29824](https://github.com/magento/magento2/issues/29824)

<!-- ENGCOM-8268 -->

* 已修正媒體集CMS頁面的MFTF測試中的略過問題。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

#### 新測試

<!-- ENGCOM-7804 -->

* 新增在管理員中啟用電子郵件給朋友的測試。 [GitHub-29145](https://github.com/magento/magento2/issues/29145)

<!-- ENGCOM-8316 -->

* 新增管理員從網格中刪除CMS區塊的測試。 [GitHub-30372](https://github.com/magento/magento2/issues/30372)

<!-- ENGCOM-7933 -->

* 新增將購物車規則套用至單一套件專案的測試。 [GitHub-28921](https://github.com/magento/magento2/issues/28921)

<!-- ENGCOM-8075 -->

* 新增測試以檢查是否 **使用位置** 刪除實體後，會顯示「媒體集」影像的資訊。 [GitHub-1774](https://github.com/magento/adobe-stock-integration/issues/1774)

#### 新動作群組

* `AssertStorefrontCustomerLogoutSuccessPageActionGroup`. [GitHub-29841](https://github.com/magento/magento2/issues/29841) <!-- ENGCOM-8121 -->

* `AdminOpenConfigurationStoresPageActionGroup`. [GitHub-29848](https://github.com/magento/magento2/issues/29848) <!-- ENGCOM-8259 -->

* `ReloadPageActionGroup`. [GitHub-30683](https://github.com/magento/magento2/issues/30683) <!-- ENGCOM-8394 -->

* `StorefrontClickRefundTabCustomerOrderViewActionGroup`. [GitHub-30032](https://github.com/magento/magento2/issues/30032) <!-- ENGCOM-8203 -->

* `AdminOpenAdminThreeDSecurePageActionGroup`. [GitHub-29845](https://github.com/magento/magento2/issues/29845) <!-- ENGCOM-8115 -->

* `AdminCustomerClickFirstRowEditLinkActionGroup`.  [GitHub-29501](https://github.com/magento/magento2/issues/29501) <!-- ENGCOM-8043 -->

* `StorefrontClickAddToCartButtonActionGroup`. [GitHub-29823](https://github.com/magento/magento2/issues/29823) <!-- ENGCOM-8113 -->

* `AdminDeleteTaxRateActionGroup`. [GitHub-29940](https://github.com/magento/magento2/issues/29940) <!-- ENGCOM-8192 -->

* `AdminOpenWebConfigurationPageActionGroup`. [GitHub-29846](https://github.com/magento/magento2/issues/29846) <!-- ENGCOM-8126 -->

* `AdminOpenGeneralConfigurationPageActionGroup`. [GitHub-29847](https://github.com/magento/magento2/issues/29847) <!-- ENGCOM-8114 -->

* `AdminOrderClickSubmitOrderActionGroup`. [GitHub-29649](https://github.com/magento/magento2/issues/29649) <!-- ENGCOM-8023 -->

* `AdminOpenCatalogProductPageActionGroup`. [GitHub-29941](https://github.com/magento/magento2/issues/29941) <!-- ENGCOM-8209 -->

* `AdminClickInvoiceButtonIntoOrderActionGroup`. [GitHub-25399](https://github.com/magento/magento2/issues/25399) <!-- ENGCOM-8210 -->

* `AdminGridBulkActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminGridColumnShowActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminOpenIndexManagementPageActionGroup`. [GitHub-29825](https://github.com/magento/magento2/issues/29825) <!-- ENGCOM-8123 -->

* `AdminOpenCatalogSearchTermIndexPageActionGroup`. [GitHub-29844](https://github.com/magento/magento2/issues/29844) <!-- ENGCOM-8128 -->

* `AdminClickAddProductToggleAndSelectProductTypeActionGroup`. [GitHub-30917](https://github.com/magento/magento2/issues/30917) <!-- ENGCOM-8439 -->

* `StorefrontCheckoutClickSaveAddressButtonActionGroup`. [GitHub-30916](https://github.com/magento/magento2/issues/30916) <!-- ENGCOM-8454 -->

* `AdminOpenCurrencyRatesPageActionGroup`. [GitHub-30783](https://github.com/magento/magento2/issues/30783) <!-- ENGCOM-8432 -->

* `AdminClickGetShippingMethodsAndRatesActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `AdminSelectFixedShippingMethodActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `StorefrontClickProceedToCheckoutActionGroup`. [GitHub-30926](https://github.com/magento/magento2/issues/30926) <!-- ENGCOM-8438 -->

* `StorefrontOpenMyAccountPageActionGroup`. [GitHub-29842](https://github.com/magento/magento2/issues/29842) <!-- ENGCOM-8143 -->

### 電子報

<!-- MC-38789-->

* 當客戶訂閱已排入佇列的Newsletter時，管理員使用者現在可以依預期編輯客戶帳戶。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8034 -->

* 如果購物者未確認其電子報訂閱，應用程式現在會重新傳送電子報訂閱確認。 [GitHub-28422](https://github.com/magento/magento2/issues/28422)

<!-- ENGCOM-8429 -->

* 當客戶訂閱已排入佇列的Newsletter時，您現在可以依預期編輯客戶帳戶。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

### 付款方法

<!-- MC-35161-->

* 現在，所有網站的付款方法會如多商店部署所預期在Admin中載入。

<!-- MC-35152-->

* 當購物者的名稱包含重音字母時，應用程式現在會成功完成Payflow Pro付款。 之前，付款未完成，且應用程式記錄此錯誤： `report.CRITICAL: String to be escaped was not valid UTF-8 or could not be converted`.

#### PayPal

<!-- MC-35692-->

* 現在，從使用信用卡的付款方式切換為非信用卡付款方式後，商家可以成功向管理員下訂單。 先前，當商家按一下 **提交訂單** 按鈕，載入程式已開始但從未完成，而且未下訂單。

<!-- MC-37649-->

* 使用PayPal Express下訂單時，應用程式不會再建立重複訂單。 先前，當購物者嘗試透過PayPal Express支付訂單，但PayPal傳回錯誤時，應用程式仍會建立訂單。 這會導致商家網站上出現重複訂單。 [GitHub-13952](https://github.com/magento/magento2/issues/13952)

<!-- MC-38829-->

* PayPal結算報告現在位於 **報表** > **銷售** > **PayPal結算** 如預期。 以前，應用程式不會在PayPal結算報表格線中列出這些報表，且會顯示下列訊息： `We couldn't find any records`.

<!-- MC-39442-->

* 按一下 **PayPal** 結帳時按鈕不再觸發備援 `web-api` 呼叫。 之前會觸發兩個請求，使得產品費用加倍。

<!-- ENGCOM-8173 -->

* 訪客購物者現在可以在以下情況下下達PayPal訂單： **自動指定至客戶群組** 已啟用。 付款會在PayPal閘道處理，訂單會在Magento中建立，而購物者會看到訂單感謝頁面。 之前，訂單已在PayPal閘道成功處理，但訂單並未在Magento Open Source中建立。 相反地，購物者被重新導向至訂單複查頁面，應用程式在該頁面顯示以下錯誤： `Failed address validation: %1" error`. [GitHub-25399](https://github.com/magento/magento2/issues/25399)

### 效能

<!-- MC-37705-->

* 中的效能問題 `module-catalog-import-export/Model/Import/Product/Option.php` 已解決。 匯出或匯入超過100,000筆記錄所需的時間已縮短。 請參閱 [由於有大量的產品選項，匯入/匯出所花的時間比預期長](https://support.magento.com/hc/en-us/articles/360050695772) 知識庫文章。

<!-- MC-37799-->

* `Magento_Csp/Model/BlockCache` 已進行重構，以減少記憶體耗用量及產生不需要的大型快取字串。 以前，包含動態列入白名單的指令碼和樣式的頁面經常會因效能問題而發生問題。 [GitHub-29964](https://github.com/magento/magento2/issues/29964)

<!-- MC-37816 -->

* 針對使用消費者超過100,000種產品的目錄，我們已改善其排程匯出的效能。

<!-- MC-38306 -->

* 當您新增或儲存已停用的產品至類別時，應用程式不再排清類別快取。 以前，應用程式不顧產品狀態仍會排清相關類別的快取，這會影響伺服器效能。

<!-- MC-38518 -->

* 更新購物車中產品數量的頁面載入時間已改善。 以前，應用程式會針對購物車中的每個產品執行多個個別的查詢，這會增加頁面載入時間。

<!-- MC-39700 -->

* 索引器已新增至 `Magento_Bulk`  MySQL表格，已改善大量作業的效能。

<!-- MC-38593 -->

* 應用程式現在會快取可設定產品的子項ID。 藉由減少資料庫要求的數目，已改善頁面載入效能。 [GitHub-30585](https://github.com/magento/magento2/issues/30585)

<!-- MC-37594 -->

* 已改善管理員控制面板的載入作業。 以前，應用程式在頁面完成載入之前，以清單形式顯示索引標簽名稱。

<!-- MC-37417 -->

* 透過為版面配置快取新增到期限制，改善了Redis快取管理。 以前，Redis在大型部署中會快速達到配置的最大記憶體，而應用程式會在寫入作業時擲回錯誤。

<!-- ENGCOM-8016 -->

* 透過移除中的多餘資料庫查詢，已改善簽出效能 `app/code/Magento/Catalog/Model/CategoryLink.php`. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- ENGCOM-8290 -->

* `Magento\Framework\DB\Adapter\Pdo\Mysql->isTableExists` 已重新建構以改善效能。 重複呼叫 `SHOW TABLE STATUS` 以檢查表格是否存在。 [GitHub-29662](https://github.com/magento/magento2/issues/29662)

<!-- ENGCOM-8258 -->

* `getPageLayoutsConfig` 現在儲存在快取中，這已改善設定產生器的效能。 [GitHub-29546](https://github.com/magento/magento2/issues/29546)

### 永久

<!-- MC-36647 -->

* 啟用永久購物車時，購物者在其工作階段Cookie過期後無法再下訂單。 相反地，應用程式會顯示登入頁面，讓購物者可以登入。 之前，應用程式會下訂單。 當發生下列情況時，應用程式無法正確驗證永久客戶 `PHPSESSID` 已過期，且 `customerSession` 從持續性資訊重新建立。

<!-- MC-39127-->

* 當購物者登入已啟用永久購物車的商店後，應用程式現在會依預期顯示歡迎訊息。 之前，應用程式會顯示 **不是您本人？** 登入後的訊息。

<!-- MC-38269-->

* 應用程式不再顯示 **不是您本人？** 文字(當客戶選取 **記住我** 登入已啟用永久購物車的部署時選項。

<!-- MC-37109-->

* 在客戶工作階段過期後，應用程式不再顯示客戶購物車的內容。 以前，當訪客客戶嘗試在啟用永久購物車時結帳時，應用程式會顯示此錯誤： `No such entity with cartid = 0`.

### 定價

<!-- MC-34394-->

* 連續的非同步價格更新不再互相干擾，而且會為每個作業指派正確的狀態。 先前，如果非同步價格更新失敗，則後續的所有非同步價格更新都會失敗，直到對應的佇列消費者重新啟動為止。 [GitHub-27865](https://github.com/magento/magento2/issues/27865)

### 報表

<!-- MC-36652 38925-->

* **報表** > **行銷** > **購物車中的產品** 現在只會顯示正在產生報表之使用者允許範圍內的記錄。 以前，所有資料都可用於所有範圍。

<!-- MC-38074-->

* 在「購物車中的產品」報表中顯示產品貨幣時，應用程式現在會使用產生報表之商家角色範圍中指定的貨幣。

<!-- MC-37934-->

* 「最近檢視」和「最近比較」產品功能現在會在管理員中顯示不同商店和網站的統計資料，如同多商店部署中的預期。 以往，這些功能並未考慮所有商店或網站。

<!-- MC-37217-->

* 訂單報表中的價格現在使用正確的貨幣符號。

<!-- ENGCOM-8314 -->

* 應用程式現在會在使用者按一下管理員儀表板時，驗證權杖是否存在 **移至進階報表** 按鈕。  如果Token存在，應用程式會顯示「進階報告」頁面。 如果未設定Token，應用程式會在使用手冊中顯示資訊頁面。 [GitHub-25411](https://github.com/magento/magento2/issues/25411)

### 評論

<!-- MC-37117-->

* 現在，當您按一下 **新增評論** 「管理員」上的按鈕 **行銷** > **所有評論**. 按一下此頁面上的產品會開啟該產品預期的新檢閱表單。

<!-- ENGCOM-8383 -->

* 當您嘗試編輯管理員的訂單時，應用程式不再擲回此錯誤 **行銷**  >  **所有評論**： `Uncaught TypeError: Event.observe is not a function`.  [GitHub-30388](https://github.com/magento/magento2/issues/30388)

### 銷售

<!-- MC-36219-->

* 此 `order_created_at` 的欄 `sales_shipment_grid` 現在會依預期在每次更新後更新。

<!-- MC-36405-->

* 您現在可以透過自訂選項日期，從商店成功重新訂購產品，針對 **使用JavaScript日曆** 已啟用。 先前，當您嘗試重新排序時，應用程式沒有將專案新增到購物車並顯示此錯誤： `Could not add the product with SKU "simp1" to the shopping cart: Please specify date required option(s).`

<!-- MC-36533-->

* 當購物者結帳的訂單包含已啟用零小計結帳方法的部署中總成本為$0的虛擬產品時，應用程式不再立即關閉訂單。

<!-- MC-36755-->

* 應用程式在處理訂單前不再加以封存。 以前，管理員訂單格上的多選動作會影響未選取的訂單。

<!-- MC-37371-->

* 現在當沙烏地裡亞爾(SAR)設為基本貨幣時，銷退折讓單格線會顯示正確的貨幣符號。

<!-- MC-37880-->

* 應用程式現在會在結帳時，如預期在訂單頁面上一致地顯示送貨地址資訊。

<!-- MC-38666-->

* 的值 `total_qty` 現在符合的值 `total_qty_ordered` 在銷售發票中。

<!-- MC-38717-->

* 非同步傳送銷售電子郵件現在只會傳送上次更新日期後所建立訂單的電子郵件。 以往，啟用非同步傳送時，應用程式不會依日期篩選電子郵件。

<!-- MC-39135-->

* 現在，當管理員下訂單時，應用模組會依預期傳送發票電子郵件。

<!-- MC-38917-->

* 現在，當商家從管理員為客戶建立新訂單時，應用程式會在工作階段期間清除現有的訂單資料。

<!-- MC-38915-->

* 您現在可以變更透過管理員訂單建立之新客戶的客戶群組，當 **啟用自動指定至客戶群組** 已啟用。 您也可以根據VAT驗證來指定客戶群組。 先前，驗證VAT編號時，請求物件不會檢查指派的請求 `group_id`. 依預設，它使用預設值 `group_id`.

<!-- MC-37539-->

* 應用程式不再透過變更自訂訂單狀態 `Suspected Fraud` 狀態至 `Processing` 商家使用REST API建立部份出貨之後。

### 銷售規則

<!-- MC-34793-->

* 購物者變更送貨方式時，已根據送貨方式套用的優惠券代碼將不再套用。 以往，當購物者切換送貨方式時，應用程式不會清除優惠券代碼。

<!-- MC-34649-->

* 購物者套用優惠券代碼的頻率不可高於以下頻率： **每位客戶的使用次數** 設定許可。 以前，如果購物者開啟了多個瀏覽器視窗並同時下多張訂單，則每張訂單都會收到折扣，即使 **每位客戶的使用次數** 設定的值為 **1**.

### 搜尋 {#search-heading}

<!-- MC-35095-->

* 購物者搜尋搜尋同義字時，Elasticsearch不再擲回未知的修飾元錯誤。 先前，逸出在規則運算式中缺少逸出斜線符號，這會導致嚴重錯誤。

<!-- MC-37577-->

* 當子項產品的可見度設定為時，進階搜尋不再將可設定產品的子項傳回為個別搜尋結果 **無法單獨顯示**.

<!-- MC-37954-->

* 搜尋結果中的產品名稱Elasticsearch排序不再區分大小寫。

<!-- ENGCOM-8329 -->

* 搜尋結果頁面現在會如預期般快取，當 **將快取的前幾個搜尋結果數目設為0** 已在Admin中啟用設定 **商店**  >  **設定**  >  **目錄**  >  **目錄**  > **目錄搜尋**.

<!-- MC-36807-->

* 目錄搜尋索引子現在會執行，不會因為Elasticsearch欄位限制而擲回錯誤。 之前，應用程式擲回此錯誤： `Limit of total fields [xxx] in index [m24dev_product_1_v10] has been exceeded`.

<!-- MC-35491-->

* 目錄搜尋的效能已改善。 正在停用 **啟用搜尋建議** (**商店** > **設定** > **目錄** > **目錄搜尋** )如預期運作。 之前，應用程式會查詢MySQL `search_query` 表格而非Elasticsearch自動完成搜尋建議。 [GitHub-25534](https://github.com/magento/magento2/issues/25534)

<!-- MC-35256-->

* Elasticsearch現在會篩選與MySQL相同的產品價格。 欄位型別 `price_*`  已變更自 `float` 至 `double` 在Elasticsearch索引中，以改善精確度並修正浮點錯誤。

<!-- ENGCOM-8393 -->

* 已新增一個鍵值事件接聽程式至Admin，以便在輸入正斜線時啟動全域搜尋表單。 [GitHub-29551](https://github.com/magento/magento2/issues/29551)

<!-- MC-24217-->

* Elasticsearch不再擲回錯誤，而是在以下情況下不再如預期顯示產品： `string` 值是用來依屬性篩選產品，具有 `integer` 或 `decimal` 後端型別。 以前，應用程式會在以下位置顯示此錯誤： `exception.log`： `number format exception`.

<!-- ENGCOM-8303 -->

* Elasticsearch當搜尋詞包含  `/`.  [GitHub-25886](https://github.com/magento/magento2/issues/25886)， [GitHub-25110](https://github.com/magento/magento2/issues/25110)

* 現在，從產品查詢中選取的客戶群組，搜尋功能依預期會停用，當 **不允許目錄搜尋依據** 已啟用一般類別許可權中的組態設定。 [GitHub-29927](https://github.com/magento/magento2/issues/29927)

<!-- ENGCOM-8466 -->

* 搜尋結果不再包含相同字的多重引號。 [GitHub-30104](https://github.com/magento/magento2/issues/30104)

### 送貨

<!-- MC-38247 -->

* 當網路中斷中斷與DHL傳送方法的連線時，結帳程式不會再失敗。 應用程式改為顯示其他可用的送貨方法。 以前，當與DHL傳送的連線中斷時，結帳程式會停止，且應用程式會顯示此錯誤： `Sorry, no quotes are available for this order at this time`. [GitHub-29902](https://github.com/magento/magento2/issues/29902)

<!-- MC-35194-->

* 說明Admin上UPS傳送方法的欄位 **商店** > **設定** > **銷售** > **傳遞方法** 現在已如預期啟用。

<!-- MC-35633-->

* 透過POST建立的出貨 `/rest/V1/shipment` 端點現在可以正確更新訂單。 之前，應用程式已建立出貨，但出貨狀態仍維持在處理狀態。

<!-- MC-37120-->

* 使用「送至多個地址」結帳之前，若有其他產品從購物車移除，應用程式就不會再從購物車移除簡單產品。 [GitHub-30259](https://github.com/magento/magento2/issues/30259)

<!-- MC-38031-->

* 「訂單複查」頁面現在會針對出貨至多個地址的訂單，依預期顯示出貨金額之前的稅捐金額。

<!-- ENGCOM-8257 -->

* UPS出貨追蹤現在會顯示 `Delivered On` 僅當已遞送套件時。 [GitHub-30032](https://github.com/magento/magento2/issues/30032)

<!-- MC-38825-->

* 當購物者從多個地址結帳回到購物車時，應用程式現在會顯示包含虛擬產品之訂單的正確購物車小計。

<!-- MC-38682-->

* 啟用JavaScript套件組合時，商家現在可以從出貨頁面針對使用FedEx出貨的現有訂單建立出貨標籤。 之前，當商家按一下 **建立送貨標籤** 按鈕。

<!-- MC-36953-->

* 傳送給客戶的出貨確認電子郵件中的出貨追蹤連結，現在可如預期運作。 之前，此連結會傳回404錯誤。

<!-- ENGCOM-8025 -->

* 當購物者使用多個地址結帳，然後移除虛擬產品以外的所有產品時，應用程式現在會顯示資訊性錯誤訊息。 [GitHub-25595](https://github.com/magento/magento2/issues/25595)

<!-- ENGCOM-8253 -->

* 您現在可以依預期為部份訂單建立送貨標籤。 先前，當您嘗試為訂單中僅一個專案建立送貨標籤時，應用程式會將所有產品新增至封裝，而驗證失敗。 [GitHub-29552](https://github.com/magento/magento2/issues/29552)

<!-- ENGCOM-8154 -->

* 呼叫時不再略過送貨方法的驗證 `/V1/guest-carts/:cartId/totals-information`. [GitHub-25147](https://github.com/magento/magento2/issues/25147)

### Sitemap

<!-- MC-37306-->

* 產生的網站地圖 `cron` 現在包含正確的影像URL。 先前，在多存放區部署中，產生的快取影像路徑不正確。

### 儲存

<!-- ENGCOM-7543 -->

* 管理員和主要商店切換器現在會反映在管理員中對商店排序順序所做的變更。 [GitHub-13401](https://github.com/magento/magento2/issues/13401)

<!-- ENGCOM-8274 -->

* 應用程式現在會在商店檢視的頂層URL金鑰變更後，為類別和產品建立正確的URL。 先前，當商店檢視的類別樹狀結構包含已修改時  `url_keys`，如果類別索引鍵未變更，但類別父項的索引鍵有變更，則原始程式碼在建立URL時會使用類別的預設商店檢視。 [GitHub-28633](https://github.com/magento/magento2/issues/28633)

### Target規則

<!-- MC-34998-->

* 已最佳化載入產品詳細資料頁面。 我們已新增資料庫表格的索引，這些索引可最佳化許多案例的目標規則條件查詢。

### 稅金

<!-- MC-37666-->

* 客體訂單上的VAT驗證不再導致應用模組以不正確的「客戶稅捐類別」儲存報價單。 [GitHub-30018](https://github.com/magento/magento2/issues/30018)

<!-- MC-37761-->

* 現在當設定FPT時，可以在結帳期間儲存要運送到多個地址的訂單。 先前，完成多個地址的訂單後，應用程式會顯示一個空白頁面，而不是訂單成功頁面。

<!-- ENGCOM-8158 -->

* 店面產品詳細資訊頁面現在會依預期顯示新舊價格（含稅或不含稅）。 [GitHub-27500](https://github.com/magento/magento2/issues/27500)， [GitHub-11998](https://github.com/magento/magento2/issues/11998)

### 測試

<!-- MC-37364-->

* `bin/magento dev:tests:run` 現在會如預期啟動下列測試：全部、單位、整合、整合全部、靜態、靜態、完整性、舊版和預設。

<!-- MC-38488-->

* `AdminMediaGalleryInsertLargeImageFileSizeTest` 已重構。

<!-- ENGCOM-8158 -->

* 單元測試現在與PHPUnit 8相容。 [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-8009 -->

* `\Magento\TestFramework\TestCase\WebapiAbstract` 現在包含一個函式，支援比較測試中預期和實際結果的大型巢狀陣列。 結果中的無關索引鍵現在可以忽略。 [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-8024 -->

* `AdminMediaGalleryCatalogUiEditCategoryGridPageTest` 不再隨機失敗。 [GitHub-1764](https://github.com/magento/adobe-stock-integration/issues/1764)

<!-- ENGCOM-8041 -->

* `dev/tests/integration/testsuite/Magento/Customer/Controller/AccountTest` 已進行改善。 (`assert` 現在基於 `XPath` 選擇器而非 `assertStringContainsString`.) [GitHub-29700](https://github.com/magento/magento2/issues/29700)

<!-- ENGCOM-8017 -->

* 已新增的測試涵蓋範圍 `AdminAnalytics` 模組。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-8266 -->

* 整合和API功能測試現在與PHPUnit 9.3相容。 [GitHub-30146](https://github.com/magento/magento2/issues/30146)

<!-- MC-35798 -->

* 已更正GraphQL的問題 `testRequestCacheTagsForCategoryListOnMultipleIds` 測試。 [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-7762 -->

* 包含URL的標頭值現在會在中正確剖析 `ApiFunctional TestFramework`. [GitHub-26425](https://github.com/magento/magento2/issues/26425)

<!-- MC-35798 8109-->

* 已更正GraphQL的問題 `testRequestCacheTagsForCategoryListOnMultipleIds` 測試。 [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-8382 -->

* `—no-tablespaces` 已新增至所有出現的 `mysqldump`，可允許執行整合測試，但不 `PROCESS` 許可權（自MySQL 5.7.31 / 8.0.21起必須執行） `mysqldump` 預設情況下)。 [GitHub-30566](https://github.com/magento/magento2/issues/30566)

### 主題

<!-- ENGCOM-8419 -->

* 新 `--no-parent` 標幟已新增至 `bin/magento setup:static-content:deploy` 防止編譯佈景主題之父系的命令。 這個新標幟可避免不必要的編譯，進而大幅提升靜態內容部署程式的效能。 請注意，使用時，這個新標幟無法運作 `compact` 策略。 [GitHub-30184](https://github.com/magento/magento2/issues/30184)

<!-- MC-37630 -->

* 設計設定不再產生DDL作業。 先前，當更新設計組態時，應用程式會產生可能觸發MySQL錯誤的DDL敘述句。

<!-- ENGCOM-8112 -->

* 中的備援程式碼 `Magento_ConfigurableProduct` 已移除管理主題中的模組。  [GitHub-29857](https://github.com/magento/magento2/issues/29857)

<!-- ENGCOM-8144 -->

* 已移除多餘的少樣式導覽和空白主題中未使用的屬性。 [GitHub-29914](https://github.com/magento/magento2/issues/29914)

<!-- ENGCOM-8285 -->

* 在行動檢視的空白主題中新增可摺疊的導覽功能。 [GitHub-30237](https://github.com/magento/magento2/issues/30237)

<!-- ENGCOM-7803 -->

* 已最佳化主題的Web字型載入。  [GitHub-29526](https://github.com/magento/magento2/issues/29526)

<!-- ENGCOM-8068 -->

* 開發人員現在可以在佈景主題中宣告自訂字型時，指定字型型別。 [GitHub-29719](https://github.com/magento/magento2/issues/29719)

### 翻譯與地區設定

<!-- MC-36836 -->

* 當「管理員」地區設定為阿拉伯文(`ar_SA - Saudi Arabia`)。

<!-- MC-38476 -->

* 當購物者在註冊或新增新地址時，應用程式不再顯示錯誤訊息，而是以有效的郵遞區號輸入阿根廷地址。 之前，應用程式會顯示此錯誤： `Provided Zip/Postal Code seems to be invalid. Example: 1234. If you believe it is the right one you can ignore this notice.`

<!-- MC-38663-->

* 當購物者輸入韓文地址的五位數郵遞區號時，應用程式不會再擲回錯誤。

<!-- ENGCOM-8244 -->

* 新增對以下定義的烏拉圭地區的支援： [ISO 3166-2：UY](https://en.wikipedia.org/wiki/ISO_3166-2:UY). [GitHub-29729](https://github.com/magento/magento2/issues/29729)

<!-- ENGCOM-8220 -->

* `zip_codes.xml` 已更新以強制巴西郵遞區號使用八位數。 [GitHub-29984](https://github.com/magento/magento2/issues/29984)

<!-- ENGCOM-8304 -->

* 改善剩餘未當地語系化片語的本地化。 [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8380 -->

* 現在可以翻譯格線搜尋輸入預留位置。 [GitHub-30510](https://github.com/magento/magento2/issues/30510)

<!-- ENGCOM-8018 -->

* 應用程式現在只會在內嵌翻譯JavaScript模組啟用時下載這些模組。  [GitHub-29553](https://github.com/magento/magento2/issues/29553)

### UI

<!-- MC-38509-->

* 此 **建立帳戶** 當購物者輸入無效資料時，「建立新帳戶」頁面上的按鈕保持作用中。 此按鈕先前已停用，可防止購物者在發生錯誤後重新嘗試建立帳戶。 這是2.4.1中的已知問題。 [GitHub-30513](https://github.com/magento/magento2/issues/30513)

<!-- MC-38698-->

* 改善「管理訂單編輯」頁面上的出貨格線載入功能。

<!-- MC-37870-->

* 應用程式現在會顯示  **與帳單地址相同** 核取方塊（當產品已由SKU新增至購物車時）。

<!-- ENGCOM-8007 -->

* 定義有限寬度的CSS類別現在會如預期套用至 **開始時間** 管理員欄位 **儲存**  >  **設定**  >  **目錄**  >  **XML Sitemap**  >  **產生設定**.  [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992 -->

* 修正條款與條件核取方塊標籤的顯示問題。  [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7948 -->

* 無法使用層級價格時，應用程式不再於產品頁面上顯示層級價格區塊的CSS程式碼。 [GitHub-29194](https://github.com/magento/magento2/issues/29194)

<!-- ENGCOM-8084 -->

* 影像檢視詳細資訊頁面上的按鈕位置已重新排序，以符合使用者介面准則。  [GitHub-1783](https://github.com/magento/adobe-stock-integration/issues/1783)

<!-- ENGCOM-8342 -->

* 抵用券代碼文字欄位現在在Internet Explorer/EDGE瀏覽器中以適當的寬度顯示。

<!-- ENGCOM-7630 -->

* 此 `@button__border-radius` 變數現在定義於 `lib/web/css/source/lib/variables/_buttons.less` 資料庫。  `border-radius` 的預設值為 `3px`. 先前， `border-radius` 已硬式編碼。  [GitHub-28674](https://github.com/magento/magento2/issues/28674)

<!-- ENGCOM-8067 -->

* 現在，在達到最小搜尋字串長度之前，迷你搜尋欄位中的提交搜尋按鈕（放大鏡）會停用。 [GitHub-29704](https://github.com/magento/magento2/issues/29704)

<!-- MC-38807-->

* 此 **預覽範本** 按鈕現在可在「編輯佇列」頁面中如預期運作。

<!-- MC-31892-->

* 現在，將屬性從一個群組移動到另一個群組時，應用程式會保留屬性值。

<!-- ENGCOM-8085 -->

* 新增字型粗細量變數至 `lib/web/css/source/lib/variables/_typography.less`. [GitHub-29778](https://github.com/magento/magento2/issues/29778)

<!-- ENGCOM-8211 -->

* 篩選器可見度現在可與管理網格中預期的欄可見度搭配使用。  [GitHub-30345](https://github.com/magento/magento2/issues/30345)

<!-- ENGCOM-8152 -->

* UI選取元件選項不再可見，當 `this.disabled(true)` 已設定。 [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7901 -->

* 此 `@font-family-name__base` 載入Open Sans字型時，不再使用變數。 [GitHub-29515](https://github.com/magento/magento2/issues/29515)

<!-- ENGCOM-8120 -->

* WAI-ARIA屬性 `aria-atomic="true"` 已新增至錯誤容器標籤。 [GitHub-29560](https://github.com/magento/magento2/issues/29560)

<!-- ENGCOM-8175 -->

* UI元件網格現在會顯示所選專案的準確計數。 先前，當依關鍵字搜尋選取了所有格點專案，而購物者隨後在選取標題核取方塊之前取消選取了某些專案時，格點會指出錯誤的選取次數。 [GitHub-29968](https://github.com/magento/magento2/issues/29968)

<!-- ENGCOM-8118 -->

* 應用模組不再於商業發票與出貨概觀頁面上顯示未轉譯的HTML。 [GitHub-29958](https://github.com/magento/magento2/issues/29958)

<!-- ENGCOM-8066 -->

* 按一下 **選項** 在Admin **商店**  >  **貨幣匯率**  現在會將使用者導向至系統設定頁面之展開的貨幣選項區段。 [GitHub-29336](https://github.com/magento/magento2/issues/29336)

<!-- ENGCOM-8361 -->

* 改善對「根據Widget的其他條件顯示」的支援 `adminhtml` widget （使用選擇器widget型別時）。 [GitHub-13316](https://github.com/magento/magento2/issues/13316)， [GitHub-7252](https://github.com/magento/magento2/issues/7252)， [GitHub-6868](https://github.com/magento/magento2/issues/6868)

<!-- ENGCOM-8336 -->

* 改善Luma主題中確認快顯對話方塊的文字邊框間距。 [GitHub-30452](https://github.com/magento/magento2/issues/30452)

### 儲存庫

<!-- MC-39109-->

* 此 `Vault` 模組現在會從付款資訊管理服務的要求中辨識付款方式代碼。 先前，當購物者使用儲存的Braintree信用卡下訂單時，即使使用有效的付款方式，應用程式也會擲回此錯誤： `The requested Payment Method is not available`.

<!-- ENGCOM-7977 -->

* 當使用者捲動時，應用程式在「以客戶身分登入」頁面上顯示的橫幅現在會維持在頁面頂端。 [GitHub-29354](https://github.com/magento/magento2/issues/29354)

### 頂點

* 修改地址時，現在會依預期移除地址建議。

* 有些客戶無法將其地址儲存在帳戶面板中的競爭條件已解決。

* 在某些情況下，頂點位址驗證不再將「位址編輯」頁面新增至全頁快取。

* 當免運費設定為包含稅捐的金額時，現在會考量頂點計算的稅捐。

### Web API框架

<!-- MC-23904 ENGCOM-8421-->

* 您現在可以使用POST `V1/invoice/:invoiceId/refund` 若要退款產品數量為零且出貨費用為零的商業發票(例如， `{"items": [{"qty": 0, "orderItemId": 6, "extensionAttributes": {}}], "appendComment": false, "notify": true, "isOnline": true, "arguments": {"adjustment_negative": 0.0, "adjustment_positive": 0.99, "shipping_amount": 0}}.` )之前，應用程式擲回此錯誤： `You can't create a creditmemo without products`. [GitHub-23069](https://github.com/magento/magento2/issues/23069)

<!-- MC-33732 -->

* 您現在可以使用POST `V1/categories` 以建立或更新類別。 以往，若符合下列條件，應用程式不會儲存值： `default_sort_by` 值已設定為陣列。 當 `default_sort_by` 值設定為字串，應用程式擲回此錯誤： `Error occurred during \"custom_attributes\" processing. Attribute \"default_sort_by\" has invalid value. The \"string\" value's type is invalid. The \"string[]\" type was expected. Verify and try again.`

<!-- MC-35740 -->

* 使用POST `V1/invoices/:id/capture` 擷取付款資訊現在可如預期運作。 以前，應用模組會授權訂單，但只會在付款閘道的網站上擷取訂單。

<!-- MC-37794 -->

* 當您使用POST時 `V1/order/:orderId/ship` 若要建立部份出貨，端點會傳回正確數目的已出貨產品。

<!-- MC-38425-->

* 使用POST建立的商業發票 `V1/order/:orderID/invoice` 現在可正確反映商店點數的部分付款。 先前，當部份訂單付款給含商店信用額的訂單時，建立發票時不會將商店信用額列入考量。

<!-- MC-36830-->

* GET `rest/all/V1/categories` 和GET `rest/all/V1/categories?rootCategoryId=2` 呼叫現在會傳回填入 `name` 和 `product_count` 樹狀結構中所有類別的欄位都如預期般顯示。 之前，類別欄位值是空的。 資料表名稱解析程式外掛程式傳回不正確的資料表名稱，無法依類別擷取產品計數。

<!-- ENGCOM-8286 -->

* PUT `V1/categories/:id` 端點現在會儲存以下情況時類別URL索引鍵建立301重新導向所需的資料： `save_rewrites_history` 提供自訂屬性。 [GitHub-29174](https://github.com/magento/magento2/issues/29174)， [GitHub-30240](https://github.com/magento/magento2/issues/30240)

### 願望清單

<!-- MC-33626-->

* 當產品被指派給自訂庫存來源時，購物者現在可以將產品新增到願望清單。 [GitHub-3018](https://github.com/magento/inventory/issues/3018)

<!-- MC-35416-->

* 客戶從店面將產品新增至其願望清單後，管理員現在可以從管理員客戶頁面存取管理購物車頁面。 以前，當管理員按一下 **管理購物車** 按鈕： `An error has occurred. See error log for details`.

<!-- MC-35573-->

* 此 **加入購物車** 「共用願望清單」頁面上的按鈕現在可如預期般用於未登入的匿名、來賓和使用者。

<!-- ENGCOM-8062 -->

* 應用程式現在會依預期在願望清單頁面中顯示選取的可設定產品屬性選項。  [GitHub-24091](https://github.com/magento/magento2/issues/24091)，  [GitHub-22503](https://github.com/magento/magento2/issues/22503)

<!-- ENGCOM-7779 -->

* 已實施 `ActionInterface` 的 `\Magento\Wishlist\Controller\Shared\Allcart`. [GitHub-29537](https://github.com/magento/magento2/issues/29537)

## 已知問題

**問題**：此 `[magento_root]/index.php` 檔案已移除，應用程式現在執行自 `/pub` Apache設定的預設值。 從子資料夾提供的存放區將無法如預期運作，並可能顯示404錯誤。 **因應措施**：使用symlink將安裝模擬至子資料夾。 以下範例使用 `https://shop01.com/shop/` 說明如何使用symlink來模擬子資料夾中的安裝。

1. 建立子目錄 `https://shop01.com/shop/`：

   ```bash
   mkdir magento_root/pub/shop01
   ```

   ```bash
   cd magento_root/pub/shop01
   ```

1. 在新建立的目錄中建立存放區父目錄的符號連結：

   ```bash
   ln -s ../media media
   ```

   ```bash
   ln -s ../static static
   ```

   ```bash
   ln -s ../../../pub pub
   ```

   ```bash
   ln -s ../.htaccess .htaccess
   ```

   ```bash
   ln -s ../health_check.php health_check.php
   ```

1. 建立 `index.php` 新目錄內的檔案(`magento_root/pub/shop01/index.php`)並新增此內容：

```php
   <?php
   require realpath(__DIR__) . '/../../../app/bootstrap.php';

   switch ($_SERVER['HTTP_HOST']) {
       case 'shop01.com':
       case 'www.shop01.com':
           $params = $_SERVER;
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = 'shop01';
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = 'website';
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
           break;

       default:
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $_SERVER);
           /** @var \Magento\Framework\App\Http $app */
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
       break;
   }
```

1. 將Apache伺服器設定為指向新的子目錄。 部署設定可能大不相同。 以下是伺服器設定的範例：

```xml
   <VirtualHost *:80>
       DocumentRoot "magento_root/pub/shop1"
       ServerName shop01.com
   </VirtualHost>
```

**問題**：當購物者先在「付款」頁面的「驗證碼」欄位中輸入正確的程式碼時，應用程式未如預期提交付款資訊，但會顯示此錯誤：  `There has been an error processing your request`. 只有當購物者嘗試下訂單而未輸入驗證碼或輸入錯誤時，才會發生這種情況。  **因應措施**：重新整理頁面。 <!-- MC-40506-->

**問題**：當購物者按一下時，應用程式會如預期在Braintree中建立訂單 **以Venmo付款**，但不會在管理員中建立訂單。 請參閱 [2.4.2已知問題：BraintreeVenmo付款無法運作](https://support.magento.com/hc/en-us/articles/360054662652/) 知識庫文章。  <!-- BUNDLE-2894-->

**問題**：您無法使用 `addConfigurableProductToCart` GraphQL變異，在執行詳細目錄的多重商店部署中，將可設定的產品新增到非預設商店檢視中的購物車。 （Luma店面不受影響。） 應用程式會顯示此錯誤： `Could not add item to cart. Please check required options and try again`. **因應措施**：使用 `addProductsToCart` 變異。 [GitHub-31660](https://github.com/magento/magento2/issues/31660)<!-- PWA-1298-->

## 社群貢獻

我們感謝更廣泛的Magento Open Source社群，並感謝他們為此版本所作出的貢獻。

社群工程團隊 [Magento參與者](https://magento.biterg.io/app/kibana) 維護按月、季和年排列的優秀貢獻個人和合作夥伴清單。 從該貢獻者頁面，您可以前往GitHub上的合併個人資料連結。

### 合作夥伴貢獻

下表重點說明合作夥伴所做的貢獻。 下表列出提出提取請求的合作夥伴、外部提取請求，以及與之相關聯的GitHub問題編號（若有）。

{{$include /help/_includes/release-notes/engcomm-2-4-2-partner.md}}

### 個人貢獻者

下表列出我們社群成員的貢獻。 此表格列出外部提取請求、與其相關聯的GitHub問題編號（如果有的話），以及提出提取請求的社群成員。

{{$include /help/_includes/release-notes/engcomm-2-4-2-issues.md}}

### 系統需求

我們的技術棧疊是以PHP和MySQL為基礎所建置。 如需詳細資訊，請參閱 [系統需求](../../../installation/system-requirements.md).

### 安裝和升級指示

您可以使用以下專案安裝Magento Open Source2.4.2： [作曲者](../../../installation/composer.md).

## 移轉工具套件

資料移轉工具可協助將現有Magento1.x存放區資料傳輸至Magento2.x。此命令列介麵包含驗證、進度追蹤、記錄和測試功能。 如需安裝指示，請參閱 [安裝資料移轉工具](../../../tools/data-migration-tool/install.md). 考慮探索或貢獻至 [資料移轉存放庫](https://github.com/magento/data-migration-tool).

此 [程式碼移轉工具組](https://github.com/magento-commerce/code-migration) 協助將現有Magento1.x存放區擴充功能和自訂內容轉移至Magento2.x。命令列介麵包含轉換Magento1.x模組和版面的指令碼。
