---
title: 效能優化Recommendations
description: 通過遵循這些建議優化您的Adobe Commerce實施的績效。
exl-id: c5d62e23-be43-4eea-afdb-bb1b156848f9
source-git-commit: 6509c939c7abc5462bffbe104466b2ff9e6fadc9
workflow-type: tm+mt
source-wordcount: '1289'
ht-degree: 0%

---

# 效能優化審查

即使效能優化可以從許多方面來進行，但大多數情況下仍應考慮一些一般性建議。 這包括基礎架構元素的配置優化、Adobe Commerce後端配置和體系結構可擴充性規劃。

## 基礎設施

以下各節介紹基礎架構優化的建議。

### DNS查找

DNS查找是查找域名所屬的IP地址的過程。 瀏覽器必須等待DNS查找完成後才能下載每個請求的任何內容。 減少DNS查找對於提高總頁載入時間非常重要。

### 內容分發網路(CDN)

使用CDN優化資產下載效能。 Adobe Commerce用的是&quot;阿普賽&quot; 如果有Adobe Commerce的內部實施，您還應考慮添加CDN層。

### Web延遲

資料中心的位置會影響前端用戶的Web延遲。

### 網路頻寬

足夠的網路頻寬是Web節點、資料庫、快取/會話伺服器和其他服務之間資料交換的關鍵要求之一。

因為Adobe Commerce有效地利用快取實現高效能，所以您的系統可以主動與Redis等快取伺服器交換資料。 如果Redis位於遠程伺服器上，則必須在Web節點和快取伺服器之間提供足夠的網路通道，以防止讀/寫操作出現瓶頸。

### 作業系統(OS)

與其他高負載Web應用程式相比，Adobe Commerce的作業系統配置和優化類似。 隨著伺服器處理的併發連接數的增加，可用套接字的數量可以被完全分配。

### Web節點的CPU

一個CPU內核可以在無快取的情況下有效處理約2-4個Adobe Commerce請求。 要確定處理所有傳入請求而不將它們排入隊列所需的Web節點/內核數，請使用公式：

```
N[Cores] = (N [Expected Requests] / 2) + N [Expected Cron Processes])
```

### PHP-FPM設定

優化這些設定取決於不同項目的效能test結果。

- **位元組代碼** — 要在PHP 7上從Adobe Commerce獲得最大速度，必須激活 `opcache` 並正確配置。

- **APCU** — 我們建議啟用PHP APCu擴展並配置Composer以優化效能以獲得最高效能。 此擴展插件為已開啟的檔案快取檔案位置，這提高了Adobe Commerce伺服器調用（包括頁面、Ajax調用和端點）的效能。

- **Realpath_cacheconfiguration** — 優化 `realpath_cache` 允許PHP進程快取到檔案的路徑，而不是每次載入頁面時查找它們。

### Web伺服器

將nginx用作Web伺服器只需輕微重新配置。 nginx Web伺服器提供更好的效能，並且使用Adobe Commerce的示例配置檔案([`nginx.conf.sample`](https://github.com/magento/magento2/blob/2.4/nginx.conf.sample))。

- 正確設定PHP-FPM和TCP

- 啟用HTTP/2和Gzip

- 優化工作程式連接

### 資料庫

此文檔沒有提供MySQL的詳細優化說明，因為每個儲存和環境都不同，但我們可以提出一些一般性建議。

Adobe Commerce資料庫（以及任何其他資料庫）對用於儲存資料和索引的可用記憶體量非常敏感。 為有效利用MySQL資料索引，可用記憶體量至少應接近資料庫中儲存資料的一半大小。

優化 `innodb_buffer_pool_instances` 設定以避免多個線程嘗試訪問同一實例時出現問題。 的值 `max_connections` 參數應與應用程式伺服器中配置的PHP線程總數相關。 使用以下公式計算 `innodb-thread-concurrency`:

```
innodb-thread-concurrency = 2 * (NumCPUs+NumDisks)
```

### 會話快取

會話快取是為Redis的單獨實例配置的好候選項。 此快取類型的記憶體配置應考慮站點的購物車放棄策略以及會話在快取中應保留多長時間。

Redis應分配足夠的記憶體以將所有其他快取保存在記憶體中，以獲得最佳效能。 塊快取將是決定要配置的記憶體量的關鍵因素。 塊快取相對於站點上的頁數（SKU數x儲存視圖數）增長。

### 頁面快取

我們強烈建議在您的Adobe Commerce商店上使用清漆進行整頁快取。 的 `PageCache` 模組在代碼庫中仍然存在，但只應用於開發目的。

將清漆安裝到Web層前面的單獨伺服器上。 它應接受所有傳入請求並提供快取的頁面副本。 為了允許清漆在安全頁面上有效工作，可以將SSL端接代理放置在清漆前面。 Nginx可用於此目的。

雖然清漆全頁快取記憶體無效是有效的，但我們建議為清漆分配足夠的記憶體，以將您最常用的頁保留在記憶體中。

### 消息隊列

消息隊列框架(MQF)是允許模組將消息發佈到隊列的系統。 它還定義了非同步接收消息的用戶。 Adobe Commerce支援RabbitMQ作為消息代理，它為消息的發送和接收提供了可擴展的平台。

### 效能測試和監控

在每個生產版本之前，總是建議進行效能測試，以評估您的電子商務平台的效能。 在啟動後繼續進行監控，並制定可擴充性和備份計畫以處理高峰時間。

>[!NOTE]
>
> Adobe Commerce在雲基礎架構上已應用了上述所有基礎架構和體系結構優化，但DNS查找除外，因為它超出了範圍。

### 搜索

自Adobe Commerce2.4版起，Elasticsearch是必需的，但對於2.4之前的版本，啟用它也是一種最佳做法。

## 操作模型

除了前面提到的常見基礎架構優化建議外，還有一些方法來提高特定業務模式和規模的效能。 本文檔沒有提供所有這些方案的深入調整說明，因為每種方案都不同，但我們可以提供一些高級選項供您參考。

### 無頭架構

我們有一個單獨的部分專門介紹 [頭](../../architecture/headless/adobe-commerce.md) 和不同的選項。 綜上所述，它將店面層與平台本身分離。 它仍然是同一個後端，但Adobe Commerce不再直接處理請求，而是只支援通過GraphQL API的自定義店面。

### 保持Adobe Commerce更新

Adobe Commerce在運行最新版本時總是效能更好。 即使在每個新版本發佈後Adobe Commerce無法保持最新，仍建議 [升級](../../../upgrade/overview.md) 當Adobe Commerce引入顯著的效能優化時。

例如，2020年，Adobe向Redis層發佈了優化，解決了大量效率低下、連接問題以及Redis和Adobe Commerce之間不必要的資料傳輸。 2.3到2.4之間的整體效能是夜以繼日的，我們看到購物車、結帳、併發用戶方面有了顯著的改進，這僅僅是因為Redis優化。

### 優化資料模型

許多問題都源於資料，包括錯誤的資料模型、結構不正確的資料以及缺少索引的資料。

如果你在測試幾個連接，它看起來不錯，但在生產中，當真正的流量到達時，這就是速度慢的地方。 系統整合商必須知道如何設計資料模型（尤其是產品屬性）、避免添加不必要的屬性以及保留影響業務邏輯的強制屬性（如定價、庫存可用性和搜索）。

對於那些不影響業務邏輯但仍需要在店面顯示的屬性，請將它們組合為幾個屬性（例如，JSON格式）。

為了優化平台效能，如果從PIM或ERP獲取的資料或屬性中不需要在店面上使用業務邏輯，則無需將該屬性添加到Adobe Commerce。

### 可擴充性設計

這對於開展活動並經常面臨高峰期的企業來說非常重要。 對於易於擴展的架構和應用程式設計，這可以在高峰時段增加資源，在高峰時段之後減少資源。
